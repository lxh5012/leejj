function isBrowseIPad(){var t,e=navigator.userAgent.toLowerCase();return t=e.match(/iPad/i),"ipad"==t}var NTKO_AttachInfo=new Array,NTKO_AttachObj=new Array,_Sheet_GlobalString={Sheet_Loading:"数据加载中……",Sheet_Wait:"系统正在处理{0}操作,请稍候。。。",Sheet_Search:"搜索：",Sheet_Close:"关闭",Sheet_More:"更多..."},pageInfo={LockImage:'<%=ResolveUrl("~/WFRes/images/WaitProcess.gif")%>'},Sheet=function(t){this.autoHiddenEmptyRow=!1,this.AttrDatafield="data-datafield",this.init(t)};Sheet.prototype={init:function(t){this.container=t,this.Computation=new Sheet.Computation(this),this.Validate=new Sheet.Validate(this),this.Display=new Sheet.Display(this),this.autoFinishWorkItem(),this.autoHiddenEmptyRow&&this.hiddenEmptyRow()},getResultValue:function(express){if(-1!=express.indexOf("return"))return new Function(express).call(this);try{if(express){var array=express.split(")-(");if(2!=array.length)return eval(express);var index1=array[0].lastIndexOf("("),index2=array[1].lastIndexOf(")");if(-1==index1||-1==index2)return eval(express);var timeStr1=array[0].substring(index1+1),timeStr2=array[1].substring(0,index2);if(timeStr1.length!=timeStr2.length)return eval(express);var reg1=/^(([1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])(\s+(20|21|22|23|[0-1]\d):[0-5]\d(:[0-5]\d)*)*)|(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d)$/,regExp1=new RegExp(reg1);if(!regExp1.test(timeStr1)||!regExp1.test(timeStr2))return eval(express);var reg2=/^(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,regExp2=new RegExp(reg2);regExp2.test(timeStr1)&&regExp2.test(timeStr2)&&(timeStr1="1999-01-01 "+timeStr1,timeStr2="1999-01-01 "+timeStr2);var time1=new Date(timeStr1).getTime(),time2=new Date(timeStr2).getTime(),days=Number((time1-time2)/864e5);if((days+"").indexOf(".")>-1&&(days=days.toFixed(1)),days<0)return"";var prefix="";0!=index1&&(prefix=express.substring(0,index1));var suffix="";index2!=array[1].length-1&&(suffix=express.substring(array[0].length+index2+4));var days2=prefix+days+suffix;return days==days2?days+"$Date":eval(days2)+"$Date"}}catch(t){console.log(t)}},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null},isIE:function(){return!!window.ActiveXObject||"ActiveXObject"in window},preview:function(){document.write('<object id="WebBrowser" classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2" height="0" width="0"></object>'),document.all.WebBrowser.ExecWB(7,1)},autoFinishWorkItem:function(){var t=this.getQueryString("ParmAction");if("Submit"==t){var e=$("#divTopBars a:contains('提交')");if(0==e.length&&(e=$("#divTopBars a:contains('通过')")),0==e.length&&(e=$("#divTopBars a:contains('已阅')")),e.length>0){var i=e[0].id;__doPostBack(i,"")}}else if("Return"==t){var a=$("#divTopBars a:contains('驳回')");if(0==a.length&&(a=$("#divTopBars a:contains('退回')")),a.length>0){var n=a[0].id;__doPostBack(n,"")}}},hiddenEmptyRow:function(){$("#tbTable tr,#tbBasicInfo tr").each(function(t){t>2&&$(this).find("table[id^='tbComment']").length>0&&""==$.trim($(this).find("table[id^='tbComment']").text())&&0==$(this).find("select").length&&2==$(this).find("td").length&&$(this).hide()})},unLockScreen:function(){$("#divLock").remove(),$("#frameLock").remove()},lockScreen:function(t){var e,i,a;e=$(document).width(),i=$(document).height(),a=$(document).scrollTop()+$(window).height()/2,$("<iframe></iframe>").attr("id","frameLock").css("position","absolute").css("top",0).css("left",0).css("width",e).css("height",i).css("zIndex",9999).css("backgroundColor","Transparent").css("frameborder",0).css("filter","Alpha(Opacity=0)").css("allowtransparency",!0).appendTo("body"),$("<div></div>").html('<table id="spanLockMessage" border="0" style="width:'+e+"px;font-size:26px;font-weight:bold;position:absolute;top:"+a+'px"><tr><td align="center"><img src="'+pageInfo.LockImage+'"></td></tr></table>').attr("id","divLock").css("position","absolute").css("top",0).css("left",0).css("width",e).css("height",i).css("zIndex",1e4).css("backgroundColor","#CCCCCC").css("filter","progid:DXImageTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=55").css("opacity","0.6").css("allowtransparency",!0).appendTo("body"),$(window).scroll(function(){$("#spanLockMessage").css("top",$(document).scrollTop()+$(window).height()/2)})},getControlValue:function(t){var e=document.getElementById(t);return null!=e&&null!=e.type?$(e).val():$("input[name='"+t+"']").length>0?$("input[name='"+t+"']:checked").val():""},setControlReadOnly:function(t){var e=this.findControlByDataField(window,t);e.length>0&&e.keydown(function(t){return!1})},findControlByDataField:function(t,e){var i=t.find("select["+this.AttrDatafield+"='"+e+"'],div["+this.AttrDatafield+"='"+e+"'],input["+this.AttrDatafield+"='"+e+"'],span["+this.AttrDatafield+"='"+e+"'],table["+this.AttrDatafield+"='"+e+"'],textarea["+this.AttrDatafield+"='"+e+"']");if(i.length>0)for(var a=0;a<i.length;a++){var n=$(i[a]);if(!n.is("span"))return n.is("div")?n.find("input"):n;if(n.find("input").length>0)return n.find("input");if(n.attr("data-type")&&"SheetLabel"==n.attr("data-type")&&n.attr("data-bindtype")&&"OnlyData"==n.attr("data-bindtype"))return n}return t=t.parent(),t.is("body")?null:this.findControlByDataField(t,e)},getDataFieldValue:function(t,e){var i=t.find("input["+this.AttrDatafield+"='"+e+"'],select["+this.AttrDatafield+"='"+e+"'],textarea["+this.AttrDatafield+"='"+e+"']");if(i.length>0){var a=i.next();if(a.length>0&&a.is("label")&&a.attr("for")==i.attr("id")){if(i.is("select")){var n=a.text(),r="";return i.find("option").each(function(){if($(this).text()==n)return r=$(this).val(),!1}),r}if(i.is("input"))return a.find("span").eq(0).text()}else if(a.length>0&&a.is("label")&&i.is("input")&&0==a.find("span").length)return a.text();return i.val()}if(i=t.find("span["+this.AttrDatafield+"='"+e+"']"),i.length>0){if(i.find("input").length>0)return i.find("input").is(":checked");if(i.find("input").length>0)return i.find("input").is(":checked");if(i.attr("data-type")&&"SheetLabel"==i.attr("data-type")&&i.attr("data-bindtype")&&"OnlyData"==i.attr("data-bindtype"))return i.html()}if(i=t.find("table["+this.AttrDatafield+"='"+e+"']"),i.length>0){for(var s=i.find("input"),d=0;d<s.length;d++)if(s[d].checked)return s[d].value;return""}if(i=t.find("div["+this.AttrDatafield+"='"+e+"']"),i.length>0){for(s=i.find("input"),d=0;d<s.length;d++)if(s[d].checked)return s[d].value;return""}return t=t.parent(),t.is("body")||t.is("html")?null:this.getDataFieldValue(t,e)},getDataFieldControlValue:function(t,e){var i=t.find("input["+this.AttrDatafield+"='"+e+"'],textarea["+this.AttrDatafield+"='"+e+"'],select["+this.AttrDatafield+"='"+e+"']");return i.length>0?i.val():(i=t.find("span["+this.AttrDatafield+"='"+e+"']"),i.length>0?i.html():(t=t.parent(),t.is("body")||t.is("html")?null:this.getDataFieldValue(t,e)))},setDataFieldControlValue:function(t,e,i){var a=t.find("input["+this.AttrDatafield+"='"+e+"'],textarea["+this.AttrDatafield+"='"+e+"']");if(a.length>0)a.val(i);else if(a=t.find("span["+this.AttrDatafield+"='"+e+"']"),a.length>0)a.html(i);else if(t=t.parent(),!t.is("body")&&!t.is("html"))return this.setDataFieldControlValue(t,e,i)},executeService:function(t,e,i,a,n){var r,s=this.executeBizService(t,e,i,a);if(n)r=s[n];else for(var d in s){r=s[d];break}return r},executeBizService:function(t,e,i,a){var n,r={cmd:"ExecuteServiceMethod",ServiceCode:t,MethodName:e};if(a||(a=$("body")),i){for(var s in i)r[s]=this.getDataFieldControlValue(a,i[s]),r[s]||(r[s]=i[s]);for(var s in i)r[s]||(r[i[s]]=this.getDataFieldControlValue(a,s))}return $.ajax({type:"POST",async:!1,url:_PORTALROOT_GLOBAL+"/AjaxServices/executeServiceMethod",data:r,dataType:"json",success:function(t){n=t},error:function(t){var e=t.toString();alert(e)}}),n}};var winPrint=function(){window.print()};