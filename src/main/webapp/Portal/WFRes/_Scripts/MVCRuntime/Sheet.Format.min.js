Sheet.Format=function(){this.AttrName="data-formatrule",this.init(this)},Sheet.Format.prototype={init:function(t){this.sheet.container?this.sheet.container=$(this.sheet.container.context).find("input["+this.AttrName+"],span["+this.AttrName+"]"):this.sheet.container=$("input["+this.AttrName+"],span["+this.AttrName+"]"),this.sheet.container.each(function(t){var e=$(this).attr(t.AttrName);e&&$(this).blur(function(){var t,a={cmd:"GetFormatValue",Format:e,InputValue:this.value||this.innerText};$.ajax({type:"POST",async:!1,url:_PORTALROOT_GLOBAL+"/AjaxServices.aspx",data:a,dataType:"html",success:function(e){t=e},error:function(t){var e=t.toString();alert(e)}}),t&&(this.value?this.value=t:this.innerText=t)}).focus(function(){this.value=this.value.replace(/,/g,"").replace(/$/g,"").replace(/Â¥/g,"")})},[this])}};