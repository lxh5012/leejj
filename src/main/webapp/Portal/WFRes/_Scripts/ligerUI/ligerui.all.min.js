ligeruiGlobalString=$.Lang("ligeruiGlobalString"),function($){if(Function.prototype.ligerExtend=function(e,t){if("function"!=typeof e)return this;this.base=e.prototype,this.base.constructor=e;var i=function(){};i.prototype=e.prototype,this.prototype=new i,this.prototype.constructor=this,t&&$.extend(this.prototype,t)},Function.prototype.ligerDefer=function(e,t,i){var l=this;return setTimeout(function(){l.apply(e,i||[])},t)},window.liger=$.ligerui={version:"V1.2.0",managerCount:0,managers:{},managerIdPrev:"ligerui",autoNewId:!0,error:{managerIsExist:"管理器id已经存在"},pluginPrev:"liger",getId:function(e){e=e||this.managerIdPrev;var t=e+(1e3+this.managerCount);return this.managerCount++,t},add:function(e){if(2==arguments.length){var t=arguments[1];return t.id=t.id||t.options.id||arguments[0].id,void this.addManager(t)}if(e.id||(e.id=this.getId(e.__idPrev())),this.managers[e.id]&&(e.id=this.getId(e.__idPrev())),this.managers[e.id])throw new Error(this.error.managerIsExist);this.managers[e.id]=e},remove:function(e){if("string"==typeof e||"number"==typeof e)delete liger.managers[e];else if("object"==typeof e)if(e instanceof liger.core.Component)delete liger.managers[e.id];else{if(!$(e).attr(this.idAttrName))return!1;delete liger.managers[$(e).attr(this.idAttrName)]}},get:function(e,t){if(t=t||"ligeruiid","string"==typeof e||"number"==typeof e)return liger.managers[e];if("object"==typeof e){var i=e.length?e[0]:e,l=i[t]||$(i).attr(t);return l?liger.managers[l]:null}return null},find:function(e){var t=[];for(var i in this.managers){var l=this.managers[i];e instanceof Function?l instanceof e&&t.push(l):e instanceof Array?$.inArray(l.__getType(),e)!=-1&&t.push(l):l.__getType()==e&&t.push(l)}return t},run:function(e,t,i){if(e){if(i=$.extend({defaultsNamespace:"ligerDefaults",methodsNamespace:"ligerMethods",controlNamespace:"controls",idAttrName:"ligeruiid",isStatic:!1,hasElement:!0,propertyToElemnt:null},i||{}),e=e.replace(/^ligerGet/,""),e=e.replace(/^liger/,""),null==this||this==window||i.isStatic)return liger.plugins[e]||(liger.plugins[e]={fn:$[liger.pluginPrev+e],isStatic:!0}),new $.ligerui[i.controlNamespace][e]($.extend({},$[i.defaultsNamespace][e]||{},$[i.defaultsNamespace][e+"String"]||{},t.length>0?t[0]:{}));if(liger.plugins[e]||(liger.plugins[e]={fn:$.fn[liger.pluginPrev+e],isStatic:!1}),/Manager$/.test(e))return liger.get(this,i.idAttrName);if(this.each(function(){if(this[i.idAttrName]||$(this).attr(i.idAttrName)){var l=liger.get(this[i.idAttrName]||$(this).attr(i.idAttrName));return void(l&&t.length>0&&l.set(t[0]))}if(!(t.length>=1&&"string"==typeof t[0])){var r=t.length>0?t[0]:null,n=$.extend({},$[i.defaultsNamespace][e],$[i.defaultsNamespace][e+"String"],r);i.propertyToElemnt&&(n[i.propertyToElemnt]=this),i.hasElement?new $.ligerui[i.controlNamespace][e](this,n):new $.ligerui[i.controlNamespace][e](n)}}),0==this.length)return null;if(0==t.length)return liger.get(this,i.idAttrName);if("object"==typeof t[0])return liger.get(this,i.idAttrName);if("string"==typeof t[0]){var l=liger.get(this,i.idAttrName);if(null==l)return;if("option"!=t[0]){var r=t[0];if(!l[r])return;var n=Array.apply(null,t);return n.shift(),l[r].apply(l,n)}if(2==t.length)return l.get(t[1]);if(t.length>=3)return l.set(t[1],t[2])}return null}},defaults:{},methods:{},core:{},controls:{},plugins:{}},$.ligerDefaults={},$.ligerMethos={},liger.defaults=$.ligerDefaults,liger.methods=$.ligerMethos,$.fn.liger=function(e){return e?liger.run.call(this,e,arguments):liger.get(this)},liger.core.Component=function(e){this.events=this.events||{},this.options=e||{},this.children={}},$.extend(liger.core.Component.prototype,{__getType:function(){return"liger.core.Component"},__idPrev:function(){return"ligerui"},set:function(e,t){if(e)if("object"!=typeof e){var i=e;if(0==i.indexOf("on"))return void("function"==typeof t&&this.bind(i.substr(2),t));if(this.options||(this.options={}),0!=this.trigger("propertychange",[e,t])){this.options[i]=t;var l="_set"+i.substr(0,1).toUpperCase()+i.substr(1);this[l]&&this[l].call(this,t),this.trigger("propertychanged",[e,t])}}else{var r;if(this.options!=e?($.extend(this.options,e),r=e):r=$.extend({},e),void 0==t||1==t)for(var n in r)0==n.indexOf("on")&&this.set(n,r[n]);if(void 0==t||0==t)for(var n in r)0!=n.indexOf("on")&&this.set(n,r[n])}},get:function(e){var t="_get"+e.substr(0,1).toUpperCase()+e.substr(1);return this[t]?this[t].call(this,e):this.options[e]},hasBind:function(e){var t=e.toLowerCase(),i=this.events[t];return!(!i||!i.length)},trigger:function(e,t){if(e){var i=e.toLowerCase(),l=this.events[i];if(l){t=t||[],t instanceof Array==0&&(t=[t]);for(var r=0;r<l.length;r++){var n=l[r];if(0==n.handler.apply(n.context,t))return!1}}}},bind:function(e,t,i){if("object"!=typeof e){if("function"!=typeof t)return!1;var l=e.toLowerCase(),r=this.events[l]||[];i=i||this,r.push({handler:t,context:i}),this.events[l]=r}else for(var n in e)this.bind(n,e[n])},unbind:function(e,t){if(!e)return void(this.events={});var i=e.toLowerCase(),l=this.events[i];if(l&&l.length)if(t){for(var r=0,n=l.length;r<n;r++)if(l[r].handler==t){l.splice(r,1);break}}else delete this.events[i]},destroy:function(){liger.remove(this)}}),liger.core.UIComponent=function(e,t){liger.core.UIComponent.base.constructor.call(this,t);var i=this._extendMethods();i&&$.extend(this,i),this.element=e,this._init(),this._preRender(),this.trigger("render"),this._render(),this.trigger("rendered"),this._rendered()},liger.core.UIComponent.ligerExtend(liger.core.Component,{__getType:function(){return"liger.core.UIComponent"},_extendMethods:function(){},_init:function(){if(this.type=this.__getType(),this.element?this.id=this.options.id||this.element.id||liger.getId(this.__idPrev()):this.id=this.options.id||liger.getId(this.__idPrev()),liger.add(this),this.element){var attributes=this.attr();if(attributes&&attributes instanceof Array)for(var i=0;i<attributes.length;i++){var name=attributes[i];this.options[name]=$(this.element).attr(name)}var p=this.options;if($(this.element).attr("ligerui"))try{var attroptions=$(this.element).attr("ligerui");0!=attroptions.indexOf("{")&&(attroptions="{"+attroptions+"}"),eval("attroptions = "+attroptions+";"),attroptions&&$.extend(p,attroptions)}catch(e){}}},_preRender:function(){},_render:function(){},_rendered:function(){this.element&&$(this.element).attr("ligeruiid",this.id)},attr:function(){return[]},destroy:function(){this.element&&$(this.element).remove(),this.options=null,liger.remove(this)}}),liger.controls.Input=function(e,t){liger.controls.Input.base.constructor.call(this,e,t)},liger.controls.Input.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Input"},attr:function(){return["nullText"]},setValue:function(e){return this.set("value",e)},getValue:function(){return this.get("value")},_setReadonly:function(e){var t=this.wrapper||this.text;if(t&&t.hasClass("l-text")){var i=this.inputText;e?(i&&i.attr("readonly","readonly"),t.addClass("l-text-readonly")):(i&&i.removeAttr("readonly"),t.removeClass("l-text-readonly"))}},setEnabled:function(){return this.set("disabled",!1)},setDisabled:function(){return this.set("disabled",!0)},updateStyle:function(){},resize:function(e,t){this.set({width:e,height:t})}}),liger.win={top:!1,mask:function(e){function t(){if(liger.win.windowMask){var e=$(window).height()+$(window).scrollTop();liger.win.windowMask.height(e)}}this.windowMask||(this.windowMask=$("<div class='l-window-mask' style='display: block;'></div>").appendTo("body"),$(window).bind("resize.ligeruiwin",t),$(window).bind("scroll",t)),this.windowMask.show(),t(),this.masking=!0},unmask:function(e){for(var t=$("body > .l-dialog:visible,body > .l-window:visible"),i=0,l=t.length;i<l;i++){var r=t.eq(i).attr("ligeruiid");if(!e||e.id!=r){var n=liger.get(r);if(n){var a=n.get("modal");if(a)return}}}this.windowMask&&this.windowMask.hide(),this.masking=!1},createTaskbar:function(){return this.taskbar||(this.taskbar=$('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body"),this.top&&this.taskbar.addClass("l-taskbar-top"),this.taskbar.tasks=$(".l-taskbar-tasks:first",this.taskbar),this.tasks={}),this.taskbar.show(),this.taskbar.animate({bottom:0}),this.taskbar},removeTaskbar:function(){var e=this;e.taskbar.animate({bottom:-32},function(){e.taskbar.remove(),e.taskbar=null})},activeTask:function(e){for(var t in this.tasks){var i=this.tasks[t];t==e.id?i.addClass("l-taskbar-task-active"):i.removeClass("l-taskbar-task-active")}},getTask:function(e){var t=this;if(t.taskbar)return t.tasks[e.id]?t.tasks[e.id]:null},addTask:function(e){var t=this;if(t.taskbar||t.createTaskbar(),t.tasks[e.id])return t.tasks[e.id];var i=e.get("title"),l=t.tasks[e.id]=$('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+i+"</div></div>");return t.taskbar.tasks.append(l),t.activeTask(e),l.bind("click",function(){t.activeTask(e),e.actived?e.min():e.active()}).hover(function(){$(this).addClass("l-taskbar-task-over")},function(){$(this).removeClass("l-taskbar-task-over")}),l},hasTask:function(){for(var e in this.tasks)if(this.tasks[e])return!0;return!1},removeTask:function(e){var t=this;t.taskbar&&(t.tasks[e.id]&&(t.tasks[e.id].unbind(),t.tasks[e.id].remove(),delete t.tasks[e.id]),t.hasTask()||t.removeTaskbar())},setFront:function(e){var t=liger.find(liger.core.Win);for(var i in t){var l=t[i];l==e?($(l.element).css("z-index","9200"),this.activeTask(l)):$(l.element).css("z-index","9100")}}},liger.core.Win=function(e,t){liger.core.Win.base.constructor.call(this,e,t)},liger.core.Win.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Win"},mask:function(){this.options.modal&&liger.win.mask(this)},unmask:function(){this.options.modal&&liger.win.unmask(this)},min:function(){},max:function(){},active:function(){}}),liger.draggable={dragging:!1},liger.resizable={reszing:!1},liger.toJSON="object"==typeof JSON&&JSON.stringify?JSON.stringify:function(e){var t=function(e){return e<10?"0"+e:e},i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l=function(e){return i.lastIndex=0,i.test(e)?'"'+e.replace(i,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'};if(null===e)return"null";var r=typeof e;if("undefined"!==r){if("string"===r)return l(e);if("number"===r||"boolean"===r)return""+e;if("object"===r){if("function"==typeof e.toJSON)return liger.toJSON(e.toJSON());if(e.constructor===Date)return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"Z":null;var n=[];if(e.constructor===Array){for(var a=0,o=e.length;a<o;a++)n.push(liger.toJSON(e[a])||"null");return"["+n.join(",")+"]"}var s,d;for(var c in e){if(r=typeof c,"number"===r)s='"'+c+'"';else{if("string"!==r)continue;s=l(c)}r=typeof e[c],"function"!==r&&"undefined"!==r&&(d=liger.toJSON(e[c]),n.push(s+":"+d))}return"{"+n.join(",")+"}"}}},liger.getEditor=function(e){var t=e.type,i=e.control,l=e.master;return t?(i&&(i=i.substr(0,1).toUpperCase()+i.substr(1)),$.extend({create:function(r,n,a){var o=n.field||n.column,s=a||{},d=$.extend({},e.options),c=$("<input type='"+(e.password?"password":"text")+"'/>");if(e.body&&(c=e.body.clone()),c.appendTo(r),n.field){var u=o.name,h=$.isFunction(s.prefixID)?s.prefixID(l):s.prefixID||"";if(d.id=o.id||h+o.name,$.inArray(t,["select","combobox","autocomplete","popup"])!=-1&&(u=o.textField||o.comboboxName,o.comboboxName&&!o.id&&(d.id=(s.prefixID||"")+o.comboboxName)),$.inArray(t,["select","combobox","autocomplete","popup","radiolist","checkboxlist","listbox"])!=-1&&(d.valueFieldID=h+o.name),!e.body){var g=h+u;c.attr($.extend({name:g},o.attr)),o.cssClass&&c.addClass(o.cssClass),o.validate&&!l.options.unSetValidateAttr&&c.attr("validate",liger.toJSON(o.validate))}$.extend(d,o.options)}if(o.editor){if($.extend(d,o.editor.options),o.editor.valueColumnName&&(d.valueField=o.editor.valueColumnName),o.editor.displayColumnName&&(d.textField=o.editor.displayColumnName),i){var p=liger.defaults[i];for(var f in p)f in o.editor&&(d[f]=o.editor[f])}var v=o.editor.p||o.editor.ext;v="function"==typeof v?v(n):v,$.extend(d,v)}return c["liger"+i](d)},getValue:function(e,t){if(e.getValue)return e.getValue()},setValue:function(e,t,i){e.setValue&&e.setValue(t)},getText:function(e,t){if(e.getText)return e.getText()},setText:function(e,t,i){e.setText&&e.setText(t)},getSelected:function(e,t){if(e.getSelected)return e.getSelected()},resize:function(e,t,i,l){l.field&&(t-=2),e.resize&&e.resize(t,i)},destroy:function(e,t){e.destroy&&e.destroy()}},e)):null},liger.editors={text:{control:"TextBox"},date:{control:"DateEditor",setValue:function(editor,value,editParm){"string"==typeof value&&/^\/Date/.test(value)&&(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)),editor.setValue(value)}},combobox:{control:"ComboBox"},spinner:{control:"Spinner"},checkbox:{control:"CheckBox"},checkboxlist:{control:"CheckBoxList",body:$("<div></div>"),resize:function(e,t,i,l){e.set("width",t-2)}},radiolist:{control:"RadioList",body:$("<div></div>"),resize:function(e,t,i,l){e.set("width",t-2)}},listbox:{control:"ListBox",body:$("<div></div>"),resize:function(e,t,i,l){e.set("width",t-2)}},popup:{control:"PopupEdit"},number:{control:"TextBox",options:{number:!0}},currency:{control:"TextBox",options:{currency:!0}},digits:{control:"TextBox",options:{digits:!0}},password:{control:"TextBox",password:!0}},liger.editors.string=liger.editors.text,liger.editors.select=liger.editors.combobox,liger.editors.int=liger.editors.digits,liger.editors.float=liger.editors.number,liger.editors.chk=liger.editors.checkbox,liger.editors.popupedit=liger.editors.popup,$.fn.live=$.fn.on?$.fn.on:$.fn.live,!$.browser){var userAgent=navigator.userAgent.toLowerCase();$.browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent)}}}(jQuery),function(e){liger.inject={prev:"liger-",defaults:{Grid_detail:{height:null,onShowDetail:null},Grid_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Grid_editor",Grid_popup:"PopupEdit",Grid_grid:"Grid",Grid_condition:"Form",Grid_toolbar:"Toolbar",Grid_fields:"Form_fields",Form_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Form_editor",Form_grid:"Grid",Form_columns:"Grid_columns",Form_condition:"Form",Form_popup:"PopupEdit",Form_buttons:"Button"},config:{Grid:{dynamics:"data,isChecked,detail,rowDraggingRender,toolbar,columns",arrays:"columns",columns:{dynamics:"render,totalSummary,headerRender,columns,editor,columns",arrays:"columns",textProperty:"display",columns:"liger.inject.config.Grid.columns",editor:{dynamics:"data,columns,render,renderItem,grid,condition,ext",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},toolbar:{arrays:"items"}},Form:{dynamics:"validate,fields,buttons",arrays:"fields,buttons",fields:{textProperty:"label",dynamics:"validate,editor",editor:{dynamics:"data,columns,render,renderItem,grid,condition,attr",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},buttons:"liger.inject.config.Button"},PopupEdit:{dynamics:"grid,condition"},Button:{textProperty:"text",dynamics:"click"},ComboBox:{dynamics:"columns,data,tree,grid,condition,render,parms,renderItem"},ListBox:{dynamics:"columns,data,render,parms"},RadioList:{dynamics:"data,parms"},CheckBoxList:{dynamics:"data,parms"}},parse:function(e){try{return null==e?null:new Function("return "+e+";")()}catch(e){return null}},parseDefault:function(t){var i=this;if(!t)return t;var l={};return e(t.split(",")).each(function(t,r){r&&(r=r.substr(0,1).toUpperCase()+r.substr(1),e.extend(l,i.parse("liger.defaults."+r)))}),l},fotmatValue:function(e,t){return"boolean"==t?"true"==e||"1"==e:"number"==t&&e?parseFloat(e.toString()):e},getOptions:function(t){var i=t.jelement,l=t.defaults,r=t.config;r=e.extend({ignores:"",dynamics:"",arrays:""},r);var n,a=this,o={};r.textProperty&&(o[r.textProperty]=i.text());for(var s in l){var d=s.toLowerCase(),c=e("> ."+d,i);if(e.inArray(s,r.ignores.split(","))==-1)if(c.length){var u=t.controlName+"_"+s,h=a.defaults[u]||liger.defaults[u],g=r[s];"string"==typeof h?h=a.parseDefault(h):"funcion"==typeof h&&(h=h()),"string"==typeof g?g=a.parse(g):"funcion"==typeof g&&(g=g()),h&&(e.inArray(s,r.arrays.split(","))!=-1?(n=[],e(">div,>li,>input",c).each(function(){n.push(a.getOptions({defaults:h,controlName:t.controlName,config:g,jelement:e(this)}))}),o[s]=n):o[s]=a.getOptions({defaults:h,controlName:t.controlName,config:g,jelement:c})),c.remove()}else e.inArray(s,r.dynamics.split(","))!=-1||0==s.indexOf("on")?(n=a.parse(i.attr("data-"+s)||i.attr(s)),n&&(o[s]=a.fotmatValue(n,typeof l[s]))):(n=i.attr("data-"+s)||i.attr(s),n&&(o[s]=a.fotmatValue(n,typeof l[s])))}var p=i.attr("data-options")||i.attr("data-property");return p&&(p=a.parse("{"+p+"}")),p&&e.extend(o,p),o},init:function(){var t=this,i=this.config;for(var l in t.defaults)"string"==typeof t.defaults[l]&&(t.defaults[l]=t.parseDefault(t.defaults[l]));for(var r in liger.controls){var n=i[r]||{},a=t.prev+r.toLowerCase();e("."+a).each(function(){var i=e(this),l=e.extend({onrender:null,onrendered:null},liger.defaults[r]),a=t.getOptions({defaults:l,controlName:r,config:n,jelement:i});i[liger.pluginPrev+r](a)})}}},e(function(){liger.inject.init()})}(jQuery),function(e){e.fn.ligerAccordion=function(t){return e.ligerui.run.call(this,"ligerAccordion",arguments)},e.fn.ligerGetAccordionManager=function(){return e.ligerui.get(this)},e.ligerDefaults.Accordion={height:null,speed:"normal",changeHeightOnResize:!1,heightDiff:0},e.ligerMethos.Accordion={},e.ligerui.controls.Accordion=function(t,i){e.ligerui.controls.Accordion.base.constructor.call(this,t,i)},e.ligerui.controls.Accordion.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return e.ligerMethos.Accordion},_render:function(){var t=this,i=this.options;t.accordion=e(t.element),t.accordion.hasClass("l-accordion-panel")||t.accordion.addClass("l-accordion-panel");var l=0;e("> div[lselected=true]",t.accordion).length>0&&(l=e("> div",t.accordion).index(e("> div[lselected=true]",t.accordion))),e("> div",t.accordion).each(function(t,i){var r=e('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');t==l&&e(".l-accordion-toggle",r).addClass("l-accordion-toggle-open"),e(i).attr("title")&&(e(".l-accordion-header-inner",r).html(e(i).attr("title")),e(i).attr("title","")),e(i).before(r),e(i).hasClass("l-accordion-content")||e(i).addClass("l-accordion-content")}),e(".l-accordion-toggle",t.accordion).each(function(){e(this).hasClass("l-accordion-toggle-open")||e(this).hasClass("l-accordion-toggle-close")||e(this).addClass("l-accordion-toggle-close"),e(this).hasClass("l-accordion-toggle-close")&&e(this).parent().next(".l-accordion-content:visible").hide()}),e(".l-accordion-header",t.accordion).hover(function(){e(this).addClass("l-accordion-header-over")},function(){e(this).removeClass("l-accordion-header-over")}),e(".l-accordion-toggle",t.accordion).hover(function(){e(this).hasClass("l-accordion-toggle-open")?e(this).addClass("l-accordion-toggle-open-over"):e(this).hasClass("l-accordion-toggle-close")&&e(this).addClass("l-accordion-toggle-close-over")},function(){e(this).hasClass("l-accordion-toggle-open")?e(this).removeClass("l-accordion-toggle-open-over"):e(this).hasClass("l-accordion-toggle-close")&&e(this).removeClass("l-accordion-toggle-close-over")}),e(">.l-accordion-header",t.accordion).click(function(){var t=e(".l-accordion-toggle:first",this);t.hasClass("l-accordion-toggle-close")?(t.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over"),t.addClass("l-accordion-toggle-open"),e(this).next(".l-accordion-content").show(i.speed).siblings(".l-accordion-content:visible").hide(i.speed),e(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")):(t.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close"),e(this).next(".l-accordion-content").hide(i.speed))}),t.headerHoldHeight=0,e("> .l-accordion-header",t.accordion).each(function(){t.headerHoldHeight+=e(this).height()}),i.height&&"string"==typeof i.height&&i.height.indexOf("%")>0?(t.onResize(),i.changeHeightOnResize&&e(window).resize(function(){t.onResize()})):i.height?(t.height=i.heightDiff+i.height,t.accordion.height(t.height),t.setHeight(i.height)):t.header=t.accordion.height(),t.set(i)},onResize:function(){var t=this,i=this.options;if(!i.height||"string"!=typeof i.height||i.height.indexOf("%")==-1)return!1;if("body"==t.accordion.parent()[0].tagName.toLowerCase()){var l=e(window).height();l-=parseInt(t.layout.parent().css("paddingTop")),l-=parseInt(t.layout.parent().css("paddingBottom")),t.height=i.heightDiff+l*parseFloat(t.height)*.01}else t.height=i.heightDiff+t.accordion.parent().height()*parseFloat(i.height)*.01;t.accordion.height(t.height),t.setContentHeight(t.height-t.headerHoldHeight)},setHeight:function(t){var i=this;this.options;i.accordion.height(t),t-=i.headerHoldHeight,e("> .l-accordion-content",i.accordion).height(t)}})}(jQuery),function(e){e.fn.ligerButton=function(t){return e.ligerui.run.call(this,"ligerButton",arguments)},e.fn.ligerGetButtonManager=function(){return e.ligerui.run.call(this,"ligerGetButtonManager",arguments)},e.ligerDefaults.Button={width:60,text:"Button",disabled:!1,click:null,icon:null},e.ligerMethos.Button={},e.ligerui.controls.Button=function(t,i){e.ligerui.controls.Button.base.constructor.call(this,t,i)},e.ligerui.controls.Button.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return e.ligerMethos.Button},_render:function(){var t=this,i=this.options;t.button=e(t.element),t.button.addClass("l-button"),t.button.append('<div class="l-button-l"></div><div class="l-button-r"></div><span></span>'),t.button.hover(function(){i.disabled||t.button.addClass("l-button-over")},function(){i.disabled||t.button.removeClass("l-button-over")}),i.click&&t.button.click(function(){i.disabled||i.click()}),t.set(i)},_setIcon:function(e){var t=this;e?(t.button.addClass("l-button-hasicon"),t.button.append('<img src="'+e+'" />')):(t.button.removeClass("l-button-hasicon"),t.button.find("img").remove())},_setEnabled:function(e){e&&this.button.removeClass("l-button-disabled")},_setDisabled:function(e){e?(this.button.addClass("l-button-disabled"),this.options.disabled=!0):(this.button.removeClass("l-button-disabled"),this.options.disabled=!1)},_setWidth:function(e){this.button.width(e)},_setText:function(t){e("span",this.button).html(t)},setValue:function(e){this.set("text",e)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",!1)},setDisabled:function(){this.set("disabled",!0)}})}(jQuery),function(e){e.fn.ligerCheckBox=function(t){return e.ligerui.run.call(this,"ligerCheckBox",arguments)},e.fn.ligerGetCheckBoxManager=function(){return e.ligerui.run.call(this,"ligerGetCheckBoxManager",arguments)},e.ligerDefaults.CheckBox={disabled:!1,readonly:!1},e.ligerMethos.CheckBox={},e.ligerui.controls.CheckBox=function(t,i){e.ligerui.controls.CheckBox.base.constructor.call(this,t,i)},e.ligerui.controls.CheckBox.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return e.ligerMethos.CheckBox},_render:function(){var t=this,i=this.options;t.input=e(t.element),t.link=e('<a class="l-checkbox"></a>'),t.wrapper=t.input.addClass("l-hidden").wrap('<div class="l-checkbox-wrapper"></div>').parent(),t.wrapper.prepend(t.link),t.link.click(function(){return!t.input.attr("disabled")&&!t.input.attr("readonly")&&(!i.disabled&&!i.readonly&&(0!=t.trigger("beforeClick",[t.element])&&(e(this).hasClass("l-checkbox-checked")?t._setValue(!1):t._setValue(!0),void t.input.trigger("change"))))}),t.wrapper.hover(function(){i.disabled||e(this).addClass("l-over")},function(){e(this).removeClass("l-over")}),this.set(i),this.updateStyle()},_setCss:function(e){this.wrapper.css(e)},_setValue:function(e){var t=this;this.options;e?(t.input[0].checked=!0,t.link.addClass("l-checkbox-checked")):(t.input[0].checked=!1,t.link.removeClass("l-checkbox-checked"))},_setDisabled:function(e){e?(this.input.attr("disabled",!0),this.wrapper.addClass("l-disabled")):(this.input.attr("disabled",!1),this.wrapper.removeClass("l-disabled"))},_getValue:function(){return this.element.checked},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0),this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")}})}(jQuery),function(e){e.fn.ligerCheckBoxList=function(t){return e.ligerui.run.call(this,"ligerCheckBoxList",arguments)},e.ligerDefaults.CheckBoxList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null},e.ligerMethos.CheckBoxList=e.ligerMethos.CheckBoxList||{},e.ligerui.controls.CheckBoxList=function(t,i){e.ligerui.controls.CheckBoxList.base.constructor.call(this,t,i)},e.ligerui.controls.CheckBoxList.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"CheckBoxList"},_extendMethods:function(){return e.ligerMethos.CheckBoxList},_init:function(){e.ligerui.controls.CheckBoxList.base._init.call(this)},_render:function(){var t=this,i=this.options;t.data=i.data,t.valueField=null,i.valueFieldID?(t.valueField=e("#"+i.valueFieldID+":input,[name="+i.valueFieldID+"]:input"),0==t.valueField.length&&(t.valueField=e('<input type="hidden"/>')),t.valueField[0].id=t.valueField[0].name=i.valueFieldID):(t.valueField=e('<input type="hidden"/>'),t.valueField[0].id=t.valueField[0].name=t.id+"_val"),null==t.valueField[0].name&&(t.valueField[0].name=t.valueField[0].id),i.valueFieldCssClass&&t.valueField.addClass(i.valueFieldCssClass),t.valueField.attr("data-ligerid",t.id),t.checkboxList=e(this.element),t.checkboxList.html('<div class="l-checkboxlist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-checkboxlist-table"></table></div>').addClass("l-checkboxlist").append(t.valueField),t.checkboxList.table=e("table:first",t.checkboxList),t.set(i),t._addClickEven()},destroy:function(){this.checkboxList&&this.checkboxList.remove(),this.options=null,e.ligerui.remove(this)},clear:function(){this._changeValue(""),this.trigger("clear")},_setCss:function(e){e&&this.checkboxList.addClass(e)},_setDisabled:function(t){t?(this.checkboxList.addClass("l-checkboxlist-disabled"),e("input:checkbox",this.radioList).attr("disabled",!0)):(this.checkboxList.removeClass("l-checkboxlist-disabled"),e("input:checkbox",this.radioList).removeAttr("disabled"))},_setWidth:function(e){this.checkboxList.width(e)},_setHeight:function(e){this.checkboxList.height(e)},indexOf:function(e){var t=this,i=this.options;if(!t.data)return-1;for(var l=0,r=t.data.length;l<r;l++)if("object"==typeof e){if(t.data[l]==e)return l}else if(t.data[l][i.valueField].toString()==e.toString())return l;return-1},removeItems:function(t){var i=this;i.data&&(e(t).each(function(e,t){var l=i.indexOf(t);l!=-1&&i.data.splice(l,1)}),i.refresh())},removeItem:function(e){if(this.data){var t=this.indexOf(e);t!=-1&&(this.data.splice(t,1),this.refresh())}},insertItem:function(e,t){var i=this;i.data||(i.data=[]),i.data.splice(t,0,e),i.refresh()},addItems:function(t){var i=this;i.data||(i.data=[]),e(t).each(function(e,t){i.data.push(t)}),i.refresh()},addItem:function(e){var t=this;t.data||(t.data=[]),t.data.push(e),t.refresh()},_setValue:function(e){var t=this,i=this.options;i.value=e,t.valueField.val(i.value),this._dataInit()},setValue:function(e){this._setValue(e)},_setUrl:function(t){if(t){var i=this,l=this.options,r=e.isFunction(l.parms)?l.parms():l.parms;e.ajax({type:"post",url:t,data:r,cache:!1,dataType:"json",success:function(e){i.setData(e),i.trigger("success",[e])},error:function(e,t){i.trigger("error",[e,t])}})}},setUrl:function(e){return this._setUrl(e)},setParm:function(e,t){if(e){var i=this,l=i.get("parms");l||(l={}),l[e]=t,i.set("parms",l)}},clearContent:function(){var t=this;this.options;e("table",t.checkboxList).html("")},_setData:function(e){this.setData(e)},setData:function(e){var t=this;this.options;e&&e.length&&(t.data=e,t.refresh(),t.updateStyle())},refresh:function(){var e=this,t=this.options,i=this.data;if(this.clearContent(),i){for(var l=[],r=t.rowSize,n=!1,a=t.name||e.id,o=0;o<i.length;o++){var s=i[o][t.valueField],d=i[o][t.textField],c=e.id+"-"+o,u=o%r==0;u&&(n&&l.push("</tr>"),l.push("<tr>"),n=!0),l.push("<td><input type='checkbox' name='"+a+"' value='"+s+"' id='"+c+"'/><label for='"+c+"'>"+d+"</label></td>")}n&&l.push("</tr>"),e.checkboxList.table.append(l.join(""))}},_getValue:function(){var t=this,i=this.options,l=i.name||t.id,r=[];return e('input:checkbox[name="'+l+'"]:checked').each(function(){r.push(this.value)}),r.length?r.join(i.split):null},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var e=this,t=(this.options,e.valueField.val());e._changeValue(t)},_changeValue:function(t){var i=this,l=this.options,r=l.name||i.id,n=t?t.split(l.split):[];e("input:checkbox[name='"+r+"']",i.checkboxList).each(function(){this.checked=e.inArray(this.value,n)>-1}),i.valueField.val(t),i.selectedValue=t},_addClickEven:function(){var e=this;this.options;e.checkboxList.click(function(t){var i=e.getValue();i&&e.valueField.val(i)})}})}(jQuery),function(e){e.fn.ligerComboBox=function(t){return e.ligerui.run.call(this,"ligerComboBox",arguments)},e.fn.ligerGetComboBoxManager=function(){return e.ligerui.run.call(this,"ligerGetComboBoxManager",arguments)},e.ligerDefaults.ComboBox={resize:!1,isMultiSelect:!1,isShowCheckBox:!1,columns:null,selectBoxWidth:null,selectBoxHeight:null,onBeforeSelect:!1,onSelected:null,initValue:null,initText:null,valueField:"id",textField:"text",valueFieldID:null,slide:!1,split:";",data:null,tree:null,treeLeafOnly:!0,condition:null,grid:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:!0,hideGridOnLoseFocus:!1,url:null,onSuccess:null,onError:null,onBeforeOpen:null,render:null,absolute:!0,cancelable:!0,css:null,parms:null,renderItem:null,autocomplete:!1,readonly:!1,ajaxType:"post",alwayShowInTop:!1,valueFieldCssClass:null},e.ligerDefaults.ComboBoxString={Search:"搜索"},e.ligerMethos.ComboBox=e.ligerMethos.ComboBox||{},e.ligerui.controls.ComboBox=function(t,i){e.ligerui.controls.ComboBox.base.constructor.call(this,t,i)},e.ligerui.controls.ComboBox.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return e.ligerMethos.ComboBox},_init:function(){e.ligerui.controls.ComboBox.base._init.call(this);var t=this.options;t.columns&&(t.isShowCheckBox=!0),t.isMultiSelect&&(t.isShowCheckBox=!0)},_render:function(){var t=this,i=this.options;t.data=i.data,t.inputText=null,t.select=null,t.textFieldID="",t.valueFieldID="",t.valueField=null,"input"==this.element.tagName.toLowerCase()?(this.element.readOnly=!0,t.inputText=e(this.element),t.textFieldID=this.element.id):"select"==this.element.tagName.toLowerCase()&&(e(this.element).hide(),t.select=e(this.element),i.isMultiSelect=!1,i.isShowCheckBox=!1,i.cancelable=!1,t.textFieldID=this.element.id+"_txt",t.inputText=e('<input type="text" readonly="true"/>'),
t.inputText.attr("id",t.textFieldID).insertAfter(e(this.element))),void 0==t.inputText[0].name&&(t.inputText[0].name=t.textFieldID),t.valueField=null,i.valueFieldID?(t.valueField=e("#"+i.valueFieldID+":input,[name="+i.valueFieldID+"]:input").filter("input:hidden"),0==t.valueField.length&&(t.valueField=e('<input type="hidden"/>')),t.valueField[0].id=t.valueField[0].name=i.valueFieldID):(t.valueField=e('<input type="hidden"/>'),t.valueField[0].id=t.valueField[0].name=t.textFieldID+"_val"),i.valueFieldCssClass&&t.valueField.addClass(i.valueFieldCssClass),void 0==t.valueField[0].name&&(t.valueField[0].name=t.valueField[0].id),t.valueField.attr("data-ligerid",t.id),t.link=e('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),t.selectBox=e('<div class="l-box-select" style="display:none"><div class="l-box-select-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-box-select-table"></table></div></div>'),t.selectBox.table=e("table:first",t.selectBox),t.wrapper=t.inputText.wrap('<div class="l-text l-text-combobox"></div>').parent(),t.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),t.wrapper.append(t.link),t.textwrapper=t.wrapper.wrap('<div class="l-text-wrapper"></div>').parent(),i.absolute?t.selectBox.appendTo("body").addClass("l-box-select-absolute"):t.textwrapper.append(t.selectBox),t.textwrapper.append(t.valueField),t.inputText.addClass("l-text-field"),i.isShowCheckBox&&!t.select?e("table",t.selectBox).addClass("l-table-checkbox"):(i.isShowCheckBox=!1,e("table",t.selectBox).addClass("l-table-nocheckbox")),t.link.hover(function(){i.disabled||i.readonly||(this.className="l-trigger-hover")},function(){i.disabled||i.readonly||(this.className="l-trigger")}).mousedown(function(){i.disabled||i.readonly||(this.className="l-trigger-pressed")}).mouseup(function(){i.disabled||i.readonly||(this.className="l-trigger-hover")}).click(function(){if(!i.disabled&&!i.readonly)return 0!=t.trigger("beforeOpen")&&void t._toggleSelectBox(t.selectBox.is(":visible"))}),t.inputText.click(function(){if(!i.disabled&&!i.readonly)return 0!=t.trigger("beforeOpen")&&void t._toggleSelectBox(t.selectBox.is(":visible"))}).blur(function(){i.disabled||t.wrapper.removeClass("l-text-focus")}).focus(function(){i.disabled||i.readonly||t.wrapper.addClass("l-text-focus")}),t.wrapper.hover(function(){i.disabled||i.readonly||t.wrapper.addClass("l-text-over")},function(){i.disabled||i.readonly||t.wrapper.removeClass("l-text-over")}),t.resizing=!1,t.selectBox.hover(null,function(e){i.hideOnLoseFocus&&t.selectBox.is(":visible")&&!t.boxToggling&&!t.resizing&&t._toggleSelectBox(!0)}),t.bulidContent(),t.set(i),i.selectBoxWidth?t.selectBox.width(i.selectBoxWidth):t.selectBox.css("width",t.wrapper.css("width")),i.grid&&t.bind("show",function(){t.grid||(t.setGrid(i.grid),t.set("SelectBoxHeight",i.selectBoxHeight))}),t.updateSelectBoxPosition(),e(document).bind("click.combobox",function(e){var i=(e.target||e.srcElement).tagName.toLowerCase();"html"!=i&&"body"!=i||t._toggleSelectBox(!0)})},destroy:function(){this.wrapper&&this.wrapper.remove(),this.selectBox&&this.selectBox.remove(),this.options=null,e.ligerui.remove(this)},clear:function(){this._changeValue("",""),this.trigger("clear")},_setSelectBoxHeight:function(t){if(t){var i=this,l=this.options;if(l.grid)i.grid&&i.grid.set("height",i.getGridHeight(t));else if(!l.table){var r=e("tr",i.selectBox.table).length;!l.selectBoxHeight&&r<8&&(l.selectBoxHeight=30*r),l.selectBoxHeight&&i.selectBox.height(l.selectBoxHeight)}}},_setCss:function(e){e&&this.wrapper.addClass(e)},_setCancelable:function(t){var i=this,l=this.options;!t&&i.unselect&&(i.unselect.remove(),i.unselect=null),(t||i.unselect)&&(i.unselect=e('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide(),i.wrapper.hover(function(){i.unselect.show()},function(){i.unselect.hide()}),l.disabled||l.readonly||!l.cancelable||i.wrapper.append(i.unselect),i.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){i.clear()}))},_setDisabled:function(e){e?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_setReadonly:function(e){e?this.wrapper.addClass("l-text-readonly"):this.wrapper.removeClass("l-text-readonly")},_setLable:function(t){var i=this,l=this.options;t&&(i.labelwrapper?i.labelwrapper.find(".l-text-label:first").html(t+":&nbsp"):(i.labelwrapper=i.textwrapper.wrap('<div class="l-labeltext"></div>').parent(),i.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+t+":&nbsp</div>"),i.textwrapper.css("float","left")),l.labelWidth?e(".l-text-label",i.labelwrapper).outerWidth(l.labelWidth):l.labelWidth=e(".l-text-label",i.labelwrapper).outerWidth(),e(".l-text-label",i.labelwrapper).width(l.labelWidth),e(".l-text-label",i.labelwrapper).height(i.wrapper.height()),i.labelwrapper.append('<br style="clear:both;" />'),l.labelAlign&&e(".l-text-label",i.labelwrapper).css("text-align",l.labelAlign),i.textwrapper.css({display:"inline"}),i.labelwrapper.width(i.wrapper.outerWidth()+l.labelWidth+2))},_setWidth:function(e){var t=this,i=this.options;e>20&&(t.wrapper.css({width:e}),t.inputText.css({width:e-20}),t.textwrapper.css({width:e}),i.selectBoxWidth||t.selectBox.css({width:e}))},_setHeight:function(e){var t=this;e>10&&(t.wrapper.height(e),t.inputText.height(e-2),t.textwrapper.css({width:e}))},_setResize:function(t){var i=this,l=this.options;l.columns||t&&e.fn.ligerResizable&&(i.selectBox.ligerResizable({handles:"se,s,e",onStartResize:function(){i.resizing=!0,i.trigger("startResize")},onEndResize:function(){if(i.resizing=!1,0==i.trigger("endResize"))return!1},onStopResize:function(e,t){return!i.grid||(e.newWidth&&i.selectBox.width(e.newWidth),e.newHeight&&i.set({selectBoxHeight:e.newHeight}),i.grid.refreshSize(),i.trigger("endResize"),!1)}}),i.selectBox.append("<div class='l-btn-nw-drop'></div>"))},findTextByValue:function(t){var i=this,l=this.options;if(null==t)return"";var r="",n=function(e){for(var i=t.toString().split(l.split),r=0;r<i.length;r++)if(i[r]==e)return!0;return!1};return e(i.data).each(function(e,t){var i=t[l.valueField],a=t[l.textField];n(i)&&(r+=a+l.split)}),r.length>0&&(r=r.substr(0,r.length-1)),r},findValueByText:function(t){var i=this,l=this.options;if(!t&&""==t)return"";var r=function(e){for(var i=t.toString().split(l.split),r=0;r<i.length;r++)if(i[r]==e)return!0;return!1},n="";return e(i.data).each(function(e,t){var i=t[l.valueField],a=t[l.textField];r(a)&&(n+=i+l.split)}),n.length>0&&(n=n.substr(0,n.length-1)),n},removeItem:function(){},insertItem:function(){},addItem:function(){},_setValue:function(t,i){var l=this,r=this.options;if(i=l.findTextByValue(t),r.tree)l.selectValueByTree(t);else if(r.isMultiSelect){if(l._changeValue(t,i),null!=t){var n=t.toString().split(r.split);e("table.l-table-checkbox :checkbox",l.selectBox).each(function(){this.checked=!1});for(var a=0;a<n.length;a++)e("table.l-table-checkbox tr[value="+n[a]+"] :checkbox",l.selectBox).each(function(){this.checked=!0})}}else l._changeValue(t,i),e("tr[value='"+t+"'] td",l.selectBox).addClass("l-selected"),e("tr[value!='"+t+"'] td",l.selectBox).removeClass("l-selected")},selectValue:function(e){this._setValue(e)},bulidContent:function(){var e=this,t=this.options;this.clearContent(),e.select?e.setSelect():t.tree&&e.setTree(t.tree)},reload:function(){var e=this,t=this.options;t.url?e.set("url",t.url):e.grid&&e.grid.reload()},_setUrl:function(t){if(t){var i=this,l=this.options,r=e.isFunction(l.parms)?l.parms():l.parms;e.ajax({type:l.ajaxType,url:t,data:r,cache:!1,dataType:"json",success:function(e){i.setData(e),i.trigger("success",[e])},error:function(e,t){i.trigger("error",[e,t])}})}},setUrl:function(e){return this._setUrl(e)},setParm:function(e,t){if(e){var i=this,l=i.get("parms");l||(l={}),l[e]=t,i.set("parms",l)}},clearContent:function(){var t=this;this.options;e("table",t.selectBox).html("")},setSelect:function(){var t=this,i=this.options;this.clearContent(),e("option",t.select).each(function(i){var l=e(this).val(),r=e(this).html(),n=e("<tr><td index='"+i+"' value='"+l+"' text='"+r+"'>"+r+"</td>");e("table.l-table-nocheckbox",t.selectBox).append(n),e("td",n).hover(function(){e(this).addClass("l-over")},function(){e(this).removeClass("l-over")})}),e("td:eq("+t.select[0].selectedIndex+")",t.selectBox).each(function(){if(e(this).hasClass("l-selected"))return void t.selectBox.hide();e(".l-selected",t.selectBox).removeClass("l-selected"),e(this).addClass("l-selected"),t.select[0].selectedIndex!=e(this).attr("index")&&t.select[0].onchange&&(t.select[0].selectedIndex=e(this).attr("index"),t.select[0].onchange());var l=parseInt(e(this).attr("index"));t.select[0].selectedIndex=l,t.select.trigger("change"),t.selectBox.hide();var r=e(this).attr("value"),n=e(this).html();i.render?t.inputText.val(i.render(r,n)):t.inputText.val(n)}),t._addClickEven()},_setData:function(e){this.setData(e)},setData:function(t){var i=this,l=this.options;if(t&&t.length){if(i.data!=t&&(i.data=t),this.clearContent(),l.columns){i.selectBox.table.headrow=e("<tr class='l-table-headerow'><td width='18px'></td></tr>"),i.selectBox.table.append(i.selectBox.table.headrow),i.selectBox.table.addClass("l-box-select-grid");for(var r=0;r<l.columns.length;r++){var n=e("<td columnindex='"+r+"' columnname='"+l.columns[r].name+"'>"+l.columns[r].header+"</td>");l.columns[r].width&&n.width(l.columns[r].width),i.selectBox.table.headrow.append(n)}}for(var a=[],o=0;o<t.length;o++){var s=t[o][l.valueField],d=t[o][l.textField];if(l.columns){a.push("<tr value='"+s+"'><td style='width:18px;'  index='"+o+"' value='"+s+"' text='"+d+"' ><input type='checkbox' /></td>");for(var r=0;r<l.columns.length;r++){var c=l.columns[r].name;a.push("<td>"+t[o][c]+"</td>")}a.push("</tr>")}else{a.push("<tr value='"+s+"'>"),l.isShowCheckBox&&a.push("<td style='width:18px;'  index='"+o+"' value='"+s+"' text='"+d+"' ><input type='checkbox' /></td>");var u=d;l.renderItem?u=l.renderItem.call(i,{data:t[o],value:s,text:d,key:i.inputText.val()}):l.autocomplete&&(u=i._highLight(d,i.inputText.val())),a.push("<td index='"+o+"' value='"+s+"' text='"+d+"' align='left'>"+u+"</td></tr>")}}l.columns?i.selectBox.table.append(a.join("")):l.isShowCheckBox?e("table.l-table-checkbox",i.selectBox).append(a.join("")):e("table.l-table-nocheckbox",i.selectBox).append(a.join("")),l.isShowCheckBox&&e.fn.ligerCheckBox&&e("table input:checkbox",i.selectBox).ligerCheckBox(),e(".l-table-checkbox input:checkbox",i.selectBox).change(function(){if(this.checked&&i.hasBind("beforeSelect")){var t=null;if(t="div"==e(this).parent().get(0).tagName.toLowerCase()?e(this).parent().parent():e(this).parent(),null!=t&&0==i.trigger("beforeSelect",[t.attr("value"),t.attr("text")]))return i.selectBox.slideToggle("fast"),!1}l.isMultiSelect||this.checked&&(e("input:checked",i.selectBox).not(this).each(function(){this.checked=!1,e(".l-checkbox-checked",e(this).parent()).removeClass("l-checkbox-checked")}),i.selectBox.slideToggle("fast")),i._checkboxUpdateValue()}),e("table.l-table-nocheckbox td",i.selectBox).hover(function(){e(this).addClass("l-over")},function(){e(this).removeClass("l-over")}),i._addClickEven(),l.autocomplete||i.updateStyle()}},setTree:function(t){var i=this,l=this.options;this.clearContent(),i.selectBox.table.remove(),0!=t.checkbox?t.onCheck=function(){var t=i.treeManager.getChecked(),r=[],n=[];e(t).each(function(e,t){l.treeLeafOnly&&t.data.children||(r.push(t.data[l.valueField]),n.push(t.data[l.textField]))}),i._changeValue(r.join(l.split),n.join(l.split))}:(t.onSelect=function(t){if(0!=i.trigger("BeforeSelect"[t])&&(!l.treeLeafOnly||!e.isFunction(l.tree.isLeaf)||l.tree.isLeaf(t.data))){var r=t.data[l.valueField],n=t.data[l.textField];i._changeValue(r,n)}},t.onCancelSelect=function(e){i._changeValue("","")}),e.isFunction(t.onAfterAppend)||(t.onAfterAppend=function(e,t){if(i.treeManager){var r=null;l.initValue?r=l.initValue:""!=i.valueField.val()&&(r=i.valueField.val()),i.selectValueByTree(r)}}),i.tree=e("<ul></ul>"),e("div:first",i.selectBox).append(i.tree),i.tree.ligerTree(t),i.treeManager=i.tree.ligerGetTreeManager()},selectValueByTree:function(t){var i=this,l=this.options;if(null!=t){var r="",n=t.toString().split(l.split);e(n).each(function(e,t){i.treeManager.selectNode(t.toString()),r+=i.treeManager.getTextByID(t),e<n.length-1&&(r+=l.split)}),i._changeValue(t,r)}},setGrid:function(t){var i=this,l=this.options;if(!i.grid){l.hideOnLoseFocus=!!l.hideGridOnLoseFocus,this.clearContent(),i.selectBox.addClass("l-box-select-lookup"),i.selectBox.table.remove();var r=e("div:first",i.selectBox),n=e("<div></div>").appendTo(r),a=e("<div></div>").appendTo(r);if(i.conditionPanel=n,l.condition){var o=e.extend({labelWidth:60,space:20},l.condition);i.condition=n.ligerForm(o)}else n.remove();t=e.extend({columnWidth:120,alternatingRow:!1,frozen:!0,rownumbers:!0,allowUnSelectRow:!0},t,{width:"100%",height:i.getGridHeight(),inWindow:!1,parms:l.parms,isChecked:function(t){var r=i.getValue();return!!r&&(!(!l.valueField||!t[l.valueField])&&e.inArray(t[l.valueField].toString(),r.split(l.split))!=-1)}}),i.grid=i.gridManager=a.ligerGrid(t),i.grid.bind("afterShowData",function(){i.updateSelectBoxPosition()});var s=[],d=function(){var r=[],n=[];e(s).each(function(e,t){r.push(t[l.valueField]),n.push(t[l.textField])}),t.checkbox?i.selected=s:s.length?i.selected=s[0]:i.selected=null,i._changeValue(r.join(l.split),n.join(l.split)),i.trigger("gridSelect",{value:r.join(l.split),text:n.join(l.split),data:s})},c=function(e){for(var t=s.length-1;t>=0;t--)s[t][l.valueField]==e[l.valueField]&&s.splice(t,1)},u=function(e){for(var t=s.length-1;t>=0;t--)if(s[t][l.valueField]==e[l.valueField])return;s.push(e)};if(t.checkbox){var h=function(e,t){e&&u(t),!e&&c(t)};i.grid.bind("CheckAllRow",function(t){e(i.grid.rows).each(function(e){h(t,e)}),d()}),i.grid.bind("CheckRow",function(e,t){h(e,t),d()})}else i.grid.bind("SelectRow",function(e){s=[e],d(),i._toggleSelectBox(!0)}),i.grid.bind("UnSelectRow",function(){s=[],d()});if(i.bind("show",function(){i.grid.refreshSize()}),i.bind("clear",function(){s=[],i.grid.selecteds=[],i.grid._showData()}),l.condition){var g=e('<li style="margin-right:9px"><div></div></li>'),p=e('<li style="margin-right:9px;float:right"><div></div></li>');e("ul:first",n).append(g).append(p).after('<div class="l-clear"></div>'),e("div",g).ligerButton({text:l.Search,width:40,click:function(){var l=i.condition.toConditions();i.grid.setParm(t.conditionParmName||"condition",e.ligerui.toJSON(l)),i.grid.reload()}}),e("div",p).ligerButton({text:"关闭",width:40,click:function(){i.selectBox.hide()}})}i.grid.refreshSize()}},getGridHeight:function(e){var t=this;this.options;return e=e||t.selectBox.height(),e-=t.conditionPanel.height()},_getValue:function(){return e(this.valueField).val()},getValue:function(){return this._getValue()},getSelected:function(){return this.selected},getText:function(){return this.inputText.val()},setText:function(e){this.inputText.val(e)},updateStyle:function(){var e=this,t=this.options;t.initValue=t.initValue||e._getValue(),e._dataInit()},_dataInit:function(){var t=this,i=this.options,l=null;if(null!=i.initValue&&null!=i.initText&&t._changeValue(i.initValue,i.initText),null!=i.initValue){if(l=i.initValue,i.tree)l&&t.selectValueByTree(l);else if(t.data){var r=t.findTextByValue(l);t._changeValue(l,r)}}else if(""!=t.valueField.val())if(l=t.valueField.val(),i.tree)l&&t.selectValueByTree(l);else if(t.data){var r=t.findTextByValue(l);t._changeValue(l,r)}i.isShowCheckBox?e(":checkbox",t.selectBox).each(function(){var t=null,r=e(this);if(t="div"==r.parent().get(0).tagName.toLowerCase()?r.parent().parent():r.parent(),null!=t){e(".l-checkbox",t).removeClass("l-checkbox-checked"),r[0].checked=!1;var n=(l||"").toString().split(i.split);e(n).each(function(i,n){null!=l&&n==t.attr("value")&&(e(".l-checkbox",t).addClass("l-checkbox-checked"),r[0].checked=!0)})}}):e("table tr",t.selectBox).find("td:first").each(function(){null!=l&&l==e(this).attr("value")?e(this).addClass("l-selected"):e(this).removeClass("l-selected")})},_changeValue:function(e,t){var i=this,l=this.options;i.valueField.val(e),l&&l.render?i.inputText.val(l.render(e,t)):i.inputText.val(t),i.selectedValue=e,i.selectedText=t,i.inputText.trigger("change").focus(),i.trigger("selected",[e,t])},_checkboxUpdateValue:function(){var t=this,i=this.options,l="",r="";e("input:checked",t.selectBox).each(function(){var t=null;t="div"==e(this).parent().get(0).tagName.toLowerCase()?e(this).parent().parent():e(this).parent(),t&&(l+=t.attr("value")+i.split,r+=t.attr("text")+i.split)}),l.length>0&&(l=l.substr(0,l.length-1)),r.length>0&&(r=r.substr(0,r.length-1)),t._changeValue(l,r)},_addClickEven:function(){var t=this,i=this.options;e(".l-table-nocheckbox td",t.selectBox).click(function(){var l=e(this).attr("value"),r=parseInt(e(this).attr("index")),n=e(this).attr("text");return t.hasBind("beforeSelect")&&0==t.trigger("beforeSelect",[l,n])?(i.slide?t.selectBox.slideToggle("fast"):t.selectBox.hide(),!1):e(this).hasClass("l-selected")?void(i.slide?t.selectBox.slideToggle("fast"):t.selectBox.hide()):(e(".l-selected",t.selectBox).removeClass("l-selected"),e(this).addClass("l-selected"),t.select&&t.select[0].selectedIndex!=r&&(t.select[0].selectedIndex=r,t.select.trigger("change")),i.slide?(t.boxToggling=!0,t.selectBox.hide("fast",function(){t.boxToggling=!1})):t.selectBox.hide(),void t._changeValue(l,n))})},updateSelectBoxPosition:function(){var t=this,i=this.options;if(i&&i.absolute){var l=e(document).height();i.alwayShowInTop||Number(t.wrapper.offset().top+1+t.wrapper.outerHeight()+t.selectBox.height())>l&&l>Number(t.selectBox.height()+1)?t.selectBox.css({left:t.wrapper.offset().left,top:t.wrapper.offset().top-1-t.selectBox.height()}):t.selectBox.css({left:t.wrapper.offset().left,top:t.wrapper.offset().top+1+t.wrapper.outerHeight()})}else{var r=t.wrapper.offset().top-e(window).scrollTop(),n=t.selectBox.height()+textHeight+4;r+n>e(window).height()&&r>n&&t.selectBox.css("marginTop",-1*(t.selectBox.height()+textHeight+5))}},_toggleSelectBox:function(t){var i=this,l=this.options;i.wrapper.height();if(i.boxToggling=!0,t)l.slide?i.selectBox.slideToggle("fast",function(){i.boxToggling=!1}):(i.selectBox.hide(),i.boxToggling=!1);else if(i.updateSelectBoxPosition(),l.slide)i.selectBox.slideToggle("fast",function(){if(i.boxToggling=!1,!l.isShowCheckBox&&e("td.l-selected",i.selectBox).length>0){var t=e("td.l-selected",i.selectBox).offset().top-i.selectBox.offset().top;e(".l-box-select-inner",i.selectBox).animate({scrollTop:t})}});else if(i.selectBox.show(),i.boxToggling=!1,!i.tree&&!i.grid&&!l.isShowCheckBox&&e("td.l-selected",i.selectBox).length>0){var r=e("td.l-selected",i.selectBox).offset().top-i.selectBox.offset().top;e(".l-box-select-inner",i.selectBox).animate({scrollTop:r})}i.isShowed=i.selectBox.is(":visible"),i.trigger("toggle",[t]),i.trigger(t?"hide":"show")},_highLight:function(e,t){var i=e.indexOf(t);return i==-1?e:e.substring(0,i)+"<span class='l-highLight'>"+t+"</span>"+e.substring(t.length+i)},_setAutocomplete:function(e){var t=this,i=this.options;if(e){t.inputText.removeAttr("readonly");var l=t.inputText.val();t.inputText.keyup(function(){setTimeout(function(){l!=t.inputText.val()&&(i.initValue="",t.valueField.val(""),i.url?(t.setParm("key",t.inputText.val()),t.set("url",i.url),t.selectBox.show()):i.grid&&(t.grid.setParm("key",t.inputText.val()),t.grid.reload()),l=t.inputText.val())},1)})}}}),e.ligerui.controls.ComboBox.prototype.setValue=e.ligerui.controls.ComboBox.prototype.selectValue,e.ligerui.controls.ComboBox.prototype.setInputValue=e.ligerui.controls.ComboBox.prototype._changeValue}(jQuery),function($){$.fn.ligerDateEditor=function(){return $.ligerui.run.call(this,"ligerDateEditor",arguments)},$.fn.ligerGetDateEditorManager=function(){return $.ligerui.run.call(this,"ligerGetDateEditorManager",arguments)},$.ligerDefaults.DateEditor={format:"yyyy-MM-dd",showTime:!1,onChangeDate:!1,absolute:!0,cancelable:!0,readonly:!1},$.ligerDefaults.DateEditorString={dayMessage:["日","一","二","三","四","五","六"],monthMessage:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],todayMessage:"今天",closeMessage:"关闭"},$.ligerMethos.DateEditor={},$.ligerui.controls.DateEditor=function(e,t){$.ligerui.controls.DateEditor.base.constructor.call(this,e,t)},$.ligerui.controls.DateEditor.ligerExtend($.ligerui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return $.ligerMethos.DateEditor},_render:function(){var e=this,t=this.options;if(!t.showTime&&t.format.indexOf(" hh:mm")>-1&&(t.format=t.format.replace(" hh:mm","")),"input"==this.element.tagName.toLowerCase()&&"text"==this.element.type){e.inputText=$(this.element),e.inputText.hasClass("l-text-field")||e.inputText.addClass("l-text-field"),e.link=$('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),e.text=e.inputText.wrap('<div class="l-text l-text-date"></div>').parent(),e.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),e.text.append(e.link),e.textwrapper=e.text.wrap('<div class="l-text-wrapper"></div>').parent();var i="";i+="<div class='l-box-dateeditor' style='display:none'>",i+="    <div class='l-box-dateeditor-header'>",i+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>",i+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>",i+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>",i+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>",i+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>",i+="    </div>",i+="    <div class='l-box-dateeditor-body'>",i+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>",i+="            <thead>",i+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",i+="            </thead>",i+="            <tbody>",i+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",i+="            </tbody>",i+="        </table>",i+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",i+="        <ul class='l-box-dateeditor-yearselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",i+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",i+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",i+="    </div>",i+="    <div class='l-box-dateeditor-toolbar'>",i+="        <div class='l-box-dateeditor-time'></div>",i+="        <div class='l-button l-button-today'></div>",i+="        <div class='l-button l-button-close'></div>",i+="        <div class='l-clear'></div>",i+="    </div>",i+="</div>",e.dateeditor=$(i),t.absolute?e.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute"):e.textwrapper.append(e.dateeditor),e.header=$(".l-box-dateeditor-header",e.dateeditor),e.body=$(".l-box-dateeditor-body",e.dateeditor),e.toolbar=$(".l-box-dateeditor-toolbar",e.dateeditor),e.body.thead=$("thead",e.body),e.body.tbody=$("tbody",e.body),e.body.monthselector=$(".l-box-dateeditor-monthselector",e.body),e.body.yearselector=$(".l-box-dateeditor-yearselector",e.body),e.body.hourselector=$(".l-box-dateeditor-hourselector",e.body),e.body.minuteselector=$(".l-box-dateeditor-minuteselector",e.body),e.toolbar.time=$(".l-box-dateeditor-time",e.toolbar),e.toolbar.time.hour=$("<a></a>"),e.toolbar.time.minute=$("<a></a>"),e.buttons={btnPrevYear:$(".l-box-dateeditor-header-prevyear",e.header),btnNextYear:$(".l-box-dateeditor-header-nextyear",e.header),btnPrevMonth:$(".l-box-dateeditor-header-prevmonth",e.header),btnNextMonth:$(".l-box-dateeditor-header-nextmonth",e.header),btnYear:$(".l-box-dateeditor-header-year",e.header),btnMonth:$(".l-box-dateeditor-header-month",e.header),btnToday:$(".l-button-today",e.toolbar),btnClose:$(".l-button-close",e.toolbar)};var l=new Date;e.now={year:l.getFullYear(),month:l.getMonth()+1,day:l.getDay(),date:l.getDate(),hour:l.getHours(),minute:l.getMinutes()},e.currentDate={year:l.getFullYear(),month:l.getMonth()+1,day:l.getDay(),date:l.getDate(),hour:l.getHours(),minute:l.getMinutes()},e.selectedDate=null,e.usedDate=null,$("td",e.body.thead).each(function(e,i){$(i).html(t.dayMessage[e])}),$("li",e.body.monthselector).each(function(e,i){$(i).html(t.monthMessage[e])}),e.buttons.btnToday.html(t.todayMessage),e.buttons.btnClose.html(t.closeMessage),t.showTime&&(e.toolbar.time.show(),e.toolbar.time.append(e.toolbar.time.hour).append(":").append(e.toolbar.time.minute),$("li",e.body.hourselector).each(function(e,t){var i=e;e<10&&(i="0"+e.toString()),$(this).html(i)}),$("li",e.body.minuteselector).each(function(e,t){var i=e;e<10&&(i="0"+e.toString()),$(this).html(i)})),e.bulidContent(),t.initValue&&e.inputText.val(t.initValue),""!=e.inputText.val()&&e.onTextChange(),e.dateeditor.hover(null,function(t){e.dateeditor.is(":visible")&&!e.editorToggling&&e.toggleDateEditor(!0)}),e.link.hover(function(){t.disabled||(this.className="l-trigger-hover")},function(){t.disabled||(this.className="l-trigger")}).mousedown(function(){t.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){t.disabled||(this.className="l-trigger-hover")}).click(function(){t.disabled||(e.bulidContent(),e.toggleDateEditor(e.dateeditor.is(":visible")))}),t.disabled&&(e.inputText.attr("readonly","readonly"),e.text.addClass("l-text-disabled")),e.buttons.btnClose.click(function(){e.toggleDateEditor(!0)}),$("td",e.body.tbody).hover(function(){$(this).hasClass("l-box-dateeditor-today")||$(this).addClass("l-box-dateeditor-over")},function(){$(this).removeClass("l-box-dateeditor-over")}).click(function(){$(".l-box-dateeditor-selected",e.body.tbody).removeClass("l-box-dateeditor-selected"),$(this).hasClass("l-box-dateeditor-today")||$(this).addClass("l-box-dateeditor-selected"),e.currentDate.date=parseInt($(this).html()),e.currentDate.day=new Date(e.currentDate.year,e.currentDate.month-1,1).getDay(),$(this).hasClass("l-box-dateeditor-out")&&(0==$("tr",e.body.tbody).index($(this).parent())?0==--e.currentDate.month&&(e.currentDate.month=12,e.currentDate.year--):13==++e.currentDate.month&&(e.currentDate.month=1,e.currentDate.year++)),e.selectedDate={year:e.currentDate.year,month:e.currentDate.month,date:e.currentDate.date},e.showDate(),e.editorToggling=!0,e.dateeditor.slideToggle("fast",function(){e.editorToggling=!1})}),$(".l-box-dateeditor-header-btn",e.header).hover(function(){$(this).addClass("l-box-dateeditor-header-btn-over")},function(){$(this).removeClass("l-box-dateeditor-header-btn-over")}),e.buttons.btnYear.click(function(){e.body.yearselector.is(":visible")||$("li",e.body.yearselector).each(function(t,i){var l=e.currentDate.year+(t-4);l==e.currentDate.year?$(this).addClass("l-selected"):$(this).removeClass("l-selected"),$(this).html(l)}),e.body.yearselector.slideToggle()}),e.body.yearselector.hover(function(){},function(){$(this).slideUp()}),$("li",e.body.yearselector).click(function(){e.currentDate.year=parseInt($(this).html()),e.body.yearselector.slideToggle(),e.bulidContent()}),e.buttons.btnMonth.click(function(){$("li",e.body.monthselector).each(function(t,i){e.currentDate.month==t+1?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),e.body.monthselector.slideToggle()}),e.body.monthselector.hover(function(){},function(){$(this).slideUp("fast")}),$("li",e.body.monthselector).click(function(){var t=$("li",e.body.monthselector).index(this);e.currentDate.month=t+1,e.body.monthselector.slideToggle(),e.bulidContent()}),e.toolbar.time.hour.click(function(){$("li",e.body.hourselector).each(function(t,i){e.currentDate.hour==t?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),e.body.hourselector.slideToggle()}),e.body.hourselector.hover(function(){},function(){$(this).slideUp("fast")}),$("li",e.body.hourselector).click(function(){var t=$("li",e.body.hourselector).index(this);e.currentDate.hour=t,e.body.hourselector.slideToggle(),e.bulidContent(),e.showDate()}),e.toolbar.time.minute.click(function(){$("li",e.body.minuteselector).each(function(t,i){e.currentDate.minute==t?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),e.body.minuteselector.slideToggle("fast",function(){var e=$("li",this).index($("li.l-selected",this));if(e>29){var t=$("li.l-selected",this).offset().top-$(this).offset().top;$(this).animate({scrollTop:t})}})}),e.body.minuteselector.hover(function(){},function(){$(this).slideUp("fast")}),$("li",e.body.minuteselector).click(function(){var t=$("li",e.body.minuteselector).index(this);e.currentDate.minute=t,e.body.minuteselector.slideToggle("fast"),e.bulidContent(),e.showDate()}),e.buttons.btnPrevMonth.click(function(){0==--e.currentDate.month&&(e.currentDate.month=12,e.currentDate.year--),e.bulidContent()}),e.buttons.btnNextMonth.click(function(){13==++e.currentDate.month&&(e.currentDate.month=1,e.currentDate.year++),e.bulidContent()}),e.buttons.btnPrevYear.click(function(){e.currentDate.year--,e.bulidContent()}),e.buttons.btnNextYear.click(function(){e.currentDate.year++,e.bulidContent()}),e.buttons.btnToday.click(function(){e.currentDate={year:e.now.year,month:e.now.month,day:e.now.day,date:e.now.date},e.selectedDate={year:e.now.year,month:e.now.month,day:e.now.day,date:e.now.date},e.showDate(),e.dateeditor.slideToggle("fast")}),e.inputText.change(function(){e.onTextChange()}).blur(function(){e.text.removeClass("l-text-focus")}).focus(function(){e.text.addClass("l-text-focus")}),e.text.hover(function(){e.text.addClass("l-text-over")},function(){e.text.removeClass("l-text-over")}),t.label&&(e.labelwrapper=e.textwrapper.wrap('<div class="l-labeltext"></div>').parent(),e.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+t.label+":&nbsp</div>"),
e.textwrapper.css("float","left"),t.labelWidth?$(".l-text-label",e.labelwrapper).outerWidth(t.labelWidth):t.labelWidth=$(".l-text-label",e.labelwrapper).outerWidth(),$(".l-text-label",e.labelwrapper).width(t.labelWidth),$(".l-text-label",e.labelwrapper).height(e.text.height()),e.labelwrapper.append('<br style="clear:both;" />'),t.labelAlign&&$(".l-text-label",e.labelwrapper).css("text-align",t.labelAlign),e.textwrapper.css({display:"inline"}),e.labelwrapper.width(e.text.outerWidth()+t.labelWidth+2)),e.set(t)}},_render:function(){var e=this;this.options;$(this.element).focus(function(){WdatePicker({dateFmt:"yyyy-MM-dd",minDate:"2010-01-01 00:00:00",maxDate:"2050-12-31 23:59:59"})}),e.text=$(this.element),e.inputText=$(this.element)},destroy:function(){this.textwrapper&&this.textwrapper.remove(),this.dateeditor&&this.dateeditor.remove(),this.options=null,$.ligerui.remove(this)},bulidContent:function(){var e=this,t=this.options,i=new Date(e.currentDate.year,e.currentDate.month-1,1).getDay(),l=e.currentDate.month,r=e.currentDate.year;13==++l&&(l=1,r++);var n=new Date(r,l-1,0).getDate(),a=new Date(e.currentDate.year,e.currentDate.month-1,0).getDate();e.buttons.btnMonth.html(t.monthMessage[e.currentDate.month-1]),e.buttons.btnYear.html(e.currentDate.year),e.toolbar.time.hour.html(e.currentDate.hour),e.toolbar.time.minute.html(e.currentDate.minute),1==e.toolbar.time.hour.html().length&&e.toolbar.time.hour.html("0"+e.toolbar.time.hour.html()),1==e.toolbar.time.minute.html().length&&e.toolbar.time.minute.html("0"+e.toolbar.time.minute.html()),$("td",this.body.tbody).each(function(){this.className=""}),$("tr",this.body.tbody).each(function(t,l){$("td",l).each(function(l,r){var o=7*t+(l-i),s=o+1;e.selectedDate&&e.currentDate.year==e.selectedDate.year&&e.currentDate.month==e.selectedDate.month&&o+1==e.selectedDate.date?(0!=l&&6!=l||$(r).addClass("l-box-dateeditor-holiday"),$(r).addClass("l-box-dateeditor-selected"),$(r).siblings().removeClass("l-box-dateeditor-selected")):e.currentDate.year==e.now.year&&e.currentDate.month==e.now.month&&o+1==e.now.date?(0!=l&&6!=l||$(r).addClass("l-box-dateeditor-holiday"),$(r).addClass("l-box-dateeditor-today")):o<0?(s=a+s,$(r).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):o>n-1?(s-=n,$(r).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):0==l||6==l?$(r).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected"):r.className="",$(r).html(s)})})},updateSelectBoxPosition:function(){var e=this,t=this.options;if(t.absolute){var i=$(document).height();Number(e.text.offset().top+1+e.text.outerHeight()+e.dateeditor.height())>i&&i>Number(e.dateeditor.height()+1)?e.dateeditor.css({left:e.text.offset().left,top:e.text.offset().top-1-e.dateeditor.height()}):e.dateeditor.css({left:e.text.offset().left,top:e.text.offset().top+1+e.text.outerHeight()})}else e.text.offset().top+4>e.dateeditor.height()&&e.text.offset().top+e.dateeditor.height()+textHeight+4-$(window).scrollTop()>$(window).height()?(e.dateeditor.css("marginTop",-1*(e.dateeditor.height()+textHeight+5)),e.showOnTop=!0):e.showOnTop=!1},toggleDateEditor:function(e){var t=this;this.options,t.text.height();t.editorToggling=!0,e?t.dateeditor.hide("fast",function(){t.editorToggling=!1}):(t.updateSelectBoxPosition(),t.dateeditor.slideDown("fast",function(){t.editorToggling=!1}))},showDate:function(){var e=this;this.options;if(this.currentDate){this.currentDate.hour=parseInt(e.toolbar.time.hour.html(),10),this.currentDate.minute=parseInt(e.toolbar.time.minute.html(),10);var t=this.currentDate.year+"/"+this.currentDate.month+"/"+this.currentDate.date+" "+this.currentDate.hour+":"+this.currentDate.minute,i=new Date(t);t=e.getFormatDate(i),this.inputText.val(t),this.onTextChange()}},isDateTime:function(e){var t=(this.options,e.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/));if(null==t)return!1;var i=new Date(t[1],t[3]-1,t[4]);return"NaN"!=i&&(i.getFullYear()==t[1]&&i.getMonth()+1==t[3]&&i.getDate()==t[4])},isLongDateTime:function(e){var t=(this.options,/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/),i=e.match(t);if(null==i)return!1;var l=new Date(i[1],i[3]-1,i[4],i[5],i[6]);return"NaN"!=l&&(l.getFullYear()==i[1]&&l.getMonth()+1==i[3]&&l.getDate()==i[4]&&l.getHours()==i[5]&&l.getMinutes()==i[6])},getFormatDate:function(e){var t=this.options;if("NaN"==e)return null;var i=t.format,l={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(i)&&(i=i.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in l)new RegExp("("+r+")").test(i)&&(i=i.replace(RegExp.$1,1==RegExp.$1.length?l[r]:("00"+l[r]).substr((""+l[r]).length)));return i},clear:function(){this.set("value",""),this.usedDate=null},_setCancelable:function(e){var t=this,i=this.options;!e&&t.unselect&&(t.unselect.remove(),t.unselect=null),(e||t.unselect)&&(t.unselect=$('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide(),t.text.hover(function(){t.unselect.show()},function(){t.unselect.hide()}),!i.disabled&&i.cancelable&&t.text.append(t.unselect),t.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){i.readonly||t.clear()}))},_rever:function(){var e=this;this.options;e.usedDate?e.inputText.val(e.getFormatDate(e.usedDate)):e.inputText.val("")},_getMatch:function(e){for(var t=[-1,-1,-1,-1,-1,-1],i=0,l="^",r=e||this.options.format;;){var n=r.match(/^yyyy|MM|dd|mm|hh|HH|ss|-|\/|:|\s/);if(!n)return null;var a=n[0].charAt(0),o=n[0].length,s="yMdhms".indexOf(a);if(s!=-1)t[s]=i+1,l+="(\\d{1,"+o+"})";else{var d=" "==a?"\\s":a;l+="("+d+")"}if(i++,o==r.length){l+="$";break}r=r.substring(o)}return{reg:new RegExp(l),position:t}},_bulidDate:function(e){var t=this.options,i=this._getMatch();if(!i)return null;var l=e.match(i.reg);if(!l)return null;var r={y:i.position[0]==-1?1900:l[i.position[0]],M:i.position[1]==-1?0:parseInt(l[i.position[1]],10)-1,d:i.position[2]==-1?1:parseInt(l[i.position[2]],10),h:i.position[3]==-1?0:parseInt(l[i.position[3]],10),m:i.position[4]==-1?0:parseInt(l[i.position[4]],10),s:i.position[5]==-1?0:parseInt(l[i.position[5]],10)};if(r.M<0||r.M>11||r.d<0||r.d>31)return null;var n=new Date(r.y,r.M,r.d);if(t.showTime){if(r.m<0||r.m>59||r.h<0||r.h>23||r.s<0||r.s>59)return null;n.setHours(r.h),n.setMinutes(r.m),n.setSeconds(r.s)}return n},updateStyle:function(){this.onTextChange()},onTextChange:function(){var e=this,t=(this.options,e.inputText.val());if(!t)return e.selectedDate=null,!0;var i=e._bulidDate(t);if(!i)return void e._rever();e.usedDate=i,e.selectedDate={year:e.usedDate.getFullYear(),month:e.usedDate.getMonth()+1,day:e.usedDate.getDay(),date:e.usedDate.getDate(),hour:e.usedDate.getHours(),minute:e.usedDate.getMinutes()},e.currentDate={year:e.usedDate.getFullYear(),month:e.usedDate.getMonth()+1,day:e.usedDate.getDay(),date:e.usedDate.getDate(),hour:e.usedDate.getHours(),minute:e.usedDate.getMinutes()};var l=e.getFormatDate(i);e.inputText.val(l),e.trigger("changeDate",[l]),$(e.dateeditor).is(":visible")&&e.bulidContent()},_setHeight:function(e){var t=this;e>4&&(t.text.css({height:e}),t.inputText.css({height:e}))},_setWidth:function(e){var t=this;e>20&&(t.text.css({width:e}),t.inputText.css({width:e-2}))},_setValue:function(value){var g=this;value||g.inputText.val(""),"string"==typeof value&&(/^\/Date/.test(value)?(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)):g.inputText.val(value)),"object"==typeof value&&value instanceof Date&&(g.inputText.val(g.getFormatDate(value)),g.onTextChange())},_getValue:function(){return this.usedDate},setEnabled:function(){var e=this.options;this.inputText.removeAttr("readonly"),this.text.removeClass("l-text-disabled"),e.disabled=!1},setDisabled:function(){var e=this.options;this.inputText.attr("readonly","readonly"),this.text.addClass("l-text-disabled"),e.disabled=!0}})}(jQuery),function(e){e.ligerDefaults.DialogString={titleMessage:ligeruiGlobalString.LigerDialogString_titleMessage,ok:ligeruiGlobalString.LigerDialogString_ok,yes:ligeruiGlobalString.LigerDialogString_yes,no:ligeruiGlobalString.LigerDialogString_no,cancel:ligeruiGlobalString.LigerDialogString_cancel,waittingMessage:ligeruiGlobalString.LigerDialogString_waittingMessage};var t=e.ligerui;e(".l-dialog-btn").live("mouseover",function(){e(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){e(this).removeClass("l-dialog-btn-over")}),e(".l-dialog-tc .l-dialog-close").live("mouseover",function(){e(this).addClass("l-dialog-close-over")}).live("mouseout",function(){e(this).removeClass("l-dialog-close-over")}),e.ligerDialog=function(){return t.run.call(null,"ligerDialog",arguments,{isStatic:!0})},e.ligerui.DialogImagePath="../../lib/ligerUI/skins/Aqua/images/win/",e.ligerDefaults.Dialog={cls:null,id:null,buttons:null,isDrag:!0,width:280,height:null,content:"",target:null,url:null,load:!1,type:"none",left:null,top:null,modal:!0,name:null,isResize:!1,allowClose:!0,opener:null,timeParmName:null,closeWhenEnter:null,isHidden:!0,show:!0,title:e.ligerDefaults.DialogString.titleMessage,showMax:!1,showToggle:!1,showMin:!1,slide:!e.browser.msie,fixedType:null,showType:null,onLoaded:null,onExtend:null,onExtended:null,onCollapse:null,onCollapseed:null,onContentHeightChange:null,onClose:null,onClosed:null,onStopResize:null},e.ligerMethos.Dialog=e.ligerMethos.Dialog||{},t.controls.Dialog=function(e){t.controls.Dialog.base.constructor.call(this,null,e)},t.controls.Dialog.ligerExtend(t.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return e.ligerMethos.Dialog},_render:function(){var i=this,l=this.options,r="";i.set(l,!0);var n=e('<div class="l-dialog"><table class="l-dialog-table" cellpadding="0" cellspacing="0" border="0"><tbody><tr  name="CHC_ADD_Title_TR"><td class="l-dialog-tl"></td><td class="l-dialog-tc"><div class="l-dialog-tc-inner"><div class="l-dialog-icon"></div><div class="l-dialog-title"></div><div class="l-dialog-winbtns"><div class="l-dialog-winbtn l-dialog-close"></div></div></div></td><td class="l-dialog-tr"></td></tr><tr><td class="l-dialog-cl"></td><td class="l-dialog-cc"><div class="l-dialog-body"><div class="l-dialog-image"></div> <div class="l-dialog-content"></div><div class="l-dialog-buttons"><div class="l-dialog-buttons-inner"></div></td><td class="l-dialog-cr"></td></tr><tr><td class="l-dialog-bl"></td><td class="l-dialog-bc"></td><td class="l-dialog-br"></td></tr></tbody></table></div>');if(e("body").append(n),i.dialog=n,i.element=n[0],i.dialog.body=e(".l-dialog-body:first",i.dialog),i.dialog.header=e(".l-dialog-tc-inner:first",i.dialog),i.dialog.winbtns=e(".l-dialog-winbtns:first",i.dialog.header),i.dialog.buttons=e(".l-dialog-buttons:first",i.dialog),i.dialog.content=e(".l-dialog-content:first",i.dialog),i.set(l,!1),i.dialog.content.css("word-wrap","break-word"),0==l.allowClose&&e(".l-dialog-close",i.dialog).remove(),(l.target||l.url||"none"==l.type)&&(l.type=null,i.dialog.addClass("l-dialog-win")),l.cls&&i.dialog.addClass(l.cls),l.id&&i.dialog.attr("id",l.id),i.mask(),l.isDrag&&i._applyDrag(),l.isResize&&i._applyResize(),l.type?i._setImage():(e(".l-dialog-image",i.dialog).remove(),i.dialog.content.addClass("l-dialog-content-noimage")),l.show||(i.unmask(),i.dialog.hide()),l.target)i.dialog.content.prepend(l.target),e(l.target).show();else if(l.url)if(l.timeParmName&&(l.url+=l.url.indexOf("?")==-1?"?":"&",l.url+=l.timeParmName+"="+(new Date).getTime()),l.load)i.dialog.body.load(l.url,function(){i._saveStatus(),i.trigger("loaded")});else{i.jiframe=e("<iframe frameborder='0'></iframe>");var a=l.name?l.name:"ligerwindow"+(new Date).getTime();i.jiframe.attr("name",a),i.jiframe.attr("id",a),i.dialog.content.prepend(i.jiframe),i.dialog.content.addClass("l-dialog-content-nopadding"),setTimeout(function(){i.jiframe.attr("src",l.url),i.frame=window.frames[i.jiframe.attr("name")]},0),r="jquery_ligerui_"+(new Date).getTime(),i.tmpInput=e("<input></input>"),i.tmpInput.attr("id",r),i.dialog.content.prepend(i.tmpInput)}if(l.opener&&(i.dialog.opener=l.opener),l.buttons?e(l.buttons).each(function(t,l){var r=e('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');e(".l-dialog-btn-inner",r).html(l.text),e(".l-dialog-buttons-inner",i.dialog.buttons).prepend(r),l.width&&r.width(l.width),l.onclick&&r.click(function(){l.onclick(l,i,t)})}):i.dialog.buttons.remove(),e(".l-dialog-buttons-inner",i.dialog.buttons).append("<div class='l-clear'></div>"),e(".l-dialog-title",i.dialog).bind("selectstart",function(){return!1}),i.dialog.click(function(){t.win.setFront(i)}),e(".l-dialog-tc .l-dialog-close",i.dialog).click(function(){l.isHidden?i.hide():i.close()}),!l.fixedType){var o=0,s=0,d=l.width||i.dialog.width();1==l.slide&&(l.slide="fast"),null!=l.left?o=l.left:l.left=o=.5*(e(window).width()-d),null!=l.top?s=l.top:l.top=s=.5*(e(window).height()-i.dialog.height())+e(window).scrollTop(),o<0&&(l.left=o=0),s<0&&(l.top=s=0),i.dialog.css({left:o,top:s})}i.show(),e("body").bind("keydown.dialog",function(e){var t=e.which;13==t?i.enter():27==t&&i.esc()}),i._updateBtnsWidth(),i._saveStatus(),i._onReisze(),""!=r&&(e("#"+r).focus(),e("#"+r).remove())},_borderX:12,_borderY:32,doMax:function(i){var l=this,r=this.options,n=e(window).width(),a=e(window).height(),o=0,s=0;t.win.taskbar&&(a-=t.win.taskbar.outerHeight(),t.win.top&&(s+=t.win.taskbar.outerHeight())),l.dialog.css({position:"fixed"}),i?(l.dialog.body.animate({width:n-l._borderX},r.slide),l.dialog.animate({left:o,top:s},r.slide),l.dialog.content.animate({height:a-l._borderY-l.dialog.buttons.outerHeight()},r.slide,function(){l._onReisze()})):(l.set({width:n,height:a,left:o,top:s}),l._onReisze())},hideTitle:function(){var t=this;e("div[class='l-dialog-tc-inner']",t.dialog).hide(),e(".l-dialog-tc",t.dialog).css("height","6px"),e(".l-dialog-tl",t.dialog).css("height","6px"),e(".l-dialog-tr",t.dialog).css("height","6px")},max:function(){var t=this,i=this.options;t.winmax&&(t.winmax.addClass("l-dialog-recover"),t.doMax(i.slide),t.wintoggle&&(t.wintoggle.hasClass("l-dialog-extend")?t.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled"):t.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled")),t.resizable&&t.resizable.set({disabled:!0}),t.draggable&&t.draggable.set({disabled:!0}),t.maximum=!0,e(window).bind("resize.dialogmax",function(){t.doMax(!1)}))},recover:function(){var t=this,i=this.options;t.winmax&&(t.winmax.removeClass("l-dialog-recover"),t.dialog.css({position:""}),i.slide?(t.dialog.body.animate({width:t._width-t._borderX},i.slide),t.dialog.animate({left:t._left,top:t._top},i.slide),t.dialog.content.animate({height:t._height-t._borderY-t.dialog.buttons.outerHeight()},i.slide,function(){t._onReisze()})):(t.set({width:t._width,height:t._height,left:t._left,top:t._top}),t._onReisze()),t.wintoggle&&t.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled"),e(window).unbind("resize.dialogmax")),this.resizable&&this.resizable.set({disabled:!1}),t.draggable&&t.draggable.set({disabled:!1}),t.maximum=!1},min:function(){var e=this,i=this.options,l=t.win.getTask(this);i.slide?(e.dialog.body.animate({width:1},i.slide),l.y=l.offset().top+l.height(),l.x=l.offset().left+l.width()/2,e.dialog.animate({left:l.x,top:l.y},i.slide,function(){e.dialog.hide()})):e.dialog.hide(),e.unmask(),e.minimize=!0,e.actived=!1},active:function(){var i=this,l=this.options;if(i.minimize){var r=i._width,n=i._height,a=i._left,o=i._top;i.maximum&&(r=e(window).width(),n=e(window).height(),a=o=0,t.win.taskbar&&(n-=t.win.taskbar.outerHeight(),t.win.top&&(o+=t.win.taskbar.outerHeight()))),l.slide?(i.dialog.body.animate({width:r-i._borderX},l.slide),i.dialog.animate({left:a,top:o},l.slide)):i.set({width:r,height:n,left:a,top:o})}i.actived=!0,i.minimize=!1,t.win.setFront(i),i.show()},toggle:function(){var e=this;this.options;e.wintoggle&&(e.wintoggle.hasClass("l-dialog-extend")?e.extend():e.collapse())},collapse:function(){var e=this,t=this.options;e.wintoggle&&(t.slide?e.dialog.content.animate({height:1},t.slide):e.dialog.content.height(1),this.resizable&&this.resizable.set({disabled:!0}))},extend:function(){var e=this,t=this.options;if(e.wintoggle){var i=e._height-e._borderY-e.dialog.buttons.outerHeight();t.slide?e.dialog.content.animate({height:i},t.slide):e.dialog.content.height(i),this.resizable&&this.resizable.set({disabled:!1})}},_updateBtnsWidth:function(){var t=this,i=e(">div",t.dialog.winbtns).length;t.dialog.winbtns.width(22*i)},_setLeft:function(e){this.dialog&&null!=e&&this.dialog.css({left:e})},_setTop:function(e){this.dialog&&null!=e&&this.dialog.css({top:e})},_setWidth:function(e){this.dialog&&e>=this._borderX&&this.dialog.body.width(e-this._borderX)},_setHeight:function(e){var t=this;this.options;if(this.dialog&&e>=this._borderY){var i=e-this._borderY-t.dialog.buttons.outerHeight();if(0==t.trigger("ContentHeightChange",[i]))return;t.dialog.content.height(i),t.trigger("ContentHeightChanged",[i])}},_setShowMax:function(t){var i=this;this.options;t?i.winmax||(i.winmax=e('<div class="l-dialog-winbtn l-dialog-max"></div>').appendTo(i.dialog.winbtns).hover(function(){e(this).hasClass("l-dialog-recover")?e(this).addClass("l-dialog-recover-over"):e(this).addClass("l-dialog-max-over")},function(){e(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){e(this).hasClass("l-dialog-recover")?i.recover():i.max()})):i.winmax&&(i.winmax.remove(),i.winmax=null),i._updateBtnsWidth()},_setShowMin:function(i){var l=this;this.options;i?l.winmin||(l.winmin=e('<div class="l-dialog-winbtn l-dialog-min"></div>').appendTo(l.dialog.winbtns).hover(function(){e(this).addClass("l-dialog-min-over")},function(){e(this).removeClass("l-dialog-min-over")}).click(function(){l.min()}),t.win.addTask(l)):l.winmin&&(l.winmin.remove(),l.winmin=null),l._updateBtnsWidth()},_setShowToggle:function(t){var i=this;this.options;t?i.wintoggle||(i.wintoggle=e('<div class="l-dialog-winbtn l-dialog-collapse"></div>').appendTo(i.dialog.winbtns).hover(function(){e(this).hasClass("l-dialog-toggle-disabled")||(e(this).hasClass("l-dialog-extend")?e(this).addClass("l-dialog-extend-over"):e(this).addClass("l-dialog-collapse-over"))},function(){e(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){if(!e(this).hasClass("l-dialog-toggle-disabled"))if(i.wintoggle.hasClass("l-dialog-extend")){if(0==i.trigger("extend"))return;i.wintoggle.removeClass("l-dialog-extend"),i.extend(),i.trigger("extended")}else{if(0==i.trigger("collapse"))return;i.wintoggle.addClass("l-dialog-extend"),i.collapse(),i.trigger("collapseed")}})):i.wintoggle&&(i.wintoggle.remove(),i.wintoggle=null)},enter:function(){var e,t=this,i=this.options;void 0!=i.closeWhenEnter?e=i.closeWhenEnter:"warn"!=i.type&&"error"!=i.type&&"success"!=i.type&&"question"!=i.type||(e=!0),e&&t.close()},esc:function(){},_removeDialog:function(){function t(){var t=e("iframe",i.dialog);if(t.length){var l=t[0];l.src="about:blank",l.contentWindow.document.write(""),e.browser.msie&&CollectGarbage(),t.remove()}i.dialog.remove()}var i=this,l=this.options;l.showType&&l.fixedType?i.dialog.animate({bottom:-1*l.height},function(){t()}):t()},close:function(){var e=this;this.options;0!=e.trigger("Close")&&(e.doClose(),0==e.trigger("Closed"))},doClose:function(){var i=this;this.options.isHidden?i.hide():(t.win.removeTask(this),i.unmask(),i._removeDialog()),e("body").unbind("keydown.dialog"),t.remove(this)},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(e){var t=this,i=this.options;i.url=e,i.load?t.dialog.body.html("").load(i.url,function(){t.trigger("loaded")}):t.jiframe&&t.jiframe.attr("src",i.url)},_setContent:function(e){this.dialog.content.html(e)},_setTitle:function(t){var i=this;this.options;t&&e(".l-dialog-title",i.dialog).html(t)},_hideDialog:function(){var e=this,t=this.options;t.showType&&t.fixedType?e.dialog.animate({bottom:-1*t.height},function(){e.dialog.hide()}):e.dialog.hide()},hidden:function(){var e=this;t.win.removeTask(e),e.dialog.hide(),e.unmask()},show:function(){var t=this,i=this.options;t.mask(),i.fixedType?i.showType?(t.dialog.css({bottom:-1*i.height}).addClass("l-dialog-fixed"),t.dialog.show().animate({bottom:0})):t.dialog.show().css({bottom:0}):t.dialog.show(),e.ligerui.win.setFront.ligerDefer(e.ligerui.win,100,[t])},setUrl:function(e){this._setUrl(e)},_saveStatus:function(){var e=this;e._width=e.dialog.body.width(),e._height=e.dialog.body.height();var t=0,i=0;isNaN(parseInt(e.dialog.css("top")))||(t=parseInt(e.dialog.css("top"))),isNaN(parseInt(e.dialog.css("left")))||(i=parseInt(e.dialog.css("left"))),e._top=t,e._left=i},_applyDrag:function(){var i=this,l=this.options;e.fn.ligerDrag&&(i.draggable=i.dialog.ligerDrag({handler:".l-dialog-title",animate:!1,onStartDrag:function(){t.win.setFront(i);var l=e("<div class='l-dragging-mask' style='display:block'></div>").height(i.dialog.height());i.dialog.append(l),i.dialog.content.addClass("l-dialog-content-dragging")},onDrag:function(e,t){var i=t.pageY||t.screenY;if(i<0)return!1},onStopDrag:function(){if(i.dialog.find("div.l-dragging-mask:first").remove(),i.dialog.content.removeClass("l-dialog-content-dragging"),l.target){var r=t.find(e.ligerui.controls.DateEditor),n=t.find(e.ligerui.controls.ComboBox);e(e.merge(r,n)).each(function(){this.updateSelectBoxPosition&&this.updateSelectBoxPosition()})}i._saveStatus()}}))},_onReisze:function(){var t=this,i=this.options;if(i.target){var l=e(i.target).liger();if(l||(l=e(i.target).find(":first").liger()),!l)return;var r=t.dialog.content.height(),n=t.dialog.content.width();l.trigger("resize",[{width:n,height:r}])}},_applyResize:function(){var t=this;this.options;e.fn.ligerResizable&&(t.resizable=t.dialog.ligerResizable({onStopResize:function(e,i){var l=0,r=0;return isNaN(parseInt(t.dialog.css("top")))||(l=parseInt(t.dialog.css("top"))),isNaN(parseInt(t.dialog.css("left")))||(r=parseInt(t.dialog.css("left"))),e.diffLeft&&t.set({left:r+e.diffLeft}),e.diffTop&&t.set({top:l+e.diffTop}),e.newWidth&&(t.set({width:e.newWidth}),t.dialog.body.css({width:e.newWidth-t._borderX})),e.newHeight&&t.set({height:e.newHeight}),t._onReisze(),t._saveStatus(),t.trigger("stopResize"),!1},animate:!1}))},_setImage:function(){var t=this,i=this.options;i.type&&("success"==i.type||"donne"==i.type||"ok"==i.type?(e(".l-dialog-image",t.dialog).addClass("l-dialog-image-donne").show(),t.dialog.content.css({paddingLeft:64,paddingBottom:30})):"error"==i.type?(e(".l-dialog-image",t.dialog).addClass("l-dialog-image-error").show(),t.dialog.content.css({paddingLeft:64,paddingBottom:30})):"warn"==i.type?(e(".l-dialog-image",t.dialog).addClass("l-dialog-image-warn").show(),t.dialog.content.css({paddingLeft:64,paddingBottom:30})):"question"==i.type&&(e(".l-dialog-image",t.dialog).addClass("l-dialog-image-question").show(),t.dialog.content.css({paddingLeft:64,paddingBottom:40})))}}),t.controls.Dialog.prototype.hide=t.controls.Dialog.prototype.hidden,e.ligerDialog.open=function(t){return e.ligerDialog(t)},e.ligerDialog.close=function(){var e=t.find(t.controls.Dialog.prototype.__getType());for(var i in e){var l=e[i];l.destroy.ligerDefer(l,5)}t.win.unmask()},e.ligerDialog.show=function(i){var l=t.find(t.controls.Dialog.prototype.__getType());if(l.length)for(var r in l)return void l[r].show();return e.ligerDialog(i)},e.ligerDialog.hide=function(){var e=t.find(t.controls.Dialog.prototype.__getType());for(var i in e){var l=e[i];l.hide()}},e.ligerDialog.tip=function(t){return t=e.extend({showType:"slide",width:240,modal:!1,height:100},t||{}),e.extend(t,{fixedType:"se",type:"none",isDrag:!1,isResize:!1,showMax:!1,showToggle:!1,showMin:!1}),e.ligerDialog.open(t)},e.ligerDialog.alert=function(t,i,l,r){t=t||"","function"==typeof i?(r=i,l=null):"function"==typeof l&&(r=l);var n=function(e,t,i){t.close(),r&&r(e,t,i)};return p={content:t,buttons:[{text:e.ligerDefaults.DialogString.ok,onclick:n}]},"string"==typeof i&&""!=i&&(p.title=i),"string"==typeof l&&""!=l&&(p.type=l),e.extend(p,{showMax:!1,showToggle:!1,showMin:!1}),e.ligerDialog(p)},e.ligerDialog.confirm=function(t,i,l){"function"==typeof i&&(l=i,type=null);var r=function(e,t){t.close(),l&&l("ok"==e.type)};return p={type:"question",content:t,buttons:[{text:e.ligerDefaults.DialogString.yes,onclick:r,type:"ok"},{text:e.ligerDefaults.DialogString.no,onclick:r,type:"no"}]},"string"==typeof i&&""!=i&&(p.title=i),e.extend(p,{showMax:!1,showToggle:!1,showMin:!1}),e.ligerDialog(p)},e.ligerDialog.warning=function(t,i,l){"function"==typeof i&&(l=i,type=null);var r=function(e,t){t.close(),l&&l(e.type)};return p={type:"question",content:t,buttons:[{text:e.ligerDefaults.DialogString.yes,onclick:r,type:"yes"},{text:e.ligerDefaults.DialogString.no,onclick:r,type:"no"},{text:e.ligerDefaults.DialogString.cancel,onclick:r,type:"cancel"}]},"string"==typeof i&&""!=i&&(p.title=i),e.extend(p,{showMax:!1,showToggle:!1,showMin:!1}),e.ligerDialog(p)},e.ligerDialog.waitting=function(t){return t=t||e.ligerDefaults.Dialog.waittingMessage,e.ligerDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'<div style="padding:4px">'+t+"</div>",allowClose:!1})},e.ligerDialog.closeWaitting=function(){var e=t.find(t.controls.Dialog);for(var i in e){var l=e[i];l.dialog.hasClass("l-dialog-waittingdialog")&&l.close()}},e.ligerDialog.success=function(t,i,l){return e.ligerDialog.alert(t,i,"success",l)},e.ligerDialog.error=function(t,i,l){return e.ligerDialog.alert(t,i,"error",l)},e.ligerDialog.warn=function(t,i,l){return e.ligerDialog.alert(t,i,"warn",l)},e.ligerDialog.question=function(t,i){return e.ligerDialog.alert(t,i,"question")},e.ligerDialog.prompt=function(t,i,l,r){var n=e('<input type="text" class="l-dialog-inputtext"/>');"function"==typeof l&&(r=l),"function"==typeof i?r=i:"boolean"==typeof i&&(l=i),"boolean"==typeof l&&l&&(n=e('<textarea class="l-dialog-textarea"></textarea>')),"string"!=typeof i&&"int"!=typeof i||n.val(i);var a=function(e,t,i){t.close(),r&&r("yes"==e.type,n.val())};return p={title:t,target:n,width:320,buttons:[{text:e.ligerDefaults.DialogString.ok,onclick:a,type:"yes"},{text:e.ligerDefaults.DialogString.cancel,onclick:a,type:"cancel"}]},e.ligerDialog(p)}}(jQuery),function(e){var t=e.ligerui;e.fn.ligerDrag=function(e){return t.run.call(this,"ligerDrag",arguments,{idAttrName:"ligeruidragid",hasElement:!1,propertyToElemnt:"target"})},e.fn.ligerGetDragManager=function(){return t.run.call(this,"ligerGetDragManager",arguments,{idAttrName:"ligeruidragid",hasElement:!1,propertyToElemnt:"target"})},e.ligerDefaults.Drag={onStartDrag:!1,onDrag:!1,onStopDrag:!1,handler:null,proxy:!0,revert:!1,animate:!0,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:!1,proxyX:null,proxyY:null},t.controls.Drag=function(e){t.controls.Drag.base.constructor.call(this,null,e)},t.controls.Drag.ligerExtend(t.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var e=this,t=this.options;this.set(t),e.cursor="move",e.handler.css("cursor",e.cursor),e.handler.bind("mousedown.drag",function(i){t.disabled||2!=i.button&&e._start.call(e,i)}).bind("mousemove.drag",function(){t.disabled||e.handler.css("cursor",e.cursor)})},_rendered:function(){this.options.target.ligeruidragid=this.id},_start:function(i){var l=this,r=this.options;if(!l.reverting&&!r.disabled){if(l.current={target:l.target,left:l.target.offset().left,top:l.target.offset().top,startX:i.pageX||i.screenX,startY:i.pageY||i.clientY},0==l.trigger("startDrag",[l.current,i]))return!1;if(l.cursor="move",l._createProxy(r.proxy,i),r.proxy&&!l.proxy)return!1;(l.proxy||l.handler).css("cursor",l.cursor),e(document).bind("selectstart.drag",function(){return!1}),e(document).bind("mousemove.drag",function(){l._drag.apply(l,arguments)}),t.draggable.dragging=!0,e(document).bind("mouseup.drag",function(){t.draggable.dragging=!1,l._stop.apply(l,arguments)})}},_drag:function(t){var i=this;this.options;if(i.current){var l=t.pageX||t.screenX,r=t.pageY||t.screenY;i.current.diffX=l-i.current.startX,i.current.diffY=r-i.current.startY,(i.proxy||i.handler).css("cursor",i.cursor),i.receive&&i.receive.each(function(n,a){var o=e(a),s=o.offset();l>s.left&&l<s.left+o.width()&&r>s.top&&r<s.top+o.height()?i.receiveEntered[n]?i.trigger("dragOver",[a,i.proxy||i.target,t]):(i.receiveEntered[n]=!0,i.trigger("dragEnter",[a,i.proxy||i.target,t])):i.receiveEntered[n]&&(i.receiveEntered[n]=!1,i.trigger("dragLeave",[a,i.proxy||i.target,t]))}),i.hasBind("drag")?0!=i.trigger("drag",[i.current,t])?i._applyDrag():i.proxy?i._removeProxy():i._stop():i._applyDrag()}},_stop:function(t){var i=this,l=this.options;e(document).unbind("mousemove.drag"),e(document).unbind("mouseup.drag"),e(document).unbind("selectstart.drag"),i.receive&&i.receive.each(function(e,l){i.receiveEntered[e]&&i.trigger("drop",[l,i.proxy||i.target,t])}),i.proxy&&(l.revert?i.hasBind("revert")?0!=i.trigger("revert",[i.current,t])?i._revert(t):i._removeProxy():i._revert(t):(i._applyDrag(i.target),i._removeProxy())),i.cursor="move",i.trigger("stopDrag",[i.current,t]),i.current=null,i.handler.css("cursor",i.cursor)},_revert:function(e){var t=this;t.reverting=!0,t.proxy.animate({left:t.current.left,top:t.current.top},function(){t.reverting=!1,t._removeProxy(),t.trigger("endRevert",[t.current,e]),t.current=null})},_applyDrag:function(e){var t=this,i=this.options;e=e||t.proxy||t.target;var l={},r=!1,n=e==t.target;t.current.diffX&&(n||null==i.proxyX?l.left=t.current.left+t.current.diffX:l.left=t.current.startX+i.proxyX+t.current.diffX,r=!0),t.current.diffY&&(n||null==i.proxyY?l.top=t.current.top+t.current.diffY:l.top=t.current.startY+i.proxyY+t.current.diffY,r=!0),e==t.target&&t.proxy&&i.animate?(t.reverting=!0,e.animate(l,function(){t.reverting=!1})):e.css(l)},_setReceive:function(t){this.receiveEntered={},t&&("string"==typeof t?this.receive=e(t):this.receive=t)},_setHandler:function(t){var i=this,l=this.options;t?i.handler="string"==typeof t?e(t,l.target):t:i.handler=e(l.target)},_setTarget:function(t){this.target=e(t)},_setCursor:function(e){this.cursor=e,(this.proxy||this.handler).css("cursor",e)},_createProxy:function(t,i){if(t){var l=this,r=this.options;"function"==typeof t?l.proxy=t.call(this.options.target,l,i):"clone"==t?(l.proxy=l.target.clone().css("position","absolute"),l.proxy.appendTo("body")):(l.proxy=e("<div class='l-draggable'></div>"),l.proxy.width(l.target.width()).height(l.target.height()),l.proxy.attr("dragid",l.id).appendTo("body")),l.proxy.css({left:null==r.proxyX?l.current.left:l.current.startX+r.proxyX,top:null==r.proxyY?l.current.top:l.current.startY+r.proxyY}).show()}},_removeProxy:function(){var e=this;e.proxy&&(e.proxy.remove(),e.proxy=null)}})}(jQuery),function(e){e.fn.ligerEasyTab=function(){return e.ligerui.run.call(this,"ligerEasyTab",arguments)},e.fn.ligerGetEasyTabManager=function(){return e.ligerui.run.call(this,"ligerGetEasyTabManager",arguments)},e.ligerDefaults.EasyTab={},e.ligerMethos.EasyTab={},e.ligerui.controls.EasyTab=function(t,i){e.ligerui.controls.EasyTab.base.constructor.call(this,t,i)},e.ligerui.controls.EasyTab.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"EasyTab"},__idPrev:function(){return"EasyTab"},_extendMethods:function(){return e.ligerMethos.EasyTab},_render:function(){var t=this,i=this.options;t.tabs=e(this.element),t.tabs.addClass("l-easytab");var l=0;e("> div[lselected=true]",t.tabs).length>0&&(l=e("> div",t.tabs).index(e("> div[lselected=true]",t.tabs))),t.tabs.ul=e('<ul class="l-easytab-header"></ul>'),e("> div",t.tabs).each(function(i,r){var n=e("<li><span></span></li>");i==l&&e("span",n).addClass("l-selected"),e(r).attr("title")&&e("span",n).html(e(r).attr("title")),t.tabs.ul.append(n),
e(r).hasClass("l-easytab-panelbox")||e(r).addClass("l-easytab-panelbox")}),t.tabs.ul.prependTo(t.tabs),e(".l-easytab-panelbox:eq("+l+")",t.tabs).show().siblings(".l-easytab-panelbox").hide(),e("> ul:first span",t.tabs).click(function(){if(!e(this).hasClass("l-selected")){var i=e("> ul:first span",t.tabs).index(this);e(this).addClass("l-selected").parent().siblings().find("span.l-selected").removeClass("l-selected"),e(".l-easytab-panelbox:eq("+i+")",t.tabs).show().siblings(".l-easytab-panelbox").hide()}}).not("l-selected").hover(function(){e(this).addClass("l-over")},function(){e(this).removeClass("l-over")}),t.set(i)}})}(jQuery),function(e){e.fn.ligerFilter=function(){return e.ligerui.run.call(this,"ligerFilter",arguments)},e.fn.ligerGetFilterManager=function(){return e.ligerui.run.call(this,"ligerGetFilterManager",arguments)},e.ligerDefaults.Filter={fields:[],operators:{},editors:{}},e.ligerDefaults.FilterString={strings:{and:"并且",or:"或者",equal:"相等",notequal:"不相等",startwith:"以..开始",endwith:"以..结束",like:"相似",greater:"大于",greaterorequal:"大于或等于",less:"小于",lessorequal:"小于或等于",in:"包括在...",notin:"不包括...",addgroup:"增加分组",addrule:"增加条件",deletegroup:"删除分组"}},e.ligerDefaults.Filter.operators.string=e.ligerDefaults.Filter.operators.text=["equal","notequal","startwith","endwith","like","greater","greaterorequal","less","lessorequal","in","notin"],e.ligerDefaults.Filter.operators.number=e.ligerDefaults.Filter.operators.int=e.ligerDefaults.Filter.operators.float=e.ligerDefaults.Filter.operators.date=["equal","notequal","greater","greaterorequal","less","lessorequal","in","notin"],e.ligerDefaults.Filter.editors.string={create:function(t,i){var l=e("<input type='text'/>");return t.append(l),l.ligerTextBox(i.editor.options||{}),l},setValue:function(e,t){e.val(t)},getValue:function(e){return e.liger("option","value")},destroy:function(e){e.liger("destroy")}},e.ligerDefaults.Filter.editors.date={create:function(t,i){var l=e("<input type='text'/>");return t.append(l),l.ligerDateEditor(i.editor.options||{}),l},setValue:function(e,t){e.liger("option","value",t)},getValue:function(e,t){return e.liger("option","value")},destroy:function(e){e.liger("destroy")}},e.ligerDefaults.Filter.editors.number={create:function(t,i){var l=e("<input type='text'/>");t.append(l);var r={minValue:i.editor.minValue,maxValue:i.editor.maxValue};return l.ligerSpinner(e.extend(r,i.editor.options||{})),l},setValue:function(e,t){e.val(t)},getValue:function(e,t){var i="int"==t.editor.type;return i?parseInt(e.val(),10):parseFloat(e.val())},destroy:function(e){e.liger("destroy")}},e.ligerDefaults.Filter.editors.combobox={create:function(t,i){var l=e("<input type='text'/>");t.append(l);var r={data:i.data,slide:!1,valueField:i.editor.valueField||i.editor.valueColumnName,textField:i.editor.textField||i.editor.displayColumnName};return e.extend(r,i.editor.options||{}),l.ligerComboBox(r),l},setValue:function(e,t){e.liger("option","value",t)},getValue:function(e){return e.liger("option","value")},destroy:function(e){e.liger("destroy")}},e.ligerui.controls.Filter=function(t,i){e.ligerui.controls.Filter.base.constructor.call(this,t,i)},e.ligerui.controls.Filter.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Filter"},__idPrev:function(){return"Filter"},_init:function(){e.ligerui.controls.Filter.base._init.call(this)},_render:function(){var t=this,i=this.options;t.set(i),e("#"+t.id+" .addgroup").live("click",function(){var i=e(this).parent().parent().parent().parent();t.addGroup(i)}),e("#"+t.id+" .deletegroup").live("click",function(){var i=e(this).parent().parent().parent().parent();t.deleteGroup(i)}),e("#"+t.id+" .addrule").live("click",function(){var i=e(this).parent().parent().parent().parent();t.addRule(i)}),e("#"+t.id+" .deleterole").live("click",function(){var i=e(this).parent().parent();t.deleteRule(i)})},_setFields:function(t){var i=this;this.options;i.group&&i.group.remove(),i.group=e(i._bulidGroupTableHtml()).appendTo(i.element)},editors:{},editorCounter:0,addGroup:function(t){var i=this;this.options;t=e(t||i.group);var l=e(">tbody:first > tr:last",t),r=[];r.push('<tr class="l-filter-rowgroup"><td class="l-filter-cellgroup" colSpan="4">');var n=!t.hasClass("l-filter-group-alt");r.push(i._bulidGroupTableHtml(n,!0)),r.push("</td></tr>");var a=e(r.join(""));return l.before(a),a.find("table:first")},deleteGroup:function(t){var i=this;this.options;e("td.l-filter-value",t).each(function(){var t=e(this).parent();e("select.fieldsel",t).unbind(),i.removeEditor(t)}),e(t).parent().parent().remove()},removeEditor:function(t){var i=this,l=this.options,r=e(t).attr("editortype"),n=e(t).attr("editorid"),a=i.editors[n];a&&l.editors[r].destroy(a),e("td.l-filter-value:first",t).html("")},setData:function(t,i){var l=this,r=this.options;i=i||l.group;var n=e(">tbody:first > tr:last",i);i.find(">tbody:first > tr").not(n).remove(),e("select:first",n).val(t.op),t.rules&&e(t.rules).each(function(){var t=l.addRule(i);t.attr("fieldtype",this.type||"string"),e("select.opsel",t).val(this.op),e("select.fieldsel",t).val(this.field).trigger("change");var n=t.attr("editorid");if(n&&l.editors[n]){var a=l.getField(this.field);a&&a.editor&&r.editors[a.editor.type].setValue(l.editors[n],this.value,a)}else e(":text",t).val(this.value)}),t.groups&&e(t.groups).each(function(){var e=l.addGroup(i);l.setData(this,e)})},addRule:function(t){var i=this,l=this.options;t=t||i.group;var r=e(">tbody:first > tr:last",t),n=e(i._bulidRuleRowHtml());return r.before(n),l.fields.length&&i.appendEditor(n,l.fields[0]),e("select.fieldsel",n).bind("change",function(){var t=e(this).parent().next().find("select:first"),l=e(this).val();if(l){var r=i.getField(l),a=r.type||"string",o=n.attr("fieldtype");a!=o&&(t.html(i._bulidOpSelectOptionsHtml(a)),n.attr("fieldtype",a));var s=null,d=n.attr("editortype");i.enabledEditor(r)&&(s=r.editor.type),d&&i.removeEditor(n),s?i.appendEditor(n,r):(n.removeAttr("editortype").removeAttr("editorid"),e("td.l-filter-value:first",n).html('<input type="text" class="valtxt" />'))}}),n},deleteRule:function(t){e("select.fieldsel",t).unbind(),this.removeEditor(t),e(t).remove()},appendEditor:function(t,i){var l=this,r=this.options;if(l.enabledEditor(i)){var n=e("td.l-filter-value:first",t).html(""),a=r.editors[i.editor.type];l.editors[++l.editorCounter]=a.create(n,i),t.attr("editortype",i.editor.type).attr("editorid",l.editorCounter)}},getData:function(t){var i=this;this.options;t=t||i.group;var l={};return e("> tbody > tr",t).each(function(t,r){var n=e(r).hasClass("l-filter-rowlast"),a=e(r).hasClass("l-filter-rowgroup");if(a){var o=e("> td:first > table:first",r);o.length&&(l.groups||(l.groups=[]),l.groups.push(i.getData(o)))}else if(n)l.op=e(".groupopsel:first",r).val();else{var s=e("select.fieldsel:first",r).val(),d=i.getField(s),c=e(".opsel:first",r).val(),u=i._getRuleValue(r,d),h=e(r).attr("fieldtype")||"string";l.rules||(l.rules=[]),l.rules.push({field:s,op:c,value:u,type:h})}}),l},_getRuleValue:function(t,i){var l=this,r=this.options,n=e(t).attr("editorid"),a=e(t).attr("editortype"),o=l.editors[n];return o?r.editors[a].getValue(o,i):e(".valtxt:first",t).val()},enabledEditor:function(e){var t=this.options;return!(!e.editor||!e.editor.type)&&e.editor.type in t.editors},getField:function(e){for(var t=this.options,i=0,l=t.fields.length;i<l;i++){var r=t.fields[i];if(r.name==e)return r}return null},_bulidGroupTableHtml:function(e,t){var i=this.options,l=[];return l.push('<table cellpadding="0" cellspacing="0" border="0" class="l-filter-group'),e&&l.push(" l-filter-group-alt"),l.push('"><tbody>'),l.push('<tr class="l-filter-rowlast"><td class="l-filter-rowlastcell" align="right" colSpan="4">'),l.push('<select class="groupopsel">'),l.push('<option value="and">'+i.strings.and+"</option>"),l.push('<option value="or">'+i.strings.or+"</option>"),l.push("</select>"),l.push('<input type="button" value="'+i.strings.addgroup+'" class="addgroup">'),l.push('<input type="button" value="'+i.strings.addrule+'" class="addrule">'),t&&l.push('<input type="button" value="'+i.strings.deletegroup+'" class="deletegroup">'),l.push("</td></tr>"),l.push("</tbody></table>"),l.join("")},_bulidRuleRowHtml:function(e){var t=this,i=this.options;e=e||i.fields;var l=[],r=e[0].type||"string";l.push('<tr fieldtype="'+r+'"><td class="l-filter-column">'),l.push('<select class="fieldsel">');for(var n=0,a=e.length;n<a;n++){var o=e[n];l.push('<option value="'+o.name+'"'),0==n&&l.push(" selected "),l.push(">"),l.push(o.display),l.push("</option>")}return l.push("</select>"),l.push("</td>"),l.push('<td class="l-filter-op">'),l.push('<select class="opsel">'),l.push(t._bulidOpSelectOptionsHtml(r)),l.push("</select>"),l.push("</td>"),l.push('<td class="l-filter-value">'),l.push('<input type="text" class="valtxt" />'),l.push("</td>"),l.push("<td>"),l.push('<div class="l-icon-cross deleterole"></div>'),l.push("</td>"),l.push("</tr>"),l.join("")},_bulidOpSelectOptionsHtml:function(e){for(var t=this.options,i=t.operators[e],l=[],r=0,n=i.length;r<n;r++){var a=i[r];l[l.length]='<option value="'+a+'">',l[l.length]=t.strings[a],l[l.length]="</option>"}return l.join("")}})}(jQuery),function(e){function t(t){var i=[];return e(t).each(function(t,l){var r=e(l.element).parents("li:first").prev("li:first").html(),n=l.message;i.push("<div>"+r+" "+n+"</div>")}),i.join("")}e.fn.ligerForm=function(){return e.ligerui.run.call(this,"ligerForm",arguments)},e.ligerui.getConditions=function(t,i){return t?(t=liger.get(e(t)),t&&t.toConditions?t.toConditions():void 0):null},e.ligerDefaults=e.ligerDefaults||{},e.ligerDefaults.Form={inputWidth:180,labelWidth:90,space:40,rightToken:"：",labelAlign:"left",align:"left",fields:[],appendID:!0,prefixID:null,toJSON:e.ligerui.toJSON,labelCss:null,fieldCss:null,spaceCss:null,onAfterSetFields:null,buttons:null,readonly:!1,editors:{},validate:null,unSetValidateAttr:!1},e.ligerDefaults.FormString={invalidMessage:"存在{errorCount}个字段验证不通过，请检查!",detailMessage:"详细",okMessage:"确定"},e.ligerDefaults.Form.editors.textarea={create:function(t,i,l){var r=e('<textarea class="l-textarea" />'),n=(l.prefixID||"")+i.field.name;return e("#"+n).length&&(r=e("#"+n)),r.attr({id:n,name:n}),l.readonly&&r.attr("readonly",!0),t.append(r),r},getValue:function(e,t){return e.val()},setValue:function(e,t,i){e.val(t)},resize:function(e,t,i,l){e.css({width:t-2}).parent().css("width","auto")}},e.ligerDefaults.Form.editors.hidden={create:function(t,i,l){var r=e('<input type = "hidden"  />'),n=(l.prefixID||"")+i.field.name;return e("#"+n).length&&(r=e("#"+n)),r.attr({id:n,name:n}),t.append(r),r},getValue:function(e,t){return e.val()},setValue:function(e,t,i){e.val(t)}},e.ligerDefaults.Form_fields={name:null,textField:null,type:null,editor:null,label:null,newline:!0,op:null,vt:null,attr:null,validate:null},e.ligerDefaults.Form_editor={},e.ligerDefaults.Form.editorBulider=function(t){var i=this.options,l={},r=t.attr("ltype"),n={};if(i.readonly&&(l.readonly=!0),l=e.extend({width:(n.width||i.inputWidth)-2},n.options,n.editor,l),"autocomplete"==r&&(l.autocomplete=!0),t.is("select"))t.ligerComboBox(l);else if(t.is(":password"))t.ligerTextBox(l);else if(t.is(":text"))switch(r){case"select":case"combobox":case"autocomplete":t.ligerComboBox(l);break;case"spinner":t.ligerSpinner(l);break;case"date":t.ligerDateEditor(l);break;case"popup":t.ligerPopupEdit(l);break;case"currency":l.currency=!0;case"float":case"number":l.number=!0,t.ligerTextBox(l);break;case"int":case"digits":l.digits=!0;default:t.ligerTextBox(l)}else t.is(":radio")?t.ligerRadio(l):t.is(":checkbox")?t.ligerCheckBox(l):t.is("textarea")&&t.addClass("l-textarea")},e.ligerui.controls.Form=function(t,i){e.ligerui.controls.Form.base.constructor.call(this,t,i)},e.ligerui.controls.Form.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_init:function(){var t=this,i=this.options;e.ligerui.controls.Form.base._init.call(this);for(var l in liger.editors){var r=liger.editors[l];!r||l in i.editors||(i.editors[l]=liger.getEditor(e.extend({type:l,master:t},r)))}},_render:function(){var t=this,i=this.options,l=e(this.element);if(t.form=l.is("form")?l:l.parents("form:first"),e("input,select,textarea",l).each(function(){i.editorBulider.call(t,e(this))}),t.set(i),i.buttons){var r=e('<ul class="l-form-buttons"></ul>').appendTo(l);e(i.buttons).each(function(){var t=e("<li><div></div></li>").appendTo(r);e("div:first",t).ligerButton(this)})}t.element.id||(t.element.id=t.id),e("#"+t.element.id+" .togglebtn").live("click",function(){e(this).hasClass("togglebtn-down")?e(this).removeClass("togglebtn-down"):e(this).addClass("togglebtn-down");for(var t=e(this).parent().nextAll("ul,div"),i=0;i<t.length;i++){var l=e(t[i]);if(l.hasClass("l-group"))break;e(this).hasClass("togglebtn-down")?l.hide():l.show()}})},getEditor:function(e){var t=this,i=this.options;if(t.editors)for(var l=0,r=i.fields.length;l<r;l++){var n=i.fields[l];if(n.name==e&&t.editors[l])return t.editors[l].control}},getField:function(e){var t=this.options;return t.fields?t.fields[e]:null},toConditions:function(){var t=this,i=this.options,l=[];return e(i.fields).each(function(e,i){var r=i.name,n=(i.textField,t.editors[e]);if(n&&r){var a=n.editor.getValue(n.control);a&&l.push({op:i.operator||"like",field:r,value:a,type:i.type||"string"})}}),l},_preSetFields:function(t){var i=this.options,l=null,r=null;e(i.fields).each(function(e,t){(i.readonly||t.readonly||t.editor&&t.editor.readonly)&&delete t.validate,"hidden"!=t.type&&(t.type=t.type||"text",null==t.newline&&(t.newline=!0),l&&!t.group&&(t.group=l,t.groupicon=r),t.group&&(t.group=t.group.toString().replace(/^\s\s*/,"").replace(/\s\s*$/,""),l=t.group,r=t.groupicon))})},_setReadonly:function(e){var t=this;this.options;if(e&&t.editors)for(var i in t.editors){var l=t.editors[i].control;l&&l._setReadonly&&l._setReadonly(!0)}},_setFields:function(t){var i=this,l=this.options;e.isFunction(l.prefixID)&&(l.prefixID=l.prefixID(i)),i.validate={};var r=e(this.element);if(e(".l-form-container",r).remove(),t&&t.length){i._preSetFields(t),r.hasClass("l-form")||r.addClass("l-form");var n=['<div class="l-form-container">'],a=!1,o=null,s=[];e(t).each(function(t,r){var n=(r.name,!!(r.readonly||r.editor&&r.editor.readonly)),a=(l.prefixID||"")+(r.textField||r.id||r.name);r.validate&&!n&&(i.validate.rules=i.validate.rules||{},i.validate.rules[a]=r.validate,r.validateMessage&&(i.validate.messages=i.validate.messages||{},i.validate.messages[a]=r.validateMessage)),e.inArray(r.group,s)==-1&&s.push(r.group)}),e(s).each(function(r,s){e(t).each(function(r,d){if(d.group==s){var c=e.inArray(d,t),u=d.id||d.name,h=d.newline,g=(l.prefixID||"")+(d.id||d.name);if(u){if("hidden"==d.type)return void(e("#"+g).length||n.push('<div style="display:none" id="'+(i.id+"|"+r)+'"></div>'));var p=d.group&&d.group!=o;(0==c||p)&&(h=!0),h&&(a&&(n.push("</ul>"),a=!1),p&&(n.push('<div class="l-group'),d.groupicon&&n.push(" l-group-hasicon"),n.push('">'),d.groupicon&&n.push('<img src="'+d.groupicon+'" />'),n.push("<span>"+d.group+"</span></div>"),o=d.group),n.push("<ul>"),a=!0),n.push('<li class="l-fieldcontainer'),h&&n.push(" l-fieldcontainer-first"),n.push('"'),n.push(" fieldindex="+c),n.push("><ul>"),n.push(i._buliderLabelContainer(d,c)),n.push(i._buliderControlContainer(d,c)),n.push(i._buliderSpaceContainer(d,c)),n.push("</ul></li>")}}})}),a&&(n.push("</ul>"),a=!1),n.push("</div>"),r.append(n.join("")),e(".l-group .togglebtn",r).remove(),e(".l-group",r).width(.95*r.width()).append("<div class='togglebtn'></div>")}(function(){i.editors=i.editors||{},e(t).each(function(t,r){var n=document.getElementById(i.id+"|"+t),a=l.editors[r.type];if(n){n=e(n);var o=i._createEditor(a,n,{field:r},n.width(),n.height());i.editors[t]&&i.editors[t].control&&i.editors[t].control.destroy&&i.editors[t].control.destroy(),i.editors[t]={control:o,editor:a}}}),i.initValidate(),i.trigger("afterSetFields")})()},getData:function(){var t=this,i=this.options;return t.data=t.data||{},e(i.fields).each(function(e,i){var l=i.name,r=i.textField,n=t.editors[e];if(n){if(l){var a=n.editor.getValue(n.control);t._setValueByName(t.data,l,a)}if(r){var a=n.editor.getText(n.control);t._setValueByName(t.data,r,a)}}}),t.data},setData:function(t){var i=this,l=(this.options,i.get("fields"));i.data=t||{},function(){e(l).each(function(e,t){var l=t.name,r=t.textField,n=i.editors[e];if(n){if(l&&l in i.data){var a=i._getValueByName(i.data,l);n.editor.setValue(n.control,a)}if(r&&r in i.data){var o=i._getValueByName(i.data,r);n.editor.setText(n.control,o)}}})}()},_setValueByName:function(e,t,i){if(!e||!t)return null;if(t.indexOf(".")==-1)e[t]=i;else try{new Function("data,value","data."+t+"=value;")(e,i)}catch(e){}},_getValueByName:function(e,t){if(!e||!t)return null;if(t.indexOf(".")==-1)return e[t];try{return new Function("data","return data."+t+";")(e)}catch(e){return null}},valid:function(){var e=this;this.options;if(e.form&&e.validator)return e.form.valid()},initValidate:function(){var t=this,i=this.options;if(!t.form||!i.validate||!t.form.validate)return void(t.validator=null);var l=1==i.validate?{}:i.validate,r=e.extend({errorPlacement:function(t,i){i.attr("id")||i.attr("id",(new Date).getTime()),i.hasClass("l-textarea")?i.addClass("l-textarea-invalid"):i.hasClass("l-text-field")&&i.parent().addClass("l-text-invalid"),e(i).removeAttr("title").ligerHideTip(),e(i).attr("title",t.html()).ligerTip({distanceX:5,distanceY:-3,auto:!0})},success:function(t){if(t.attr("for")){var i=e("#"+t.attr("for"));i.hasClass("l-textarea")?i.removeClass("l-textarea-invalid"):i.hasClass("l-text-field")&&i.parent().removeClass("l-text-invalid"),e(i).removeAttr("title").ligerHideTip()}}},l,{rules:t.validate.rules,messages:t.validate.messages});t.validator=t.form.validate(r)},showInvalid:function(i){var l=this,r=this.options;if(l.validator){var n=e('<div><div class="invalid">'+r.invalidMessage.replace("{errorCount}",l.validator.errorList.length)+'<a class="viewInvalidDetail" href="javascript:void(0)">'+r.detailMessage+'</a></div><div class="invalidDetail" style="display:none;">'+t(l.validator.errorList)+"</div></div>");n.find("a.viewInvalidDetail:first").bind("click",function(){e(this).parent().next("div.invalidDetail").toggle()}),e.ligerDialog.open({type:"error",width:350,showMax:!1,showToggle:!1,showMin:!1,target:n,buttons:[{text:r.okMessage,onclick:function(e,t){t.close()}}]})}},_createEditor:function(e,t,i,l,r){var n=this.options,a=e.create.call(this,t,i,n);return a&&e.resize&&e.resize.call(this,a,l,r,i),a},_buliderLabelContainer:function(e){var t=this.options,i=e.label||e.display,l=e.labelWidth||e.labelwidth||t.labelWidth,r=e.labelAlign||t.labelAlign;i&&(i+=t.rightToken);var n=[];return n.push("<li"),t.labelCss&&n.push(' class="'+t.labelCss+'"'),n.push(' style="'),l&&n.push("width:"+l+"px;"),r&&n.push("text-align:"+r+";"),n.push('">'),i&&n.push(i),n.push("</li>"),n.join("")},_buliderControlContainer:function(e,t){var i=this,l=this.options,r=e.width||l.inputWidth,n=e.align||e.textAlign||e.textalign||l.align,a=[];return a.push("<li"),a.push(' id="'+(i.id+"|"+t)+'"'),l.fieldCss&&a.push(' class="'+l.fieldCss+'"'),a.push(' style="'),r&&a.push("width:"+r+"px;"),n&&a.push("text-align:"+n+";"),a.push('">'),a.push("</li>"),a.join("")},_buliderSpaceContainer:function(e){var t=this.options,i=e.space||e.spaceWidth||t.space,l=[];return l.push("<li"),t.spaceCss&&l.push(' class="'+t.spaceCss+'"'),l.push(' style="'),i&&l.push("width:"+i+"px;"),l.push('">'),e.validate&&e.validate.required&&l.push("<span class='l-star'>*</span>"),l.push("</li>"),l.join("")},_buliderControl:function(t,i){var l=this,r=this.options,n=(t.width||r.inputWidth,t.name||t.id),a=(t.type||"text").toLowerCase(),o=!!(t.readonly||t.editor&&t.editor.readonly),s=[];return"textarea"==a||"htmleditor"==a?s.push("<textarea "):e.inArray(a,["checkbox","radio","password","file"])!=-1?s.push('<input type="'+a+'" '):e.inArray(a,["select","combobox","autocomplete","popup","radiolist","checkboxlist","listbox"])!=-1?s.push('<input type="hidden" '):s.push('<input type="text" '),s.push('name="'+n+'" '),s.push('fieldindex="'+i+'" '),t.cssClass&&s.push('class="'+t.cssClass+'" '),r.appendID&&s.push(' id="'+n+'" '),s.push(l._getInputAttrHtml(t)),t.validate&&!o&&(s.push(" validate='"+r.toJSON(t.validate)+"' "),l.validate=l.validate||{},l.validate.rules=l.validate.rules||{},l.validate.rules[n]=t.validate,t.validateMessage&&(l.validate.messages=l.validate.messages||{},l.validate.messages[n]=t.validateMessage)),s.push(" />"),s.join("")},_getInputAttrHtml:function(e){var t=[],i=(e.type||"text").toLowerCase();if("textarea"==i&&(e.cols&&t.push('cols="'+e.cols+'" '),e.rows&&t.push('rows="'+e.rows+'" ')),t.push('ltype="'+i+'" '),e.op&&t.push('op="'+e.op+'" '),e.vt&&t.push('vt="'+e.vt+'" '),e.attr)for(var l in e.attr)t.push(l+'="'+e.attr[l]+'" ');return t.join("")}})}(jQuery),function($){function removeArrItem(e,t){for(var i=e.length-1;i>=0;i--)t(e[i])&&e.splice(i,1)}var l=$.ligerui;$.fn.ligerGrid=function(e){return $.ligerui.run.call(this,"ligerGrid",arguments)},$.fn.ligerGetGridManager=function(){return $.ligerui.run.call(this,"ligerGetGridManager",arguments)},$.ligerDefaults.Grid={title:null,width:"auto",height:"auto",columnWidth:100,resizable:!0,url:!1,data:null,usePager:!0,page:1,pageSize:10,pageSizeOptions:[10,20,30,40,50],parms:[],columns:[],minColToggle:1,dataType:"server",dataAction:"server",showTableToggleBtn:!1,switchPageSizeApplyComboBox:!1,allowAdjustColWidth:!0,checkbox:!1,allowHideColumn:!0,enabledEdit:!1,isScroll:!0,dateFormat:"yyyy-MM-dd",inWindow:!0,statusName:"__status",method:"post",async:!0,fixedCellHeight:!0,heightDiff:0,cssClass:null,root:"Rows",record:"Total",pageParmName:"page",pagesizeParmName:"pagesize",sortnameParmName:"sortname",sortorderParmName:"sortorder",allowUnSelectRow:!1,alternatingRow:!0,mouseoverRowCssClass:"l-grid-row-over",enabledSort:!0,rowAttrRender:null,groupColumnName:null,groupColumnDisplay:"分组",groupRender:null,totalRender:null,delayLoad:!1,where:null,selectRowButtonOnly:!1,whenRClickToSelect:!1,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:!0,detailToEdit:!1,onEndEdit:null,minColumnWidth:80,tree:null,isChecked:null,isSelected:null,frozen:!0,frozenDetail:!1,frozenCheckbox:!0,detail:null,detailHeight:260,isShowDetailToggle:null,rownumbers:!1,frozenRownumbers:!0,rownumbersColWidth:26,onColDragging:null,onColStopDrag:null,onColStartDrag:null,colDraggable:!1,rowDraggable:!1,rowDraggingRender:null,autoCheckChildren:!0,onRowDragDrop:null,rowHeight:30,headerRowHeight:30,toolbar:null,toolbarShowInLeft:!0,headerImg:null,unSetValidateAttr:!0,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,onError:null,onSubmit:null,onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,onBeforeCancelEdit:null,onAfterSubmitEdit:null,onRowDragDrop:null,onGroupExtend:null,onGroupCollapse:null,onLoadData:null,treeAsync:!1,treeUrl:null},$.ligerDefaults.GridString={errorMessage:ligeruiGlobalString.LigerGridString_errorMessage,pageStatMessage:ligeruiGlobalString.LigerGridString_pageStatMessage,pageTextMessage:"Page",loadingMessage:ligeruiGlobalString.LigerGridString_loadingMessage,findTextMessage:ligeruiGlobalString.LigerGridString_findTextMessage,noRecordMessage:ligeruiGlobalString.LigerGridString_noRecordMessage,isContinueByDataChanged:ligeruiGlobalString.LigerGridString_isContinueByDataChanged,cancelMessage:ligeruiGlobalString.LigerGridString_cancelMessage,saveMessage:ligeruiGlobalString.LigerGridString_saveMessage,applyMessage:ligeruiGlobalString.LigerGridString_applyMessage,draggingMessage:ligeruiGlobalString.LigerGridString_draggingMessage},$.ligerDefaults.Grid_columns={id:null,name:null,totalSummary:null,display:null,headerRender:null,isAllowHide:!0,isSort:!1,type:null,columns:null,width:120,minWidth:80,format:null,align:"left",hide:!1,editor:null,render:null,textField:null},$.ligerDefaults.Grid_editor={type:null,ext:null,onChange:null,onChanged:null},$.ligerMethos.Grid=$.ligerMethos.Grid||{},$.ligerDefaults.Grid.sorters=$.ligerDefaults.Grid.sorters||{},$.ligerDefaults.Grid.formatters=$.ligerDefaults.Grid.formatters||{},$.ligerDefaults.Grid.editors=$.ligerDefaults.Grid.editors||{},$.ligerDefaults.Grid.sorters.date=function(e,t){return e<t?-1:e>t?1:0},$.ligerDefaults.Grid.sorters.int=function(e,t){return parseInt(e)<parseInt(t)?-1:parseInt(e)>parseInt(t)?1:0},$.ligerDefaults.Grid.sorters.float=function(e,t){return parseFloat(e)<parseFloat(t)?-1:parseFloat(e)>parseFloat(t)?1:0},$.ligerDefaults.Grid.sorters.string=function(e,t){return!!e&&e.localeCompare(t)},$.ligerDefaults.Grid.formatters.date=function(value,column){function getFormatDate(e,t){this.options;if(isNaN(e))return null;var i=t,l={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(i)&&(i=i.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in l)new RegExp("("+r+")").test(i)&&(i=i.replace(RegExp.$1,1==RegExp.$1.length?l[r]:("00"+l[r]).substr((""+l[r]).length)));return i}if(!value)return"";if("string"==typeof value&&/^\/Date/.test(value)&&(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)),value instanceof Date){var format=column.format||this.options.dateFormat||"yyyy-MM-dd";return getFormatDate(value,format)}return value.toString()},$.ligerui.controls.Grid=function(e,t){$.ligerui.controls.Grid.base.constructor.call(this,e,t)},$.ligerui.controls.Grid.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return $.ligerMethos.Grid},_init:function(){$.ligerui.controls.Grid.base._init.call(this);var e=this,t=this.options;t.dataType=t.url?"server":"local","local"==t.dataType&&(t.data=t.data||[],t.dataAction="local"),0==t.isScroll&&(t.height="auto"),t.frozen||(t.frozenCheckbox=!1,t.frozenDetail=!1,t.frozenRownumbers=!1),t.detailToEdit&&(t.enabledEdit=!0,t.clickToEdit=!1,t.detail={height:"auto",onShowDetail:function(i,l,r){function n(){$(l).parent().parent().remove(),e.collapseDetail(i)}$(l).addClass("l-grid-detailpanel-edit"),e.beginEdit(i,function(e,i){var r=$("<div class='l-editbox'></div>");return r.width(120).height(t.rowHeight+1),r.appendTo(l),r}),$("<div class='l-clear'></div>").appendTo(l),$("<div class='l-button'>"+t.saveMessage+"</div>").appendTo(l).click(function(){e.endEdit(i),n()}),$("<div class='l-button'>"+t.applyMessage+"</div>").appendTo(l).click(function(){e.submitEdit(i)}),$("<div class='l-button'>"+t.cancelMessage+"</div>").appendTo(l).click(function(){e.cancelEdit(i),n()})}}),t.tree&&(t.tree.childrenName=t.tree.childrenName||"children",t.tree.isParent=t.tree.isParent||function(e){var i=t.tree.childrenName in e;return i&&(i=null!=e[t.tree.childrenName]),i},t.tree.isExtend=t.tree.isExtend||function(e){return!("isextend"in e&&0==e.isextend)});for(var i in liger.editors){var l=liger.editors[i];!l||i in t.editors||(t.editors[i]=liger.getEditor($.extend({type:i,master:e},l)))}},_render:function(){var e=this,t=this.options;e.grid=$(e.element),e.grid.addClass("l-panel");var i=[];i.push("        <div class='l-panel-header'><span class='l-panel-header-text'></span></div>"),i.push("                    <div class='l-grid-loading'></div>"),i.push("        <div class='l-panel-topbar' style='display:none'><div class='l-panel-topbarinner'></div></div><div class='l-clear'></div>"),i.push("        <div class='l-panel-bwarp'>"),i.push("            <div class='l-panel-body'>"),i.push("                <div class='l-grid'>"),i.push("                    <div class='l-grid-dragging-line'></div>"),i.push("                    <div class='l-grid-popup'><table cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),i.push("                  <div class='l-grid1'>"),i.push("                      <div class='l-grid-header l-grid-header1'>"),i.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),i.push("                      </div>"),i.push("                      <div class='l-grid-body l-grid-body1'>"),i.push("                      </div>"),i.push("                  </div>"),i.push("                  <div class='l-grid2'>"),i.push("                      <div class='l-grid-header l-grid-header2'>"),i.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),i.push("                      </div>"),i.push("                      <div class='l-grid-body l-grid-body2 l-scroll'>"),i.push("                      </div>"),i.push("                  </div>"),i.push("                 </div>"),i.push("              </div>"),i.push("         </div>"),i.push("         <div class='l-panel-bar'>"),i.push("            <div class='l-panel-bbar-inner'>"),i.push("                <div class='l-bar-group  l-bar-message'><span class='l-bar-text'></span></div>"),i.push("          <div class='l-bar-group l-bar-control'>"),i.push("            <div class='l-bar-group l-bar-selectpagesize'></div>"),i.push("                <div class='l-bar-separator'></div>"),i.push("                <div class='l-bar-group'>"),i.push("                    <div class='l-bar-button l-bar-btnfirst'><span></span></div>"),i.push("                    <div class='l-bar-button l-bar-btnprev'><span></span></div>"),i.push("                </div>"),i.push("                <div class='l-bar-separator'></div>"),i.push("                <div class='l-bar-group'><span class='pcontrol'> <input type='text' size='4' value='1' style='width:20px' maxlength='3' /> / <span></span></span></div>"),i.push("                <div class='l-bar-separator'></div>"),i.push("                <div class='l-bar-group'>"),i.push("                     <div class='l-bar-button l-bar-btnnext'><span></span></div>"),i.push("                    <div class='l-bar-button l-bar-btnlast'><span></span></div>"),i.push("                </div>"),i.push("                <div class='l-bar-separator'></div>"),i.push("                <div class='l-bar-group'>"),i.push("                     <div class='l-bar-button l-bar-btnload'><span></span></div>"),i.push("                </div>"),i.push("                <div class='l-bar-separator'></div>"),i.push("                <div class='l-clear'></div>"),i.push("              </div>"),i.push("            </div>"),i.push("         </div>"),e.grid.html(i.join("")),e.header=$(".l-panel-header:first",e.grid),e.body=$(".l-panel-body:first",e.grid),e.toolbar=$(".l-panel-bar:first",e.grid),e.popup=$(".l-grid-popup:first",e.grid),e.gridloading=$(".l-grid-loading:first",e.grid),e.draggingline=$(".l-grid-dragging-line",e.grid),e.topbar=$(".l-panel-topbarinner:first",e.grid),e.gridview=$(".l-grid:first",e.grid),e.gridview.attr("id",e.id+"grid"),e.gridview1=$(".l-grid1:first",e.gridview),e.gridview2=$(".l-grid2:first",e.gridview),e.gridheader=$(".l-grid-header:first",e.gridview2),e.gridbody=$(".l-grid-body:first",e.gridview2),e.f={},e.f.gridheader=$(".l-grid-header:first",e.gridview1),e.f.gridbody=$(".l-grid-body:first",e.gridview1),e.currentData=null,e.changedCells={},e.editors={},e.editor={editing:!1},e.cacheData={},"auto"==t.height&&e.bind("SysGridHeightChanged",function(){e.enabledFrozen()&&e.gridview.height(Math.max(e.gridview1.height(),e.gridview2.height()))});var l=$.extend({},t);this._bulid(),this._setColumns(t.columns),delete l.columns,delete l.data,delete l.url,e.set(l),t.delayLoad||(t.url?e.set({url:t.url}):t.data&&e.set({data:t.data}))},_setFrozen:function(e){e?this.grid.addClass("l-frozen"):this.grid.removeClass("l-frozen");
},_setCssClass:function(e){this.grid.addClass(e)},_setLoadingMessage:function(e){this.gridloading.html(e)},_setToolbar:function(e){var t=this,i=this.options;if(e&&$.fn.ligerToolBar){if(t.topbar.parent().show(),t.toolbarManager=t.topbar.ligerToolBar(e),e.title){var l=$("<div class='l-panel-topbartitle'><span>"+e.title+"</span></div>");e.icon&&(l.append("<img class='l-panel-topbaricon' src='"+e.icon+"'></img>"),l.addClass("l-panel-topbartitle-hasicon")),t.topbar.parent().append(l)}i.toolbarShowInLeft&&t.topbar.addClass("l-panel-topbarinner-left")}else t.topbar.parent().remove()},isHorizontalScrollShowed:function(){var e=this,t=e.gridbody.find(".l-grid-body-inner:first");return!!t.length&&e.gridbody.width()<t.width()},_setHeight:function(e){var t=this,i=this.options;if(t.unbind("SysGridHeightChanged"),"auto"==e)return void t.bind("SysGridHeightChanged",function(){t.enabledFrozen()&&t.gridview.height(Math.max(t.gridview1.height(),t.gridview2.height()))});if(e=t._calculateGridBodyHeight(e),e>0){t.gridbody.height(e),t.f.gridbody.height(e);var l=i.headerRowHeight*(t._columnMaxLevel-1)+i.headerRowHeight-1;t.gridview.height(e+l)}t._updateHorizontalScrollStatus.ligerDefer(t,10)},_calculateGridBodyHeight:function(e){var t=this,i=this.options;"string"==typeof e&&e.indexOf("%")>0&&(e=i.inWindow?$(window).height()*parseFloat(e)*.01:t.grid.parent().height()*parseFloat(e)*.01),i.title&&(e-=24),i.usePager&&(e-=32),i.totalRender&&(e-=25),i.toolbar&&(e-=t.topbar.outerHeight());var l=Number(i.headerRowHeight)*(t._columnMaxLevel-1)+Number(i.headerRowHeight)-1;return e-=l},_updateHorizontalScrollStatus:function(){var e=this;this.options;e.isHorizontalScrollShowed()?e.gridview.addClass("l-grid-hashorizontal"):e.gridview.removeClass("l-grid-hashorizontal")},_updateFrozenWidth:function(){var e=this;this.options;if(e.enabledFrozen()){e.gridview1.width(e.f.gridtablewidth);var t=e.gridview.width()-e.f.gridtablewidth;e.gridview2.css({left:e.f.gridtablewidth}),t>0&&e.gridview2.css({width:t})}},_setWidth:function(e){var t=this;this.options;t.enabledFrozen()&&t._onResize()},_setUrl:function(e){this.options.url=e,e?(this.options.dataType="server",this.loadData(!0)):this.options.dataType="local"},removeParm:function(e){var t=this,i=t.get("parms");i||(i={}),i instanceof Array?removeArrItem(i,function(t){return t.name==e}):delete i[e],t.set("parms",i)},setParm:function(e,t){var i=this,l=i.get("parms");l||(l={}),l instanceof Array?(removeArrItem(l,function(t){return t.name==e}),l.push({name:e,value:t})):l[e]=t,i.set("parms",l)},_setData:function(e){this.loadData(this.options.data)},loadData:function(e){var t=this,i=this.options;t.loading=!0,t.trigger("loadData");var l=null,r=!0;"function"==typeof e?(l=e,t.lastData?t.data=t.lastData:(t.data=t.currentData,t.data||(t.data={}),t.data[i.root]||(t.data[i.root]=[]),t.lastData=t.data),r=!1):"boolean"==typeof e?r=e:"object"==typeof e&&e&&(r=!1,i.dataType="local",i.data=e),i.newPage||(i.newPage=1),"server"==i.dataAction&&(i.sortOrder||(i.sortOrder="asc"));var n=[];if(i.parms){var a=$.isFunction(i.parms)?i.parms():i.parms;if(a.length)$(a).each(function(){n.push({name:this.name,value:this.value})});else if("object"==typeof a)for(var o in a)n.push({name:o,value:a[o]})}"server"==i.dataAction&&(i.usePager&&(n.push({name:i.pageParmName,value:i.newPage}),n.push({name:i.pagesizeParmName,value:i.pageSize})),i.sortName&&(n.push({name:i.sortnameParmName,value:i.sortName}),n.push({name:i.sortorderParmName,value:i.sortOrder}))),$(".l-bar-btnload span",t.toolbar).addClass("l-disabled"),"local"==i.dataType?(t.filteredData=i.data||t.currentData,l&&(t.filteredData[i.root]=t._searchData(t.filteredData[i.root],l)),i.usePager?t.currentData=t._getCurrentPageData(t.filteredData):t.currentData=t.filteredData,t._convertTreeData(),t._showData()):"local"!=i.dataAction||r?t.loadServerData(n,l):t.data&&t.data[i.root]&&(t.filteredData=t.data,l&&(t.filteredData[i.root]=t._searchData(t.filteredData[i.root],l)),t.currentData=t._getCurrentPageData(t.filteredData),t._convertTreeData(),t._showData()),t.loading=!1},_convertTreeData:function(){var e=this,t=this.options;t.tree&&t.tree.idField&&t.tree.parentIDField&&(e.currentData[t.root]=e.arrayToTree(e.currentData[t.root],t.tree.idField,t.tree.parentIDField),e.currentData[t.record]=e.currentData[t.root].length)},loadServerData:function(e,t){var i=this,l=this.options,r={type:l.method,url:l.url,data:e,async:l.async,dataType:"json",beforeSend:function(){i.hasBind("loading")?i.trigger("loading"):i.toggleLoading(!0)},success:function(e){return i.trigger("success",[e,i]),e&&e[l.root]&&e[l.root].length?(i.data=e,null!=i.data[l.record]&&i.cacheData.records&&(i.cacheData.records=i.data[l.record]),"server"==l.dataAction?(i.currentData=i.data,null==i.currentData[l.record]&&i.cacheData.records&&(i.currentData[l.record]=i.cacheData.records)):(i.filteredData=i.data,t&&(i.filteredData[l.root]=i._searchData(i.filteredData[l.root],t)),l.usePager?i.currentData=i._getCurrentPageData(i.filteredData):i.currentData=i.filteredData),i._convertTreeData(),void i._showData.ligerDefer(i,10,[i.currentData])):(i.currentData=i.data={},i.currentData[l.root]=i.data[l.root]=[],e&&e[l.record]?i.currentData[l.record]=i.data[l.record]=e[l.record]:i.currentData[l.record]=i.data[l.record]=0,i._convertTreeData(),void i._showData())},complete:function(){i.trigger("complete",[i]),i.hasBind("loaded")?i.trigger("loaded",[i]):i.toggleLoading.ligerDefer(i,10,[!1])},error:function(e,t,r){i.currentData=i.data={},i.currentData[l.root]=i.data[l.root]=[],i.currentData[l.record]=i.data[l.record]=0,i.toggleLoading.ligerDefer(i,10,[!1]),$(".l-bar-btnload span",i.toolbar).removeClass("l-disabled"),i.trigger("error",[e,t,r])}};l.contentType&&(r.contentType=l.contentType),$.ajax(r)},toggleLoading:function(e){this.gridloading[e?"show":"hide"]()},_createEditor:function(e,t,i,l,r){var n=e.create.call(this,t,i);return e.setValue&&e.setValue.call(this,n,i.value,i),e.setText&&i.column.textField&&e.setText.call(this,n,i.text,i),e.resize&&e.resize.call(this,n,l,r,i),n},beginEdit:function(e,t){var i=this,l=this.options;if(l.enabledEdit&&!l.clickToEdit){var r=i.getRow(e);if(!r._editing&&0!=i.trigger("beginEdit",{record:r,rowindex:r.__index})){i.editors[r.__id]={},r._editing=!0,i.reRender({rowdata:r}),t=t||function(e,t){var l=i.getCellObj(e,t),r=$(l).html("");return i.setCellEditing(e,t,!0),r};for(var n=0,a=i.columns.length;n<a;n++){var o=i.columns[n];if(o.name&&o.editor&&o.editor.type&&l.editors[o.editor.type]){var s=l.editors[o.editor.type],d={record:r,value:i._getValueByName(r,o.name),column:o,rowindex:r.__index,grid:i},c=t(r,o),u=c.width(),h=c.height(),g=i._createEditor(s,c,d,u,h);i.editors[r.__id][o.__id]={editor:s,input:g,editParm:d,container:c}}}i.trigger("afterBeginEdit",{record:r,rowindex:r.__index})}}},cancelEdit:function(e){var t=this;if(void 0==e)for(var i in t.editors)t.cancelEdit(i);else{var l=t.getRow(e);if(!t.editors[l.__id])return;if(0==t.trigger("beforeCancelEdit",{record:l,rowindex:l.__index}))return;for(var r in t.editors[l.__id]){var n=t.editors[l.__id][r];n.editor.destroy&&n.editor.destroy(n.input,n.editParm)}delete t.editors[l.__id],delete l._editing,t.reRender({rowdata:l})}},addEditRow:function(e,t){this.submitEdit(),e=this.add(e),this.beginEdit(e,t)},submitEdit:function(e){var t=this;this.options;if(void 0==e)for(var i in t.editors)t.submitEdit(i);else{var l=t.getRow(e),r={};if(!t.editors[l.__id])return;for(var n in t.editors[l.__id]){var a=t.editors[l.__id][n],o=a.editParm.column;o.name&&(r[o.name]=a.editor.getValue(a.input,a.editParm)),o.textField&&a.editor.getText&&(r[o.textField]=a.editor.getText(a.input,a.editParm))}if(0==t.trigger("beforeSubmitEdit",{record:l,rowindex:l.__index,newdata:r}))return!1;t.updateRow(l,r),t.trigger("afterSubmitEdit",{record:l,rowindex:l.__index,newdata:r})}},endEdit:function(e){var t=this;this.options;if(t.editor.editing){var i=t.editor;t.trigger("sysEndEdit",[t.editor.editParm]),t.trigger("endEdit",[t.editor.editParm]),i.editor.destroy&&i.editor.destroy(i.input,i.editParm),t.editor.container.remove(),t.reRender({rowdata:t.editor.editParm.record,column:t.editor.editParm.column}),t.trigger("afterEdit",[t.editor.editParm]),t.editor={editing:!1}}else if(void 0!=e){var l=t.getRow(e);if(!t.editors[l.__id])return;if(0==t.submitEdit(e))return!1;for(var r in t.editors[l.__id]){var i=t.editors[l.__id][r];i.editor.destroy&&i.editor.destroy(i.input,i.editParm)}delete t.editors[l.__id],delete l._editing,t.trigger("afterEdit",{record:l,rowindex:l.__index})}else for(var n in t.editors)t.endEdit(n);t._fixHeight.ligerDefer(t,10)},setWidth:function(e){return this._setWidth(e)},setHeight:function(e){return this._setHeight(e)},enabledCheckbox:function(){return!!this.options.checkbox},enabledFrozen:function(){var e=this,t=this.options;if(!t.frozen)return!1;var i=e.columns||[];if(e.enabledDetail()&&t.frozenDetail||e.enabledCheckbox()&&t.frozenCheckbox||t.frozenRownumbers&&t.rownumbers)return!0;for(var l=0,r=i.length;l<r;l++)if(i[l].frozen)return!0;return this._setFrozen(!1),!1},enabledDetailEdit:function(){return!!this.enabledDetail()&&!!this.options.detailToEdit},enabledDetail:function(){return!(!this.options.detail||!this.options.detail.onShowDetail)},enabledGroup:function(){return!!this.options.groupColumnName},deleteSelectedRow:function(){if(this.selected){for(var e in this.selected){var t=this.selected[e];t.__id in this.records&&this._deleteData.ligerDefer(this,10,[t])}this.reRender.ligerDefer(this,20)}},removeRange:function(e){var t=this;this.options;$.each(e,function(){t._removeData(this)}),t.reRender()},remove:function(e){var t=this;this.options,t.getRow(e);t._removeData(e),t.reRender()},deleteRange:function(e){var t=this;this.options;$.each(e,function(){t._deleteData(this)}),t.reRender()},deleteRow:function(e){var t=this,i=(this.options,t.getRow(e));i&&(t._deleteData(i),t.reRender(),t.isDataChanged=!0)},_deleteData:function(e){var t=this,i=this.options,l=t.getRow(e);if(l[i.statusName]="delete",i.tree){var r=t.getChildren(l,!0);if(r)for(var n=0,a=r.length;n<a;n++)r[n][i.statusName]="delete"}t.deletedRows=t.deletedRows||[],t.deletedRows.push(l),t._removeSelected(l)},updateCell:function(e,t,i){var l,r,n,a=this,o=this.options;if("string"!=typeof e){if("number"==typeof e)l=a.columns[e],n=a.getRow(i),r=a.getCellObj(n,l);else if("object"==typeof e&&e.__id)l=e,n=a.getRow(i),r=a.getCellObj(n,l);else{r=e;var s=r.id.split("|"),d=s[s.length-1];l=a._columns[d];var c=$(r).parent();n=n||a.getRow(c[0])}null!=t&&l.name&&(a._setValueByName(n,l.name,t),"add"!=n[o.statusName]&&(n[o.statusName]="update"),a.isDataChanged=!0),a.reRender({rowdata:n,column:l})}else for(var u=0,h=a.columns.length;u<h;u++)a.columns[u].name==e&&a.updateCell(u,t,i)},addRows:function(e,t,i,l){var r=this;this.options;$(e).each(function(){r.addRow(this,t,i,l)})},_createRowid:function(){return"r"+(1e3+this.recordNumber)},_isRowId:function(e){return e in this.records},_addNewRecord:function(e,t,i){var l=this,r=this.options;if(l.recordNumber++,e.__id=l._createRowid(),e.__previd=t,t&&t!=-1){var n=l.records[t];if(n.__nextid&&n.__nextid!=-1){var a=l.records[n.__nextid];a&&(a.__previd=e.__id)}n.__nextid=e.__id,e.__index=n.__index+1}else e.__index=0;if(r.tree){if(i&&i!=-1){var o=l.records[i];e.__pid=i,e.__level=o.__level+1}else e.__pid=-1,e.__level=1;e.__hasChildren=!!e[r.tree.childrenName]}return e[r.statusName]=e[r.statusName]||"nochanged",l.rows[e.__index]=e,l.records[e.__id]=e,e},_getRows:function(e){function t(e){if(e&&e.length)for(var r=0,n=e.length;r<n;r++){var a=e[r];l.push(a),a[i.tree.childrenName]&&t(a[i.tree.childrenName])}}var i=this.options,l=[];return t(e),l},_updateGridData:function(){function e(r,n){if(r&&r.length)for(var a=0,o=r.length;a<o;a++){var s=r[a];t.formatRecord(s),"delete"!=s[i.statusName]&&(t._addNewRecord(s,l,n),l=s.__id,s.__hasChildren&&e(s[i.tree.childrenName],s.__id))}}var t=this,i=this.options;t.recordNumber=0,t.rows=[],t.records={};var l=-1;return e(t.currentData[i.root],-1),t.rows},_moveData:function(e,t,i){var l,r,n=this,a=(this.options,n.getRow(e)),o=n.getRow(t),s=n._getParentChildren(a);l=$.inArray(a,s),s.splice(l,1),s=n._getParentChildren(o),r=$.inArray(o,s),s.splice(r+(i?1:0),0,a)},move:function(e,t,i){this._moveData(e,t,i),this.reRender()},moveRange:function(e,t,i){for(var l in e)this._moveData(e[l],t,i);this.reRender()},up:function(e){var t=this,i=(this.options,t.getRow(e)),l=t._getParentChildren(i),r=$.inArray(i,l);r!=-1&&0!=r&&(t.move(i,l[r-1],!1),t.select(i))},down:function(e){var t=this,i=(this.options,t.getRow(e)),l=t._getParentChildren(i),r=$.inArray(i,l);r!=-1&&r!=l.length-1&&(t.move(i,l[r+1],!0),t.select(i))},addRow:function(e,t,i,l){var r=this,n=this.options;if(e=e||{},r._addData(e,l,t,i),r.reRender(),e[n.statusName]="add",n.tree){var a=r.getChildren(e,!0);if(a)for(var o=0,s=a.length;o<s;o++)a[o][n.statusName]="add"}return r.isDataChanged=!0,n.total=n.total?n.total+1:1,n.pageCount=Math.ceil(n.total/n.pageSize),r._buildPager(),r.trigger("SysGridHeightChanged"),r.trigger("afterAddRow",[e]),e},updateRow:function(e,t){var i=this,l=this.options,r=i.getRow(e);return i.isDataChanged=!0,$.extend(r,t||{}),"add"!=r[l.statusName]&&(r[l.statusName]="update"),i.reRender.ligerDefer(i,10,[{rowdata:r}]),r},setCellEditing:function(e,t,i){var l=this,r=(this.options,l.getCellObj(e,t)),n=i?"addClass":"removeClass";if($(r)[n]("l-grid-row-cell-editing"),0!=e.__id){var a=$(l.getRowObj(e.__id)).prev();if(!a.length)return;var o=l.getRow(a[0]),s=l.getCellObj(o,t);if(!s)return;$(s)[n]("l-grid-row-cell-editing-topcell")}if(t.__previd!=-1&&null!=t.__previd){var s=$(l.getCellObj(e,t)).prev();$(s)[n]("l-grid-row-cell-editing-leftcell")}},reRender:function(e){var t=this,i=this.options;e=e||{};var l=e.rowdata,r=e.column;if(!(r&&(r.isdetail||r.ischeckbox)||l&&"delete"==l[i.statusName]))if(l&&r){var n=t.getCellObj(l,r);$(n).html(t._getCellHtml(l,r)),r.issystem||t.setCellEditing(l,r,!1)}else if(l)$(t.columns).each(function(){t.reRender({rowdata:l,column:this})});else if(r){for(var a in t.records)t.reRender({rowdata:t.records[a],column:r});for(var o=0;o<t.totalNumber;o++){var s=document.getElementById(t.id+"|total"+o+"|"+r.__id);$("div:first",s).html(t._getTotalCellContent(r,t.groups&&t.groups[o]?t.groups[o]:t.currentData[i.root]))}}else t._showData()},getData:function(e,t){var i=this,l=this.options,r=[];void 0==t&&(t=!0);for(var n in i.records){var a=$.extend(!0,{},i.records[n]);a[l.statusName]!=e&&void 0!=e||r.push(i.formatRecord(a,t))}return r},formatRecord:function(e,t){return delete e.__id,delete e.__previd,delete e.__nextid,delete e.__index,this.options.tree&&(delete e.__pid,delete e.__level,delete e.__hasChildren),t&&delete e[this.options.statusName],e},getUpdated:function(){return this.getData("update",!0)},getDeleted:function(){return this.deletedRows},getAdded:function(){return this.getData("add",!0)},getChanges:function(){var e=this,t=(this.options,[]);return this.deletedRows&&$(this.deletedRows).each(function(){var i=$.extend(!0,{},this);t.push(e.formatRecord(i,!0))}),$.merge(t,e.getUpdated()),$.merge(t,e.getAdded()),t},getColumn:function(e){var t=this;this.options;if("string"==typeof e)return t._isColumnId(e)?t._columns[e]:t.columns[parseInt(e)];if("number"==typeof e)return t.columns[e];if("object"==typeof e&&1==e.nodeType){var i=e.id.split("|"),l=i[i.length-1];return t._columns[l]}return e},getColumnType:function(e){var t=this;this.options;for(i=0;i<t.columns.length;i++)if(t.columns[i].name==e)return t.columns[i].type?t.columns[i].type:"string";return null},isTotalSummary:function(){for(var e=this,t=(this.options,0);t<e.columns.length;t++)if(e.columns[t].totalSummary)return!0;return!1},getColumns:function(e){var t=this,i=(this.options,[]);for(var l in t._columns){var r=t._columns[l];void 0!=e?r.__level==e&&i.push(r):r.__leaf&&i.push(r)}return i},changeSort:function(e,t){var i=this,l=this.options;if(i.loading)return!0;if("local"==l.dataAction){var r=i.getColumnType(e);if(i.sortedData||(i.sortedData=i.filteredData),!i.sortedData||!i.sortedData[l.root])return;l.sortName==e?i.sortedData[l.root].reverse():i.sortedData[l.root].sort(function(t,l){return i._compareData(t,l,e,r)}),l.usePager?i.currentData=i._getCurrentPageData(i.sortedData):i.currentData=i.sortedData,i._showData()}l.sortName=e,l.sortOrder=t,"server"==l.dataAction&&i.loadData(l.where)},changePage:function(e){var t=this,i=this.options;if(t.loading)return!0;if("local"!=i.dataAction&&t.isDataChanged&&!confirm(i.isContinueByDataChanged))return!1;switch(i.pageCount=parseInt($(".pcontrol span",t.toolbar).html()),e){case"first":if(1==i.page)return;i.newPage=1;break;case"prev":if(1==i.page)return;i.page>1&&(i.newPage=parseInt(i.page)-1);break;case"next":if(i.page>=i.pageCount)return;i.newPage=parseInt(i.page)+1;break;case"last":if(i.page>=i.pageCount)return;i.newPage=i.pageCount;break;case"input":var l=parseInt($(".pcontrol input",t.toolbar).val());isNaN(l)&&(l=1),l<1?l=1:l>i.pageCount&&(l=i.pageCount),$(".pcontrol input",t.toolbar).val(l),i.newPage=l}return i.newPage!=i.page&&(1==i.newPage?($(".l-bar-btnfirst span",t.toolbar).addClass("l-disabled"),$(".l-bar-btnprev span",t.toolbar).addClass("l-disabled")):($(".l-bar-btnfirst span",t.toolbar).removeClass("l-disabled"),$(".l-bar-btnprev span",t.toolbar).removeClass("l-disabled")),i.newPage==i.pageCount?($(".l-bar-btnlast span",t.toolbar).addClass("l-disabled"),$(".l-bar-btnnext span",t.toolbar).addClass("l-disabled")):($(".l-bar-btnlast span",t.toolbar).removeClass("l-disabled"),$(".l-bar-btnnext span",t.toolbar).removeClass("l-disabled")),t.trigger("changePage",[i.newPage]),void("server"==i.dataAction?t.loadData(i.where):(t.currentData=t._getCurrentPageData(t.filteredData),t._showData())))},changePageToFirst:function(e){var t=this,i=this.options;if(t.loading)return!0;if("local"!=i.dataAction&&t.isDataChanged&&!confirm(i.isContinueByDataChanged))return!1;switch(i.pageCount=parseInt($(".pcontrol span",t.toolbar).html()),e){case"first":if(1==i.page)return;i.newPage=1;break;case"prev":if(1==i.page)return;i.page>1&&(i.newPage=parseInt(i.page)-1);break;case"next":if(i.page>=i.pageCount)return;i.newPage=parseInt(i.page)+1;break;case"last":if(i.page>=i.pageCount)return;i.newPage=i.pageCount;break;case"input":var l=parseInt($(".pcontrol input",t.toolbar).val());isNaN(l)&&(l=1),l<1?l=1:l>i.pageCount&&(l=i.pageCount),$(".pcontrol input",t.toolbar).val(l),i.newPage=l}return i.newPage!=i.page&&(1==i.newPage?($(".l-bar-btnfirst span",t.toolbar).addClass("l-disabled"),$(".l-bar-btnprev span",t.toolbar).addClass("l-disabled")):($(".l-bar-btnfirst span",t.toolbar).removeClass("l-disabled"),$(".l-bar-btnprev span",t.toolbar).removeClass("l-disabled")),i.newPage==i.pageCount?($(".l-bar-btnlast span",t.toolbar).addClass("l-disabled"),$(".l-bar-btnnext span",t.toolbar).addClass("l-disabled")):($(".l-bar-btnlast span",t.toolbar).removeClass("l-disabled"),$(".l-bar-btnnext span",t.toolbar).removeClass("l-disabled")),void t.trigger("changePage",[i.newPage]))},getSelectedRow:function(){for(var e in this.selected){var t=this.selected[e];if(t.__id in this.records)return t}return null},getSelectedRows:function(){var e=[];for(var t in this.selected){var i=this.selected[t];i.__id in this.records&&e.push(i)}return e},getSelectedRowObj:function(){for(var e in this.selected){var t=this.selected[e];if(t.__id in this.records)return this.getRowObj(t)}return null},getSelectedRowObjs:function(){var e=[];for(var t in this.selected){var i=this.selected[t];i.__id in this.records&&e.push(this.getRowObj(i))}return e},getCellObj:function(e,t){var i=this.getRow(e);return t=this.getColumn(t),document.getElementById(this._getCellDomId(i,t))},getRowObj:function(e,t){var i=this;this.options;return null==e?null:"string"==typeof e?i._isRowId(e)?document.getElementById(i.id+(t?"|1|":"|2|")+e):document.getElementById(i.id+(t?"|1|":"|2|")+i.rows[parseInt(e)].__id):"number"==typeof e?document.getElementById(i.id+(t?"|1|":"|2|")+i.rows[e].__id):"object"==typeof e&&e.__id?i.getRowObj(e.__id,t):e},getRow:function(e){var t=this;this.options;return null==e?null:"string"==typeof e?t._isRowId(e)?t.records[e]:t.rows[parseInt(e)]:"number"==typeof e?t.rows[parseInt(e)]:"object"!=typeof e||1!=e.nodeType||e.__id?e:t._getRowByDomId(e.id)},_setColumnVisible:function(e,t){var i=this;this.options;if(t){if(e._hide=!0,document.getElementById(e.__domid).style.display="none",e.__pid!=-1){for(var l=!0,r=this._columns[e.__pid],n=0;r&&n<r.columns.length;n++)if(!r.columns[n]._hide){l=!1;break}l&&(r._hide=!0,document.getElementById(r.__domid).style.display="none",this._setColumnVisible(r,t))}}else if(e._hide=!1,document.getElementById(e.__domid).style.display="",e.__pid!=-1){var r=i._columns[e.__pid];r._hide&&(document.getElementById(r.__domid).style.display="",this._setColumnVisible(r,t))}},toggleCol:function(e,t,i){var l,r=this;this.options;if("number"==typeof e)l=r.columns[e];else if("object"==typeof e&&e.__id)l=e;else if("string"==typeof e){if(!r._isColumnId(e))return void $(r.columns).each(function(){this.name==e&&r.toggleCol(this,t,i)});l=r._columns[e]}if(l){var n=l.__leafindex,a=document.getElementById(l.__domid);if(a){a=$(a);var o=[];for(var s in r.rows){var d=r.getCellObj(r.rows[s],l);d&&o.push(d)}for(var s=0;s<r.totalNumber;s++){var c=document.getElementById(r.id+"|total"+s+"|"+l.__id);c&&o.push(c)}var u=l._width;t&&l._hide?(l.frozen?r.f.gridtablewidth+=parseInt(u)+1:r.gridtablewidth+=parseInt(u)+1,r._setColumnVisible(l,!1),$(o).show()):t||l._hide||(l.frozen?r.f.gridtablewidth-=parseInt(u)+1:r.gridtablewidth-=parseInt(u)+1,r._setColumnVisible(l,!0),$(o).hide()),l.frozen?($("div:first",r.f.gridheader).width(r.f.gridtablewidth),$("div:first",r.f.gridbody).width(r.f.gridtablewidth)):($("div:first",r.gridheader).width("100%"),$("div:first",r.gridbody).width("100%")),r._updateFrozenWidth(),i||$(":checkbox[columnindex="+n+"]",r.popup).each(function(){if(this.checked=t,$.fn.ligerCheckBox){var e=$(this).ligerGetCheckBoxManager();e&&e.updateStyle()}})}}},setColumnWidth:function(e,t){var i=this,l=this.options;if(t){t=parseInt(t,10);var r;if("number"==typeof e)r=i.columns[e];else if("object"==typeof e&&e.__id)r=e;else if("string"==typeof e){if(!i._isColumnId(e))return void $(i.columns).each(function(){this.name==e&&i.setColumnWidth(this,t)});r=i._columns[e]}if(r){var n=l.minColumnWidth;r.minWidth&&(n=r.minWidth),t=t<n?n:t;var a=t-r._width;if(0!=i.trigger("beforeChangeColumnWidth",[r,t])){r._width=t,r.frozen?(i.f.gridtablewidth+=a,$("div:first",i.f.gridheader).width(i.f.gridtablewidth),$("div:first",i.f.gridbody).width(i.f.gridtablewidth)):(i.gridtablewidth+=a,$("div:first",i.gridheader).width("100%"),$("div:first",i.gridbody).width("100%")),$(document.getElementById(r.__domid)).css("width",t);var o=[];for(var s in i.records){var d=i.getCellObj(i.records[s],r);if(d&&o.push(d),!i.enabledDetailEdit()&&i.editors[s]&&i.editors[s][r.__id]){var c=i.editors[s][r.__id];c.editor.resize&&c.editor.resize(c.input,t,c.container.height(),c.editParm)}}for(var u=0;u<i.totalNumber;u++){var h=document.getElementById(i.id+"|total"+u+"|"+r.__id);h&&o.push(h)}$(o).css("width",t).find("> div.l-grid-row-cell-inner:first").css("width","100%"),i._updateFrozenWidth(),i._updateHorizontalScrollStatus.ligerDefer(i,10),i.trigger("afterChangeColumnWidth",[r,t])}}}},changeHeaderText:function(e,t){var i,l=this,r=this.options;if("number"==typeof e)i=l.columns[e];else if("object"==typeof e&&e.__id)i=e;else if("string"==typeof e){if(!l._isColumnId(e))return void $(l.columns).each(function(){this.name==e&&l.changeHeaderText(this,t)});i=l._columns[e]}if(i){var n=i.__leafindex,a=document.getElementById(i.__domid);$(".l-grid-hd-cell-text",a).html(t),r.allowHideColumn&&$(":checkbox[columnindex="+n+"]",l.popup).parent().next().html(t)}},changeCol:function(e,t,i){var l=this,r=this.options;if(e&&t){var n=l.getColumn(e),a=l.getColumn(t);n.frozen=a.frozen;var o,s,d=n.__pid==-1?r.columns:l._columns[n.__pid].columns,c=a.__pid==-1?r.columns:l._columns[a.__pid].columns;o=$.inArray(n,d),s=$.inArray(a,c);var u=d==c;n.__level==a.__level;c.splice(s+(i?1:0),0,n),u?i?d.splice(o,1):d.splice(o+1,1):d.splice(o,1),l._setColumns(r.columns),l.reRender()}},collapseDetail:function(e){var t=this,i=(this.options,t.getRow(e));if(i)for(var l=0,r=t.columns.length;l<r;l++)if(t.columns[l].isdetail){var n=t.getRowObj(i),a=t.getCellObj(i,t.columns[l]);return $(n).next("tr.l-grid-detailpanel").hide(),$(".l-grid-row-cell-detailbtn:first",a).removeClass("l-open"),void t.trigger("SysGridHeightChanged")}},extendDetail:function(e){var t=this,i=(this.options,t.getRow(e));if(i)for(var l=0,r=t.columns;l<r;l++)if(t.columns[l].isdetail){var n=t.getRowObj(i),a=t.getCellObj(i,t.columns[l]);return $(n).next("tr.l-grid-detailpanel").show(),$(".l-grid-row-cell-detailbtn:first",a).addClass("l-open"),void t.trigger("SysGridHeightChanged")}},getParent:function(e){var t=this,i=this.options;if(!i.tree)return null;var l=t.getRow(e);return l&&l.__pid in t.records?t.records[l.__pid]:null},getChildren:function(e,t){function i(e){if(e[r.tree.childrenName])for(var l=0,n=e[r.tree.childrenName].length;l<n;l++){var o=e[r.tree.childrenName][l];"delete"!=o.__status&&(a.push(o),t&&i(o))}}var l=this,r=this.options;if(!r.tree)return null;var n=l.getRow(e);if(!n)return null;var a=[];return i(n),a},isLeaf:function(e){var t=this,i=(this.options,t.getRow(e));if(i)return!i.__hasChildren},hasChildren:function(e){var t=this.options,i=this.getRow(e);if(i)return!(!i[t.tree.childrenName]||!i[t.tree.childrenName].length)},existRecord:function(e){for(var t in this.records)if(this.records[t]==e)return!0;return!1},_removeSelected:function(e){var t=this,i=this.options;if(i.tree){var l=t.getChildren(e,!0);if(l)for(var r=0,n=l.length;r<n;r++){var a=$.inArray(l[r],t.selected);a!=-1&&t.selected.splice(a,1)}}var o=$.inArray(e,t.selected);o!=-1&&t.selected.splice(o,1)},_getParentChildren:function(e){var t,i=this,l=this.options,r=i.getRow(e);return t=l.tree&&i.existRecord(r)&&r.__pid in i.records?i.records[r.__pid][l.tree.childrenName]:i.currentData[l.root]},_removeData:function(e){var t=this,i=(this.options,t._getParentChildren(e)),l=$.inArray(e,i);l!=-1&&i.splice(l,1),t._removeSelected(e)},_addData:function(e,t,i,l){var r=this,n=this.options;r.currentData||(r.currentData={}),r.currentData[n.root]||(r.currentData[n.root]=[]);var a=r.currentData[n.root];if(i){n.tree&&(t?a=t[n.tree.childrenName]:i.__pid in r.records&&(a=r.records[i.__pid][n.tree.childrenName]));var o=$.inArray(i,a);a.splice(o==-1?-1:o+(l?0:1),0,e)}else n.tree&&t&&(a=t[n.tree.childrenName]),a.push(e)},_appendData:function(e,t,i,l){var r=this,n=this.options;e[n.statusName]="update",r._removeData(e),r._addData(e,t,i,l)},appendRange:function(e,t,i,l){var r=this,n=(this.options,!1);$.each(e,function(e,a){a.__id&&r.existRecord(a)?(r.isLeaf(t)&&r.upgrade(t),r._appendData(a,t,i,l),n=!0):r.appendRow(a,t,i,l)}),n&&r.reRender()},appendRow:function(e,t,i,l){var r=this;this.options;return $.isArray(e)?void r.appendRange(e,t,i,l):e.__id&&r.existRecord(e)?(r._appendData(e,t,i,l),void r.reRender()):(t&&r.isLeaf(t)&&r.upgrade(t),void r.addRow(e,i,!!l,t))},upgrade:function(e){var t=this,i=this.options,l=t.getRow(e);if(l&&i.tree){l[i.tree.childrenName]=l[i.tree.childrenName]||[],l.__hasChildren=!0;var r=[t.getRowObj(l)];t.enabledFrozen()&&r.push(t.getRowObj(l,!0)),$("> td > div > .l-grid-tree-space:last",r).addClass("l-grid-tree-link l-grid-tree-link-open")}},demotion:function(e){var t=this,i=this.options,l=t.getRow(e);if(l&&i.tree){var r=[t.getRowObj(l)];if(t.enabledFrozen()&&r.push(t.getRowObj(l,!0)),$("> td > div > .l-grid-tree-space:last",r).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close"),t.hasChildren(l))for(var n=t.getChildren(l),a=0,o=n.length;a<o;a++)t.deleteRow(n[a]);l.__hasChildren=!1}},collapse:function(e){var t=this,i=(this.options,t.getRowObj(e)),l=$(".l-grid-tree-link",i);l.hasClass("l-grid-tree-link-close")||t.toggle(e)},expand:function(e){var t=this,i=(this.options,t.getRowObj(e)),l=$(".l-grid-tree-link",i);l.hasClass("l-grid-tree-link-open")||t.toggle(e)},toggle:function(rowParm){if(rowParm){var g=this,p=this.options,rowdata=g.getRow(rowParm),targetRowObj=[g.getRowObj(rowdata)];g.enabledFrozen()&&targetRowObj.push(g.getRowObj(rowdata,!0));var level=rowdata.__level,indexInCollapsedRows,linkbtn=$(".l-grid-tree-link:first",targetRowObj),opening=!0;g.collapsedRows=g.collapsedRows||[];var flag=linkbtn.hasClass("l-grid-tree-link-close");p.treeAsync&&flag&&null==window[rowdata.ObjectID+"_load"]&&$.ajax({url:p.treeUrl+"&id="+rowdata.ObjectID,type:"POST",async:!1,dataType:"text",success:function(data){var obj=eval(data);window[rowdata.ObjectID+"_load"]=!0;for(var datas=[],i=0;i<obj.length;i++){var data;data=0==obj[i].Type?{DisplayName:obj[i].DisplayName,ObjectID:obj[i].ObjectID,Code:obj[i].Code,Type:obj[i].Type,Version:obj[i].Version,PublishedTime:obj[i].PublishedTime,Frequent:obj[i].Frequent,children:[]}:{DisplayName:obj[i].DisplayName,ObjectID:obj[i].ObjectID,Code:obj[i].Code,Type:obj[i].Type,Version:obj[i].Version,PublishedTime:obj[i].PublishedTime,Frequent:obj[i].Frequent},datas.push(data)}g.addRows(datas,null,!0,rowdata)},error:function(e,t,i){alert(t)}}),linkbtn.hasClass("l-grid-tree-link-close")?(linkbtn.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open"),indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows),indexInCollapsedRows!=-1&&g.collapsedRows.splice(indexInCollapsedRows,1)):(opening=!1,linkbtn.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open"),indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows),indexInCollapsedRows==-1&&g.collapsedRows.push(rowdata));for(var children=g.getChildren(rowdata,!0),i=0,l=children.length;i<l;i++){var o=children[i],currentRow=$([g.getRowObj(o.__id)]);g.enabledFrozen()&&(currentRow=currentRow.add(g.getRowObj(o.__id,!0))),opening?o.__hasChildren&&p.treeAsync&&0==o.children.length?($(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-clode"),currentRow.show()):($(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open"),currentRow.show()):opening||($(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-close"),currentRow.hide())}}},_bulid:function(){var e=this;e._clearGrid(),e._initBuildHeader(),e._initHeight(),e._initFootbar(),e._buildPager(),e._setEvent()},_setColumns:function(e){var t=this;t._initColumns(),t._initBuildGridHeader(),t._initBuildPopup()},_initBuildHeader:function(){var e=this,t=this.options;t.title?($(".l-panel-header-text",e.header).html(t.title),t.headerImg&&e.header.append("<img src='"+t.headerImg+"' />").addClass("l-panel-header-hasicon")):e.header.hide(),t.toolbar?$.fn.ligerToolBar&&(e.toolbarManager=e.topbar.ligerToolBar(t.toolbar)):e.topbar.parent().remove()},_createColumnId:function(e){return null!=e.id&&""!=e.id?e.id.toString():"c"+(100+this._columnCount)},_isColumnId:function(e){return e in this._columns},_initColumns:function(){function e(e,t){for(var i in t)t[i]in e&&delete e[t[i]]}function t(l,r,n,a){if(e(l,["__id","__pid","__previd","__nextid","__domid","__leaf","__leafindex","__level","__colSpan","__rowSpan"]),r>i._columnMaxLevel&&(i._columnMaxLevel=r),i._columnCount++,l.__id=i._createColumnId(l),l.__domid=i.id+"|hcell|"+l.__id,i._columns[l.__id]=l,l.columns&&l.columns.length||(l.__leafindex=i._columnLeafCount++),l.__level=r,l.__pid=n,l.__previd=a,!l.columns||!l.columns.length)return l.__leaf=!0,1;for(var o=0,s=-1,d=0,c=l.columns.length;d<c;d++){var u=l.columns[d];o+=t(u,r+1,l.__id,s),s=u.__id}return l.__leafcount=o,o}var i=this,l=this.options;if(i._columns={},i._columnCount=0,i._columnLeafCount=0,i._columnMaxLevel=1,l.columns){var r=-1;if(l.rownumbers){var n=!i.enabledGroup()&&(l.frozen&&l.frozenRownumbers),a={isrownumber:!0,issystem:!0,width:l.rownumbersColWidth,frozen:n};t(a,1,-1,r),r=a.__id}if(i.enabledDetail()){var o=!i.enabledGroup()&&(l.frozen&&l.frozenDetail),a={isdetail:!0,issystem:!0,
width:l.detailColWidth,frozen:o};t(a,1,-1,r),r=a.__id}if(i.enabledCheckbox()){var s=!i.enabledGroup()&&(l.frozen&&l.frozenCheckbox),a={ischeckbox:!0,issystem:!0,width:l.detailColWidth,frozen:s};t(a,1,-1,r),r=a.__id}for(var d=0,c=l.columns.length;d<c;d++){var a=l.columns[d];t(a,1,-1,r),r=a.__id}for(var u in i._columns){var a=i._columns[u];a.__leafcount>1&&(a.__colSpan=a.__leafcount),a.__leaf&&a.__level!=i._columnMaxLevel&&(a.__rowSpan=i._columnMaxLevel-a.__level+1)}i.columns=i.getColumns(),$(i.columns).each(function(e,t){t.columnname=t.name,t.columnindex=e,t.type=t.type||"string",t.islast=e==i.columns.length-1,t.isSort=0!=t.isSort,t.frozen=!!t.frozen,t._width=i._getColumnWidth(t),t._hide=!!t.hide})}},_getColumnWidth:function(e){var t=this,i=this.options;if(e._width)return e._width;var l=e.width||i.columnWidth;if(!l||"auto"==l){var r=0,n=0;$(t.columns).each(function(e,l){var a=l.width||i.columnWidth,o=!a||"auto"==a;o?r++:n+=parseFloat(t._getColumnWidth(l))+1}),l=parseFloat((t.grid.width()-n)/r)-1}return"string"==typeof l&&l.indexOf("%")>0&&(e._width=l=parseInt(.01*parseInt(l)*(t.grid.width()-t.columns.length))),e.minWidth&&l<e.minWidth&&(l=e.minWidth),e.maxWidth&&l>e.maxWidth&&(l=e.maxWidth),l},_createHeaderCell:function(e){var t=this,i=this.options,l=$("<td class='l-grid-hd-cell'><div class='l-grid-hd-cell-inner'><span class='l-grid-hd-cell-text'></span></div></td>");if(l.attr("id",e.__domid),e.__leaf||l.addClass("l-grid-hd-cell-mul"),e.columnindex==t.columns.length-1&&l.addClass("l-grid-hd-cell-last"),e.isrownumber&&(l.addClass("l-grid-hd-cell-rownumbers"),l.html("<div class='l-grid-hd-cell-inner'></div>")),e.ischeckbox&&(l.addClass("l-grid-hd-cell-checkbox"),l.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'></div></div>")),e.isdetail&&(l.addClass("l-grid-hd-cell-detail"),l.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-detail'></div></div>")),e.heightAlign&&$(".l-grid-hd-cell-inner:first",l).css("textAlign",e.heightAlign),e.__colSpan&&l.attr("colSpan",e.__colSpan),e.__rowSpan){l.attr("rowSpan",e.__rowSpan),l.height(i.headerRowHeight*e.__rowSpan);var r=(i.headerRowHeight*e.__rowSpan-i.headerRowHeight)/2-5;$(".l-grid-hd-cell-inner:first",l).css("paddingTop",r)}else l.height(i.headerRowHeight);e.__leaf&&(l.width(e._width),l.attr("columnindex",e.__leafindex));var n=l.height();!e.__rowSpan&&n>10&&$(">div:first",l).height(n),e._hide&&l.hide(),e.name&&l.attr({columnname:e.name});var a="";return a=e.display&&""!=e.display?e.display:e.headerRender?e.headerRender(e):"&nbsp;",$(".l-grid-hd-cell-text:first",l).html(a),!e.issystem&&e.__leaf&&e.resizable!==!1&&$.fn.ligerResizable&&i.allowAdjustColWidth&&(t.colResizable[e.__id]=l.ligerResizable({handles:"e",onStartResize:function(e,i){this.proxy.hide(),t.draggingline.css({height:t.body.height(),top:0,left:i.pageX-t.grid.offset().left+parseInt(t.body[0].scrollLeft)}).show()},onResize:function(e,i){t.colresizing=!0,t.draggingline.css({left:i.pageX-t.grid.offset().left+parseInt(t.body[0].scrollLeft)}),$("body").add(l).css("cursor","e-resize")},onStopResize:function(i){return t.colresizing=!1,$("body").add(l).css("cursor","default"),t.draggingline.hide(),t.setColumnWidth(e,parseInt(e._width)+i.diffX),!1}})),l},_initBuildGridHeader:function(){var e=this,t=this.options;if(e.gridtablewidth=0,e.f.gridtablewidth=0,e.colResizable){for(var i in e.colResizable)e.colResizable[i].destroy();e.colResizable=null}e.colResizable={},$("tbody:first",e.gridheader).html(""),$("tbody:first",e.f.gridheader).html("");for(var l=1;l<=e._columnMaxLevel;l++){var r=e.getColumns(l),n=l==e._columnMaxLevel,a=$("<tr class='l-grid-hd-row'></tr>"),o=$("<tr class='l-grid-hd-row'></tr>");n||a.add(o).addClass("l-grid-hd-mul"),$("tbody:first",e.gridheader).append(a),$("tbody:first",e.f.gridheader).append(o),$(r).each(function(t,i){if((i.frozen?o:a).append(e._createHeaderCell(i)),i.__leaf){var l=i._width;i.frozen?e.f.gridtablewidth+=(parseInt(l)?parseInt(l):0)+1:e.gridtablewidth+=(parseInt(l)?parseInt(l):0)+1}}),a.append($("<td style='width:8px;'></td>"))}if(e._columnMaxLevel>0){var s=t.headerRowHeight*e._columnMaxLevel;e.gridheader.add(e.f.gridheader).height(s),t.rownumbers&&t.frozenRownumbers&&e.f.gridheader.find("td:first").height(s)}e._updateFrozenWidth(),$("div:first",e.gridheader).width("100%")},_initBuildPopup:function(){var e=this,t=this.options;if($(":checkbox",e.popup).unbind(),$("tbody tr",e.popup).remove(),$(e.columns).each(function(t,i){if(!i.issystem&&0!=i.isAllowHide){var l='checked="checked"';i._hide&&(l="");var r=i.display;$("tbody",e.popup).append('<tr><td class="l-column-left"><input type="checkbox" '+l+' class="l-checkbox" columnindex="'+t+'"/></td><td class="l-column-right">'+r+"</td></tr>")}}),$.fn.ligerCheckBox&&$("input:checkbox",e.popup).ligerCheckBox({onBeforeClick:function(i){return!i.checked||!($("input:checked",e.popup).length<=t.minColToggle)}}),t.allowHideColumn){$("tr",e.popup).hover(function(){$(this).addClass("l-popup-row-over")},function(){$(this).removeClass("l-popup-row-over")});var i=function(){return!($("input:checked",e.popup).length+1<=t.minColToggle)&&void e.toggleCol(parseInt($(this).attr("columnindex")),this.checked,!0)};$.fn.ligerCheckBox?$(":checkbox",e.popup).bind("change",i):$(":checkbox",e.popup).bind("click",i)}},_initHeight:function(){var e=this,t=this.options;"auto"==t.height&&(e.gridbody.height("auto"),e.f.gridbody.height("auto")),t.width&&e.grid.width(t.width),e._onResize.call(e)},_initFootbar:function(){var e=this,t=this.options;if(t.usePager){var i="",l=-1;$(t.pageSizeOptions).each(function(e,r){var n="";t.pageSize==r&&(l=e),i+="<option value='"+r+"' "+n+" >"+r+"</option>"}),$(".l-bar-selectpagesize",e.toolbar).append("<select name='rp'>"+i+"</select>"),l!=-1&&($(".l-bar-selectpagesize select",e.toolbar)[0].selectedIndex=l),t.switchPageSizeApplyComboBox&&$.fn.ligerComboBox&&$(".l-bar-selectpagesize select",e.toolbar).ligerComboBox({onBeforeSelect:function(){return!(t.url&&e.isDataChanged&&!confirm(t.isContinueByDataChanged))},width:45})}else e.toolbar.hide()},_searchData:function(e,t){for(var i=(this.options,new Array),l=0;l<e.length;l++)t(e[l],l)&&(i[i.length]=e[l]);return i},_clearGrid:function(){var e=this;this.options;for(var t in e.rows){var i=$(e.getRowObj(e.rows[t]));e.enabledFrozen()&&(i=i.add(e.getRowObj(e.rows[t],!0))),i.unbind()}e.gridbody.html(""),e.f.gridbody.html(""),e.recordNumber=0,e.records={},e.rows=[],e.selected=[],e.totalNumber=0,e.editorcounter=0},_fillGridBody:function(e,t){var i=this,l=this.options,r=['<div class="l-grid-body-inner"><table class="l-grid-body-table" cellpadding=0 cellspacing=0><tbody>'];if(i.enabledGroup()){var n=[],a=[];i.groups=a;for(var o in e){var s=e[o],d=s[l.groupColumnName],c=$.inArray(d,n);c==-1&&(n.push(d),c=n.length-1,a.push([])),a[c].push(s)}$(a).each(function(e,o){1==a.length&&r.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"'),e==a.length-1?r.push('<tr class="l-grid-grouprow l-grid-grouprow-last"'):0==e?r.push('<tr class="l-grid-grouprow l-grid-grouprow-first"'):r.push('<tr class="l-grid-grouprow"'),r.push(' groupindex"='+e+'" >'),r.push('<td colSpan="'+i.columns.length+'" class="l-grid-grouprow-cell">'),r.push('<span class="l-grid-group-togglebtn">&nbsp;&nbsp;&nbsp;&nbsp;</span>'),l.groupRender?r.push(l.groupRender(n[e],o,l.groupColumnDisplay)):r.push(l.groupColumnDisplay+":"+n[e]),r.push("</td>"),r.push("</tr>"),r.push(i._getHtmlFromData(o,t)),i.isTotalSummary()&&r.push(i._getTotalSummaryHtml(o,"l-grid-totalsummary-group",t))})}else r.push(i._getHtmlFromData(e,t));r.push("</tbody></table></div>"),(t?i.f.gridbody:i.gridbody).html(r.join("")),i.enabledGroup()||i._bulidTotalSummary(t),$("> div:first",i.gridbody).width("100%"),i._onResize()},_showData:function(){var e=this,t=this.options;e.changedCells={};var i=e.currentData[t.root];if(t.usePager&&("server"==t.dataAction&&e.data&&e.data[t.record]?t.total=e.data[t.record]:e.filteredData&&e.filteredData[t.root]?t.total=e.filteredData[t.root].length:e.data&&e.data[t.root]?t.total=e.data[t.root].length:i&&(t.total=i.length),t.page=t.newPage,t.total||(t.total=0),t.page||(t.page=1),t.pageCount=Math.ceil(t.total/t.pageSize),t.pageCount||(t.pageCount=1),e._buildPager()),$(".l-bar-btnloading:first",e.toolbar).removeClass("l-bar-btnloading"),0!=e.trigger("beforeShowData",[e.currentData])){if(e._clearGrid(),e.isDataChanged=!1,!i||!i.length)return e.gridview.addClass("l-grid-empty"),$("<div></div>").addClass("l-grid-body-inner").appendTo(e.gridbody).css({width:"100%",height:"100%"}),void e._onResize.ligerDefer(e,50);if(e.gridview.removeClass("l-grid-empty"),$(".l-bar-btnload:first span",e.toolbar).removeClass("l-disabled"),e._updateGridData(),e.enabledFrozen()&&e._fillGridBody(e.rows,!0),e._fillGridBody(e.rows,!1),e.trigger("SysGridHeightChanged"),t.totalRender&&($(".l-panel-bar-total",e.element).remove(),$(".l-panel-bar",e.element).before('<div class="l-panel-bar-total">'+t.totalRender(e.data,e.filteredData)+"</div>")),t.mouseoverRowCssClass)for(var l in e.rows){var r=$(e.getRowObj(e.rows[l]));e.enabledFrozen()&&(r=r.add(e.getRowObj(e.rows[l],!0))),r.bind("mouseover.gridrow",function(){e._onRowOver(this,!0)}).bind("mouseout.gridrow",function(){e._onRowOver(this,!1)})}e._fixHeight(),e.gridbody.trigger("scroll.grid"),e.trigger("afterShowData",[e.currentData])}},_fixHeight:function(){var e=this,t=this.options;if(!t.fixedCellHeight&&t.frozen){var i,l;for(var r in e.columns){var n=e.columns[r];if(i&&l)break;!n.frozen||i?n.frozen||l||(l=n):i=n}if(i&&l)for(var a in e.records){var o=e.getCellObj(a,i),s=e.getCellObj(a,l),d=Math.max($(o).height(),$(s).height());$(o).add(s).height(d)}}},_getRowDomId:function(e,t){return this.id+"|"+(t?"1":"2")+"|"+e.__id},_getCellDomId:function(e,t){return this._getRowDomId(e,t.frozen)+"|"+t.__id},_getHtmlFromData:function(e,t){if(!e)return"";for(var i=this,l=this.options,r=[],n=0,a=e.length;n<a;n++){var o=e[n],s=o.__id;if(o){if(r.push("<tr"),r.push(' id="'+i._getRowDomId(o,t)+'"'),r.push(' class="l-grid-row'),!t&&i.enabledCheckbox()&&l.isChecked&&l.isChecked(o)?(i.select(o),r.push(" l-selected")):i.isSelected(o)?r.push(" l-selected"):l.isSelected&&l.isSelected(o)&&(i.select(o),r.push(" l-selected")),o.__index%2==1&&l.alternatingRow&&r.push(" l-grid-row-alt"),r.push('" '),l.rowAttrRender&&r.push(l.rowAttrRender(o,s)),l.tree&&i.collapsedRows&&i.collapsedRows.length){var d=function(){for(var e=i.getParent(o);e;){if($.inArray(e,i.collapsedRows)!=-1)return!0;e=i.getParent(e)}return!1};d()&&r.push(' style="display:none;" ')}r.push(">"),$(i.columns).each(function(e,n){if(t==n.frozen){if(r.push("<td"),r.push(' id="'+i._getCellDomId(o,this)+'"'),this.isrownumber)return r.push(' class="l-grid-row-cell l-grid-row-cell-rownumbers" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),l.fixedCellHeight?r.push(' style = "height:'+l.rowHeight+'px;" '):r.push(' style = "min-height:'+l.rowHeight+'px;" '),void r.push(">"+(parseInt(o.__index)+1)+"</div></td>");if(this.ischeckbox)return r.push(' class="l-grid-row-cell l-grid-row-cell-checkbox" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),l.fixedCellHeight?r.push(' style = "height:'+l.rowHeight+'px;" '):r.push(' style = "min-height:'+l.rowHeight+'px;" '),r.push(">"),r.push('<span class="l-grid-row-cell-btn-checkbox"></span>'),void r.push("</div></td>");if(this.isdetail)return r.push(' class="l-grid-row-cell l-grid-row-cell-detail" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),l.fixedCellHeight?r.push(' style = "height:'+l.rowHeight+'px;" '):r.push(' style = "min-height:'+l.rowHeight+'px;" '),r.push(">"),l.isShowDetailToggle&&!l.isShowDetailToggle(o)||r.push('<span class="l-grid-row-cell-detailbtn"></span>'),void r.push("</div></td>");var a=this._width;r.push(' class="l-grid-row-cell '),i.changedCells[s+"_"+this.__id]&&r.push("l-grid-row-cell-edited "),this.islast&&r.push("l-grid-row-cell-last "),r.push('"'),r.push(' style = "'),r.push("width:"+a+"px; "),n._hide&&r.push("display:none;"),r.push(' ">'),r.push(i._getCellHtml(o,n)),r.push("</td>")}}),r.push("</tr>")}}return r.join("")},_getCellHtml:function(e,t){var i=this,l=this.options;if(t.isrownumber)return'<div class="l-grid-row-cell-inner">'+(parseInt(e.__index)+1)+"</div>";var r=[];r.push('<div class="l-grid-row-cell-inner"'),r.push(' style = "'),l.fixedCellHeight&&r.push("height:"+l.rowHeight+"px;"),r.push("min-height:"+l.rowHeight+"px; "),t.align&&r.push("text-align:"+t.align+";");var n=i._getCellContent(e,t);return r.push('">'+n+"</div>"),r.join("")},_setValueByName:function(e,t,i){if(!e||!t)return null;if(t.indexOf(".")==-1)e[t]=i;else try{new Function("data,value","data."+t+"=value;")(e,i)}catch(e){}},_getValueByName:function(e,t){if(!e||!t)return null;if(t.indexOf(".")==-1)return e[t];try{return new Function("data","return data."+t+";")(e)}catch(e){return null}},_getCellContent:function(e,t){var i=this,l=this.options;if(!e||!t)return"";if(t.isrownumber)return parseInt(e.__index)+1;var r=(e.__id,e.__index),n=i._getValueByName(e,t.name),a=i._getValueByName(e,t.textField),o="";return t.render?o=t.render.call(i,e,r,n,t):l.formatters[t.type]?o=l.formatters[t.type].call(i,n,t):null!=a?o=a.toString():null!=n&&(o=n.toString()),l.tree&&(null!=l.tree.columnName&&l.tree.columnName==t.name||null!=l.tree.columnId&&l.tree.columnId==t.id)&&(o=i._getTreeCellHtml(o,e)),o||""},_getTreeCellHtml:function(e,t){var i=t.__level,l=this,r=this.options,n=$.inArray(t,l.collapsedRows||[])==-1,a=r.tree.isParent(t),o="";i=parseInt(i)||1;for(var s=1;s<i;s++)o+="<div class='l-grid-tree-space'></div>";return o+=n&&a&&r.treeAsync&&null==window[t.ObjectID+"_load"]?"<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>":n&&a?"<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'></div>":a?"<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>":"<div class='l-grid-tree-space'></div>",o+="<span class='l-grid-tree-content'>"+e+"</span>"},_applyEditor:function(e){var t=this,i=this.options,l=e,r=l.id.split("|"),n=r[r.length-1],a=t._columns[n],o=$(l).parent(),s=t.getRow(o[0]),d=s.__id,c=s.__index;if(a&&a.editor){var u=a.name;a.columnindex;if(a.editor.type&&i.editors[a.editor.type]){var h=t._getValueByName(s,u),g={record:s,value:h,column:a,rowindex:c};if(a.textField&&(g.text=t._getValueByName(s,a.textField)),0==t.trigger("beforeEdit",[g]))return!1;t.lastEditRow=s;var p=i.editors[a.editor.type],f=$(l),v=($(l).offset(),$(l).width()),m=$(l).height(),b=$("<div class='l-grid-editor'></div>").appendTo(t.grid),x=0,w=0,y=f.position(),_=t.gridbody.position(),C=t.gridview2.position(),D=i.toolbar?t.topbar.parent().outerHeight():0+i.title?t.header.outerHeight():0,x=y.left+_.left+C.left,w=y.top+_.top+C.top+D;f.html(""),t.setCellEditing(s,a,!0),b.css({left:x,top:$.browser.safari?w+2:w+1}).show(),a.textField&&(g.text=t._getValueByName(s,a.textField));var k=t._createEditor(p,b,g,v,m-1);t.editor={editing:!0,editor:p,input:k,editParm:g,container:b},t.unbind("sysEndEdit"),t.bind("sysEndEdit",function(){var e=p.getValue(k,g);e!=h&&($(l).addClass("l-grid-row-cell-edited"),t.changedCells[d+"_"+a.__id]=!0,g.value=e,a.textField&&p.getText&&(g.text=p.getText(k,g)),p.getSelected&&(g.selected=p.getSelected(k,g)),a.editor.onChange&&a.editor.onChange(g),t._checkEditAndUpdateCell(g)&&a.editor.onChanged&&a.editor.onChanged(g))})}}},_checkEditAndUpdateCell:function(e){var t=this;this.options;if(0==t.trigger("beforeSubmitEdit",[e]))return!1;var i=e.column;return e.text&&i.textField&&t._setValueByName(e.record,i.textField,e.text),t.updateCell(i,e.value,e.record),(i.render||t.enabledTotal())&&t.reRender({column:i}),t.reRender({rowdata:e.record}),!0},_getCurrentPageData:function(e){var t=this.options,l={};if(l[t.root]=[],!e||!e[t.root]||!e[t.root].length)return l[t.record]=0,l;for(l[t.record]=e[t.root].length,t.newPage||(t.newPage=1),i=(t.newPage-1)*t.pageSize;i<e[t.root].length&&i<t.newPage*t.pageSize;i++)l[t.root].push(e[t.root][i]);return l},_compareData:function(e,t,i,l){var r=this,n=this.options,a=e[i],o=t[i];return null==a&&null!=o?1:null==a&&null==o?0:null!=a&&null==o?-1:n.sorters[l]?n.sorters[l].call(r,a,o):a<o?-1:a>o?1:0},_getTotalCellContent:function(e,t){var i=this,l=(this.options,[]);if(e.totalSummary){for(var r=function(e){for(var t=0;t<g.length;t++)if(g[t].toLowerCase()==e.toLowerCase())return!0;return!1},n=0,a=0,o=0,s=parseFloat(t[0][e.name]),d=parseFloat(t[0][e.name]),c=0;c<t.length;c++){a+=1;var u=t[c][e.name];"string"==typeof u&&(u=u.replace(/\$|\,/g,"")),u=parseFloat(u),u&&(n+=u,u>s&&(s=u),u<d&&(d=u))}if(o=1*n/t.length,e.totalSummary.render){var h=e.totalSummary.render({sum:n,count:a,avg:o,min:d,max:s},e,i.data);l.push(h)}else if(e.totalSummary.type){var g=e.totalSummary.type.split(",");r("sum")&&l.push("<div>Sum="+n.toFixed(2)+"</div>"),r("count")&&l.push("<div>Count="+a+"</div>"),r("max")&&l.push("<div>Max="+s.toFixed(2)+"</div>"),r("min")&&l.push("<div>Min="+d.toFixed(2)+"</div>"),r("avg")&&l.push("<div>Avg="+o.toFixed(2)+"</div>")}}return l.join("")},_getTotalSummaryHtml:function(e,t,i){var l=this,r=(this.options,[]);return t?r.push('<tr class="l-grid-totalsummary '+t+'">'):r.push('<tr class="l-grid-totalsummary">'),$(l.columns).each(function(t,n){if(this.frozen==i){if(this.isrownumber)return void r.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style="width:'+this.width+'px"><div>&nbsp;</div></td>');if(this.ischeckbox)return void r.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style="width:'+this.width+'px"><div>&nbsp;</div></td>');if(this.isdetail)return void r.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style="width:'+this.width+'px"><div>&nbsp;</div></td>');r.push('<td class="l-grid-totalsummary-cell'),this.islast&&r.push(" l-grid-totalsummary-cell-last"),r.push('" '),r.push('id="'+l.id+"|total"+l.totalNumber+"|"+n.__id+'" '),r.push('width="'+this._width+'" '),columnname=this.columnname,columnname&&r.push('columnname="'+columnname+'" '),r.push('columnindex="'+t+'" '),r.push('><div class="l-grid-totalsummary-cell-inner"'),n.align&&r.push(' style="text-Align:'+n.align+';"'),r.push(">"),r.push(l._getTotalCellContent(n,e)),r.push("</div></td>")}}),r.push("</tr>"),i||l.totalNumber++,r.join("")},_bulidTotalSummary:function(e){var t=this,i=this.options;if(!t.isTotalSummary())return!1;if(!t.currentData||0==t.currentData[i.root].length)return!1;var l=$(t._getTotalSummaryHtml(t.currentData[i.root],null,e));$("tbody:first",e?t.f.gridbody:t.gridbody).append(l),e?t.totalRow1=l:t.totalRow2=l},updateTotalSummary:function(){var e=this,t=this.options;if(e.isTotalSummary()&&e.currentData&&0!=e.currentData[t.root].length){var i=$(e._getTotalSummaryHtml(e.currentData[t.root],null,!1));e.totalRow2&&e.totalRow2.html(i.html())}},_buildPager:function(){var e=this,t=this.options;$(".pcontrol input",e.toolbar).val(t.page),t.pageCount||(t.pageCount=1),$(".pcontrol span",e.toolbar).html(t.pageCount);var i=parseInt((t.page-1)*t.pageSize)+1,l=parseInt(i)+parseInt(t.pageSize)-1;t.total||(t.total=0),t.total<l&&(l=t.total),t.total||(i=l=0),i<0&&(i=0),l<0&&(l=0);var r=t.pageStatMessage;r=r.replace(/{from}/,i),r=r.replace(/{to}/,l),r=r.replace(/{total}/,t.total),r=r.replace(/{pagesize}/,t.pageSize),$(".l-bar-text",e.toolbar).html(r),t.total||$(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",e.toolbar).addClass("l-disabled"),1==t.page?($(".l-bar-btnfirst span",e.toolbar).addClass("l-disabled"),$(".l-bar-btnprev span",e.toolbar).addClass("l-disabled")):t.page>t.pageCount&&t.pageCount>0&&($(".l-bar-btnfirst span",e.toolbar).removeClass("l-disabled"),$(".l-bar-btnprev span",e.toolbar).removeClass("l-disabled")),t.page==t.pageCount?($(".l-bar-btnlast span",e.toolbar).addClass("l-disabled"),$(".l-bar-btnnext span",e.toolbar).addClass("l-disabled")):t.page<t.pageCount&&t.pageCount>0&&($(".l-bar-btnlast span",e.toolbar).removeClass("l-disabled"),$(".l-bar-btnnext span",e.toolbar).removeClass("l-disabled"))},_getRowIdByDomId:function(e){var t=e.split("|"),i=t[2];return i},_getRowByDomId:function(e){return this.records[this._getRowIdByDomId(e)]},_isEditing:function(e){return e.hasClass("l-box-dateeditor")||e.hasClass("l-box-select")},_getSrcElementByEvent:function(e){var t=this,i=e.target||e.srcElement,l=$(i).parents().add(i),r=function(e){for(var t=0,i=l.length;t<i;t++)if("string"==typeof e){if($(l[t]).hasClass(e))return l[t]}else if("object"==typeof e&&l[t]==e)return l[t];return null};if(r("l-grid-editor"))return{editing:!0,editor:r("l-grid-editor")};if(l.index(this.element)==-1)return t._isEditing(l)?{editing:!0}:{out:!0};var n=!1;if(l.hasClass("l-grid-detailpanel")&&t.detailrows)for(var a=0,o=t.detailrows.length;a<o;a++)if(l.index(t.detailrows[a])!=-1){n=!0;break}var s={grid:r("l-panel"),indetail:n,frozen:!!r(t.gridview1[0]),header:r("l-panel-header"),gridheader:r("l-grid-header"),gridbody:r("l-grid-body"),total:r("l-panel-bar-total"),popup:r("l-grid-popup"),toolbar:r("l-panel-bar")};if(s.gridheader&&(s.hrow=r("l-grid-hd-row"),s.hcell=r("l-grid-hd-cell"),s.hcelltext=r("l-grid-hd-cell-text"),s.checkboxall=r("l-grid-hd-cell-checkbox"),s.hcell)){var d=s.hcell.id.split("|")[2];s.column=t._columns[d]}return s.gridbody&&(s.row=r("l-grid-row"),s.cell=r("l-grid-row-cell"),s.checkbox=r("l-grid-row-cell-btn-checkbox"),s.groupbtn=r("l-grid-group-togglebtn"),s.grouprow=r("l-grid-grouprow"),s.detailbtn=r("l-grid-row-cell-detailbtn"),s.detailrow=r("l-grid-detailpanel"),s.totalrow=r("l-grid-totalsummary"),s.totalcell=r("l-grid-totalsummary-cell"),s.rownumberscell=$(s.cell).hasClass("l-grid-row-cell-rownumbers")?s.cell:null,s.detailcell=$(s.cell).hasClass("l-grid-row-cell-detail")?s.cell:null,s.checkboxcell=$(s.cell).hasClass("l-grid-row-cell-checkbox")?s.cell:null,s.treelink=r("l-grid-tree-link"),s.editor=r("l-grid-editor"),s.row&&(s.data=this._getRowByDomId(s.row.id)),s.cell&&(s.editing=$(s.cell).hasClass("l-grid-row-cell-editing")),s.editor&&(s.editing=!0),s.editing&&(s.out=!1)),s.toolbar&&(s.first=r("l-bar-btnfirst"),s.last=r("l-bar-btnlast"),s.next=r("l-bar-btnnext"),s.prev=r("l-bar-btnprev"),s.load=r("l-bar-btnload"),s.button=r("l-bar-button")),s},_setEvent:function(){var e=this,t=this.options;e.grid.bind("mousedown.grid",function(t){e._onMouseDown.call(e,t)}),e.grid.bind("dblclick.grid",function(t){e._onDblClick.call(e,t)}),e.grid.bind("contextmenu.grid",function(t){return e._onContextmenu.call(e,t)}),$(document).bind("mouseup.grid",function(t){e._onMouseUp.call(e,t)}),$(document).bind("click.grid",function(t){e._onClick.call(e,t)}),$(window).bind("resize.grid",function(t){e._onResize.call(e)}),$(document).bind("keydown.grid",function(t){t.ctrlKey&&(e.ctrlKey=!0)}),$(document).bind("keyup.grid",function(t){delete e.ctrlKey}),e.gridbody.bind("scroll.grid",function(){var t=e.gridbody.scrollLeft(),i=e.gridbody.scrollTop();null!=t&&(e.gridheader[0].scrollLeft=t),null!=i&&(e.f.gridbody[0].scrollTop=i),e.endEdit(),e.trigger("SysGridHeightChanged")}),$("select",e.toolbar).change(function(){return!(e.isDataChanged&&"local"!=t.dataAction&&!confirm(t.isContinueByDataChanged))&&(t.newPage=1,t.pageSize=this.value,void e.loadData(t.where))}),$("span.pcontrol :text",e.toolbar).blur(function(t){e.changePage("input")}),$("div.l-bar-button",e.toolbar).hover(function(){$(this).addClass("l-bar-button-over")},function(){$(this).removeClass("l-bar-button-over")}),$.fn.ligerDrag&&t.colDraggable&&(e.colDroptip=$("<div class='l-drag-coldroptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body"),e.gridheader.add(e.f.gridheader).ligerDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(t,i){var l=e._getSrcElementByEvent(i);if(l.hcell&&l.column){var r=$(".l-grid-hd-cell-text:first",l.hcell).html(),n=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");return n.append(r),n}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),e.children[this.id]=this},onStartDrag:function(i,l){if($.isFunction(t.onColStartDrag))return t.onColStartDrag.call(this,e,t,i,l);if(2==l.button)return!1;if(e.colresizing)return!1;this.set("cursor","default");var r=e._getSrcElementByEvent(l);if(!r.hcell||!r.column||r.column.issystem||r.hcelltext)return!1;if($(r.hcell).css("cursor").indexOf("resize")!=-1)return!1;this.draggingColumn=r.column,e.coldragging=!0;var n=e.grid.offset();this.validRange={top:n.top,bottom:n.top+e.gridheader.height(),left:n.left-10,right:n.left+e.grid.width()+10}},onDrag:function(i,l){if(!$.isFunction(t.onColDragging)||t.onColDragging.call(this,e,t,i,l)){this.set("cursor","default");var r=this.draggingColumn;if(!r)return!1;if(e.colresizing)return!1;null==e.colDropIn&&(e.colDropIn=-1);var n=l.pageX,a=l.pageY,o=!1,s=(e.grid.offset(),this.validRange);if(n<s.left||n>s.right||a>s.bottom||a<s.top)return e.colDropIn=-1,e.colDroptip.hide(),void this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no");for(var d in e._columns){var c=e._columns[d];if(r!=c){if(!c.issystem){var u=c.__level==r.__level,h=!!u&&!!o;if(r.frozen!=c.frozen&&(h=!c.frozen),e.colDropIn==-1||e.colDropIn==d){var g=document.getElementById(c.__domid),p=$(g).offset(),f={top:p.top,bottom:p.top+$(g).height(),left:p.left-10,right:p.left+10};if(h){var v=$(g).width();f.left+=v,f.right+=v}if(n>f.left&&n<f.right&&a>f.top&&a<f.bottom){var m=t.headerRowHeight;c.__rowSpan&&(m*=c.__rowSpan),e.colDroptip.css({left:f.left+5,top:f.top-9,height:m+18}).show(),e.colDropIn=d,e.colDropDir=h?"right":"left",this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}e.colDropIn!=-1&&(e.colDropIn=-1,e.colDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no"))}}}else o=!0}}},onStopDrag:function(i,l){if(!$.isFunction(t.onColStopDrag)||t.onColStopDrag.call(this,e,t,i,l)){var r=this.draggingColumn;e.coldragging=!1,e.colDropIn!=-1&&(e.changeCol.ligerDefer(e,0,[r,e.colDropIn,"right"==e.colDropDir]),e.colDropIn=-1),e.colDroptip.hide(),this.set("cursor","default")}}})),$.fn.ligerDrag&&t.rowDraggable&&(e.rowDroptip=$("<div class='l-drag-rowdroptip' style='display:none'></div>").appendTo("body"),e.gridbody.add(e.f.gridbody).ligerDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(i,l){var r=e._getSrcElementByEvent(l);if(r.row){var n=t.draggingMessage.replace(/{count}/,i.draggingRows?i.draggingRows.length:1);t.rowDraggingRender&&(n=t.rowDraggingRender(i.draggingRows,i,e));var a=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+n+"</div>").appendTo("body");return a}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),e.children[this.id]=this},onStartDrag:function(t,i){if(2==i.button)return!1;if(e.colresizing)return!1;if(!e.columns.length)return!1;this.set("cursor","default");var l=e._getSrcElementByEvent(i);if(!l.cell||!l.data||l.checkbox)return!1;var r=l.cell.id.split("|"),n=e._columns[r[r.length-1]];if(!(l.rownumberscell||l.detailcell||l.checkboxcell||n==e.columns[0]))return!1;if(e.enabledCheckbox()){if(this.draggingRows=e.getSelecteds(),!this.draggingRows||!this.draggingRows.length)return!1}else this.draggingRows=[l.data];this.draggingRow=l.data,this.set("cursor","move"),e.rowdragging=!0,this.validRange={top:e.gridbody.offset().top,bottom:e.gridbody.offset().top+e.gridbody.height(),left:e.grid.offset().left-10,right:e.grid.offset().left+e.grid.width()+10}},onDrag:function(i,l){var r=this.draggingRow;if(!r)return!1;var n=this.draggingRows?this.draggingRows:[r];if(e.colresizing)return!1;null==e.rowDropIn&&(e.rowDropIn=-1);var a=l.pageX,o=l.pageY,s=!1,d=this.validRange;if(a<d.left||a>d.right||o>d.bottom||o<d.top)return e.rowDropIn=-1,e.rowDroptip.hide(),void this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");for(var c in e.rows){var u=e.rows[c],h=u.__id;if(r==u&&(s=!0),$.inArray(u,n)==-1){var g=!!s;if(e.rowDropIn==-1||e.rowDropIn==h){var p=e.getRowObj(h),f=$(p).offset(),v={top:f.top-4,bottom:f.top+$(p).height()+4,left:e.grid.offset().left,right:e.grid.offset().left+e.grid.width()};if(a>v.left&&a<v.right&&o>v.top&&o<v.bottom){var m=f.top;g&&(m+=$(p).height()),e.rowDroptip.css({left:v.left,top:m,width:v.right-v.left}).show(),e.rowDropIn=h,e.rowDropDir=g?"bottom":"top",t.tree&&o>v.top+5&&o<v.bottom-5?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),e.rowDroptip.hide(),e.rowDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),e.rowDroptip.show(),e.rowDropInParent=!1);break}e.rowDropIn!=-1&&(e.rowDropIn=-1,e.rowDropInParent=!1,e.rowDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}}}},onStopDrag:function(i,l){var r=this.draggingRows;e.rowdragging=!1;for(var n=0;n<r.length;n++){var a=r[n].children;a&&(r=$.grep(r,function(e,t){var i=$.inArray(e,a)==-1;return i}))}if(e.rowDropIn!=-1){if(t.tree){var o,s;e.rowDropInParent?s=e.getRow(e.rowDropIn):(o=e.getRow(e.rowDropIn),s=e.getParent(o)),e.appendRange(r,s,o,"bottom"!=e.rowDropDir),e.trigger("rowDragDrop",{rows:r,parent:s,near:o,after:"bottom"==e.rowDropDir})}else e.moveRange(r,e.rowDropIn,"bottom"==e.rowDropDir),e.trigger("rowDragDrop",{rows:r,parent:s,near:e.getRow(e.rowDropIn),after:"bottom"==e.rowDropDir});e.rowDropIn=-1}e.rowDroptip.hide(),this.set("cursor","default")}}))},_onRowOver:function(e,t){if(!l.draggable.dragging){var i=this,r=this.options,n=i.getRow(e),a=t?"addClass":"removeClass";i.enabledFrozen()&&$(i.getRowObj(n,!0))[a](r.mouseoverRowCssClass),$(i.getRowObj(n,!1))[a](r.mouseoverRowCssClass)}},_onMouseUp:function(e){var t=this;this.options;if(l.draggable.dragging){var i=t._getSrcElementByEvent(e);i.hcell&&i.column?t.trigger("dragdrop",[{type:"header",column:i.column,cell:i.hcell},e]):i.row&&t.trigger("dragdrop",[{type:"row",record:i.data,row:i.row},e])}},_onMouseDown:function(e){this.options},_onContextmenu:function(e){var t=this,i=this.options,l=t._getSrcElementByEvent(e);if(l.row){if(i.whenRClickToSelect&&t.select(l.data),t.hasBind("contextmenu"))return t.trigger("contextmenu",[{data:l.data,rowindex:l.data.__index,row:l.row},e])}else if(l.hcell){if(!i.allowHideColumn)return!0;var r=$(l.hcell).attr("columnindex");if(void 0==r)return!0;var n=e.pageX-t.body.offset().left+parseInt(t.body[0].scrollLeft);return r==t.columns.length-1&&(n-=50),t.popup.css({left:n,top:t.gridheader.height()+1}),t.popup.toggle(),!1}},_onDblClick:function(e){var t=this,i=(this.options,t._getSrcElementByEvent(e));i.row&&t.trigger("dblClickRow",[i.data,i.data.__id,i.row])},_onClick:function(e){var t=(e.target||e.srcElement,this),i=this.options,l=t._getSrcElementByEvent(e);if(l.out)return t.editor.editing&&!$.ligerui.win.masking&&t.endEdit(),void(i.allowHideColumn&&t.popup.hide());if(!l.indetail&&!l.editing)if(t.editor.editing&&t.endEdit(),i.allowHideColumn&&(l.popup||t.popup.hide()),l.checkboxall){var r=$(l.hrow),n=r.hasClass("l-checked");if(0==t.trigger("beforeCheckAllRow",[!n,t.element]))return!1;n?r.removeClass("l-checked"):r.addClass("l-checked"),t.selected=[];for(var a in t.records)n?t.unselect(t.records[a]):t.select(t.records[a]);t.trigger("checkAllRow",[!n,t.element])}else if(l.hcelltext){var o=$(l.hcelltext).parent().parent();if(!i.enabledSort||!l.column)return;if(0==l.column.isSort)return;if(i.url&&"local"!=i.dataAction&&t.isDataChanged&&!confirm(i.isContinueByDataChanged))return;var s=$(".l-grid-hd-cell-sort:first",o),d=l.column.name;if(!d)return;s.length>0?s.hasClass("l-grid-hd-cell-sort-asc")?(s.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc"),o.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc"),t.trigger("ChangeSort",[d,"desc"]),
t.changeSort(d,"desc")):s.hasClass("l-grid-hd-cell-sort-desc")&&(s.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc"),o.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),t.trigger("ChangeSort",[d,"asc"]),t.changeSort(d,"asc")):(o.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),$(l.hcelltext).after("<span class='l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'>&nbsp;&nbsp;</span>"),t.trigger("ChangeSort",[d,"asc"]),t.changeSort(d,"asc")),$(".l-grid-hd-cell-sort",t.gridheader).add($(".l-grid-hd-cell-sort",t.f.gridheader)).not($(".l-grid-hd-cell-sort:first",o)).remove()}else if(l.detailbtn&&i.detail){var c=l.data,r=$([t.getRowObj(c,!1)]);t.enabledFrozen()&&(r=r.add(t.getRowObj(c,!0)));var a=c.__id;if($(l.detailbtn).hasClass("l-open"))i.detail.onCollapse&&i.detail.onCollapse(c,$(".l-grid-detailpanel-inner:first",u)[0]),r.next("tr.l-grid-detailpanel").hide(),$(l.detailbtn).removeClass("l-open");else{var u=r.next("tr.l-grid-detailpanel");if(u.length>0)return u.show(),i.detail.onExtend&&i.detail.onExtend(c,$(".l-grid-detailpanel-inner:first",u)[0]),$(l.detailbtn).addClass("l-open"),void t.trigger("SysGridHeightChanged");$(l.detailbtn).addClass("l-open");for(var h=0,g=0;g<t.columns.length;g++)t.columns[g].frozen&&h++;var p=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>"),f=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");p.find("div:first").width(t.gridheader.find("div:first").width()-50),p.attr("id",t.id+"|detail|"+a),t.detailrows=t.detailrows||[],t.detailrows.push(p[0]),t.detailrows.push(f[0]);var v=$("div:first",p);v.parent().attr("colSpan",t.columns.length-h),r.eq(0).after(p),h>0&&(f.find("td:first").attr("colSpan",h),r.eq(1).after(f)),i.detail.onShowDetail?(i.detail.onShowDetail(c,v[0],function(){t.trigger("SysGridHeightChanged")}),$("div:first",f).add(v).show().height(i.detail.height||i.detailHeight)):i.detail.render&&(v.append(i.detail.render()),v.show()),t.trigger("SysGridHeightChanged")}}else if(l.groupbtn){var m=$(l.grouprow),b=!0;$(l.groupbtn).hasClass("l-grid-group-togglebtn-close")?($(l.groupbtn).removeClass("l-grid-group-togglebtn-close"),m.hasClass("l-grid-grouprow-last")&&$("td:first",m).width("auto")):(b=!1,$(l.groupbtn).addClass("l-grid-group-togglebtn-close"),m.hasClass("l-grid-grouprow-last")&&$("td:first",m).width(t.gridtablewidth));for(var x=m.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");;){if(0==x.length)break;b?(x.show(),x.hasClass("l-grid-detailpanel")&&!x.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")&&x.hide()):x.hide(),x=x.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel")}t.trigger(b?"groupExtend":"groupCollapse"),t.trigger("SysGridHeightChanged")}else if(l.treelink)t.toggle(l.data);else if(l.row&&t.enabledCheckbox()){var w=!!i.selectRowButtonOnly;if(i.enabledEdit&&(w=!0),l.checkbox||!w){var r=$(l.row),n=r.hasClass("l-selected");if(0==t.trigger("beforeCheckRow",[!n,l.data,l.data.__id,l.row]))return!1;var y=n?"unselect":"select";if(t[y](l.data),i.tree&&i.autoCheckChildren)for(var _=t.getChildren(l.data,!0),g=0,C=_.length;g<C;g++)t[y](_[g]);var D=$("#"+t.id).find(".l-grid-hd-row");n?D.removeClass("l-checked"):t.selected.length==t.rows.length&&D.addClass("l-checked"),t.trigger("checkRow",[!n,l.data,l.data.__id,l.row])}!l.checkbox&&l.cell&&i.enabledEdit&&i.clickToEdit&&t._applyEditor(l.cell)}else if(l.row&&!t.enabledCheckbox())if(l.cell&&i.enabledEdit&&i.clickToEdit&&t._applyEditor(l.cell),$(l.row).hasClass("l-selected")){if(!i.allowUnSelectRow)return void $(l.row).addClass("l-selected-again");t.unselect(l.data)}else t.select(l.data);else if(l.toolbar)if(l.first){if(0==t.trigger("toFirst",[t.element]))return!1;t.changePage("first")}else if(l.prev){if(0==t.trigger("toPrev",[t.element]))return!1;t.changePage("prev")}else if(l.next){if(0==t.trigger("toNext",[t.element]))return!1;t.changePage("next")}else if(l.last){if(0==t.trigger("toLast",[t.element]))return!1;t.changePage("last")}else if(l.load){if($("span",l.load).hasClass("l-disabled"))return!1;if(0==t.trigger("reload",[t.element]))return!1;if(i.url&&t.isDataChanged&&!confirm(i.isContinueByDataChanged))return!1;t.loadData(i.where)}},select:function(e){var t=this,i=(this.options,t.getRow(e)),l=i.__id,r=t.getRowObj(l),n=t.getRowObj(l,!0);if(!t.enabledCheckbox()&&!t.ctrlKey){for(var a in t.selected){var o=t.selected[a];o.__id in t.records&&($(t.getRowObj(o)).removeClass("l-selected l-selected-again"),t.enabledFrozen()&&$(t.getRowObj(o,!0)).removeClass("l-selected l-selected-again"))}t.selected=[]}r&&$(r).addClass("l-selected"),n&&$(n).addClass("l-selected"),t.selected[t.selected.length]=i,t.trigger("selectRow",[i,l,r])},unselect:function(e){var t=this,i=(this.options,t.getRow(e)),l=i.__id,r=t.getRowObj(l),n=t.getRowObj(l,!0);$(r).removeClass("l-selected l-selected-again"),t.enabledFrozen()&&$(n).removeClass("l-selected l-selected-again"),t._removeSelected(i),t.trigger("unSelectRow",[i,l,r])},isSelected:function(e){var t=this,i=(this.options,t.getRow(e));for(var l in t.selected)if(t.selected[l]==i)return!0;return!1},arrayToTree:function(e,t,i){function l(e){return"string"==typeof e&&(e=e.replace(/[.]/g,"").toLowerCase()),e}var r=this.options,n="children";if(r.tree&&(n=r.tree.childrenName),!e||!e.length)return[];for(var a=[],o={},s=e.length,d=0;d<s;d++){var c=e[d],u=l(c[t]);o[u]=c}for(var d=0;d<s;d++){var h=e[d],u=l(h[i]),g=o[u];g?(g[n]=g[n]||[],g[n].push(h)):a.push(h)}return a},_onResize:function(){var e=this,t=this.options;if(t.height&&"auto"!=t.height){var i=$(window).height(),l=0,r=null;if("string"==typeof t.height&&t.height.indexOf("%")>0){var n=e.grid.parent();t.inWindow?(r=i,r-=parseInt($("body").css("paddingTop")),r-=parseInt($("body").css("paddingBottom"))):r=n.height(),l=r*parseFloat(t.height)*.01,(t.inWindow||"body"==n[0].tagName.toLowerCase())&&(l-=e.grid.offset().top-parseInt($("body").css("paddingTop")))}else l=parseInt(t.height);l+=t.heightDiff,e.windowHeight=i,e._setHeight(l)}else e._updateHorizontalScrollStatus.ligerDefer(e,10);if(e.enabledFrozen()){var a=e.gridview1.width(),o=e.gridview.width();e.gridview2.css({width:o-a})}e.trigger("SysGridHeightChanged")}}),$.ligerui.controls.Grid.prototype.enabledTotal=$.ligerui.controls.Grid.prototype.isTotalSummary,$.ligerui.controls.Grid.prototype.add=$.ligerui.controls.Grid.prototype.addRow,$.ligerui.controls.Grid.prototype.update=$.ligerui.controls.Grid.prototype.updateRow,$.ligerui.controls.Grid.prototype.append=$.ligerui.controls.Grid.prototype.appendRow,$.ligerui.controls.Grid.prototype.getSelected=$.ligerui.controls.Grid.prototype.getSelectedRow,$.ligerui.controls.Grid.prototype.getSelecteds=$.ligerui.controls.Grid.prototype.getSelectedRows,$.ligerui.controls.Grid.prototype.getCheckedRows=$.ligerui.controls.Grid.prototype.getSelectedRows,$.ligerui.controls.Grid.prototype.getCheckedRowObjs=$.ligerui.controls.Grid.prototype.getSelectedRowObjs,$.ligerui.controls.Grid.prototype.setOptions=$.ligerui.controls.Grid.prototype.set,$.ligerui.controls.Grid.prototype.reload=$.ligerui.controls.Grid.prototype.loadData,$.ligerui.controls.Grid.prototype.refreshSize=$.ligerui.controls.Grid.prototype._onResize}(jQuery),function(e){e.fn.ligerLayout=function(t){return e.ligerui.run.call(this,"ligerLayout",arguments)},e.fn.ligerGetLayoutManager=function(){return e.ligerui.run.call(this,"ligerGetLayoutManager",arguments)},e.ligerDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,InWindow:!0,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:!1,isRightCollapse:!1,allowLeftCollapse:!0,allowRightCollapse:!0,allowLeftResize:!0,allowRightResize:!0,allowTopResize:!0,allowBottomResize:!0,space:3,onEndResize:null,minLeftWidth:80,minRightWidth:80},e.ligerMethos.Layout={},e.ligerui.controls.Layout=function(t,i){e.ligerui.controls.Layout.base.constructor.call(this,t,i)},e.ligerui.controls.Layout.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return e.ligerMethos.Layout},_render:function(){var t=this,i=this.options;if(t.layout=e(this.element),t.layout.addClass("l-layout"),t.width=t.layout.width(),e("> div[position=top]",t.layout).length>0&&(t.top=e("> div[position=top]",t.layout).wrap('<div class="l-layout-top" style="top:0px;"></div>').parent(),t.top.content=e("> div[position=top]",t.top),t.top.content.hasClass("l-layout-content")||t.top.content.addClass("l-layout-content"),t.topHeight=i.topHeight,t.topHeight&&t.top.height(t.topHeight)),e("> div[position=bottom]",t.layout).length>0){t.bottom=e("> div[position=bottom]",t.layout).wrap('<div class="l-layout-bottom"></div>').parent(),t.bottom.content=e("> div[position=bottom]",t.bottom),t.bottom.content.hasClass("l-layout-content")||t.bottom.content.addClass("l-layout-content"),t.bottomHeight=i.bottomHeight,t.bottomHeight&&t.bottom.height(t.bottomHeight);var l=t.bottom.content.attr("title");l&&(t.bottom.header=e('<div class="l-layout-header"></div>'),t.bottom.prepend(t.bottom.header),t.bottom.header.html(l),t.bottom.content.attr("title",""))}if(e("> div[position=left]",t.layout).length>0){t.left=e("> div[position=left]",t.layout).wrap('<div class="l-layout-left" style="left:0px;"></div>').parent(),t.left.header=e('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>'),t.left.prepend(t.left.header),t.left.header.toggle=e(".l-layout-header-toggle",t.left.header),t.left.content=e("> div[position=left]",t.left),t.left.content.hasClass("l-layout-content")||t.left.content.addClass("l-layout-content"),i.allowLeftCollapse||e(".l-layout-header-toggle",t.left.header).remove();var r=t.left.content.attr("title");r&&(t.left.content.attr("title",""),e(".l-layout-header-inner",t.left.header).html(r)),t.leftWidth=i.leftWidth,t.leftWidth&&t.left.width(t.leftWidth)}if(e("> div[position=center]",t.layout).length>0){t.center=e("> div[position=center]",t.layout).wrap('<div class="l-layout-center" ></div>').parent(),t.center.content=e("> div[position=center]",t.center),t.center.content.addClass("l-layout-content");var n=t.center.content.attr("title");n&&(t.center.content.attr("title",""),t.center.header=e('<div class="l-layout-header"></div>'),t.center.prepend(t.center.header),t.center.header.html(n)),t.centerWidth=i.centerWidth,t.centerWidth&&t.center.width(t.centerWidth)}if(e("> div[position=right]",t.layout).length>0){t.right=e("> div[position=right]",t.layout).wrap('<div class="l-layout-right"></div>').parent(),t.right.header=e('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>'),t.right.prepend(t.right.header),t.right.header.toggle=e(".l-layout-header-toggle",t.right.header),i.allowRightCollapse||e(".l-layout-header-toggle",t.right.header).remove(),t.right.content=e("> div[position=right]",t.right),t.right.content.hasClass("l-layout-content")||t.right.content.addClass("l-layout-content");var a=t.right.content.attr("title");a&&(t.right.content.attr("title",""),e(".l-layout-header-inner",t.right.header).html(a)),t.rightWidth=i.rightWidth,t.rightWidth&&t.right.width(t.rightWidth)}t.layout.lock=e("<div class='l-layout-lock'></div>"),t.layout.append(t.layout.lock),t._addDropHandle(),t.isLeftCollapse=i.isLeftCollapse,t.isRightCollapse=i.isRightCollapse,t.leftCollapse=e('<div class="l-layout-collapse-left" style="display: none; "><div class="l-layout-collapse-left-toggle"></div></div>'),t.rightCollapse=e('<div class="l-layout-collapse-right" style="display: none; "><div class="l-layout-collapse-right-toggle"></div></div>'),t.layout.append(t.leftCollapse).append(t.rightCollapse),t.leftCollapse.toggle=e("> .l-layout-collapse-left-toggle",t.leftCollapse),t.rightCollapse.toggle=e("> .l-layout-collapse-right-toggle",t.rightCollapse),t._setCollapse(),t._bulid(),e(window).resize(function(){t._onResize()}),t.set(i),t.mask.height(t.layout.height())},setLeftCollapse:function(e){var t=this;this.options;return!!t.left&&(t.isLeftCollapse=e,t.isLeftCollapse?(t.leftCollapse.show(),t.leftDropHandle&&t.leftDropHandle.hide(),t.left.hide()):(t.leftCollapse.hide(),t.leftDropHandle&&t.leftDropHandle.show(),t.left.show()),void t._onResize())},setRightCollapse:function(e){var t=this;this.options;return!!t.right&&(t.isRightCollapse=e,t._onResize(),t.isRightCollapse?(t.rightCollapse.show(),t.rightDropHandle&&t.rightDropHandle.hide(),t.right.hide()):(t.rightCollapse.hide(),t.rightDropHandle&&t.rightDropHandle.show(),t.right.show()),void t._onResize())},_bulid:function(){var t=this,i=this.options;e("> .l-layout-left .l-layout-header,> .l-layout-right .l-layout-header",t.layout).hover(function(){e(this).addClass("l-layout-header-over")},function(){e(this).removeClass("l-layout-header-over")}),e(".l-layout-header-toggle",t.layout).hover(function(){e(this).addClass("l-layout-header-toggle-over")},function(){e(this).removeClass("l-layout-header-toggle-over")}),e(".l-layout-header-toggle",t.left).click(function(){t.setLeftCollapse(!0)}),e(".l-layout-header-toggle",t.right).click(function(){t.setRightCollapse(!0)}),t.middleTop=0,t.top&&(t.middleTop+=t.top.height(),t.middleTop+=parseInt(t.top.css("borderTopWidth")),t.middleTop+=parseInt(t.top.css("borderBottomWidth")),t.middleTop+=i.space),t.left&&(t.left.css({top:t.middleTop}),t.leftCollapse.css({top:t.middleTop})),t.center&&t.center.css({top:t.middleTop}),t.right&&(t.right.css({top:t.middleTop}),t.rightCollapse.css({top:t.middleTop})),t.left&&t.left.css({left:0}),t._onResize(),t._onResize()},_setCollapse:function(){var t=this;this.options;t.leftCollapse.hover(function(){e(this).addClass("l-layout-collapse-left-over")},function(){e(this).removeClass("l-layout-collapse-left-over")}),t.leftCollapse.toggle.hover(function(){e(this).addClass("l-layout-collapse-left-toggle-over")},function(){e(this).removeClass("l-layout-collapse-left-toggle-over")}),t.rightCollapse.hover(function(){e(this).addClass("l-layout-collapse-right-over")},function(){e(this).removeClass("l-layout-collapse-right-over")}),t.rightCollapse.toggle.hover(function(){e(this).addClass("l-layout-collapse-right-toggle-over")},function(){e(this).removeClass("l-layout-collapse-right-toggle-over")}),t.leftCollapse.toggle.click(function(){t.setLeftCollapse(!1)}),t.rightCollapse.toggle.click(function(){t.setRightCollapse(!1)}),t.left&&t.isLeftCollapse&&(t.leftCollapse.show(),t.leftDropHandle&&t.leftDropHandle.hide(),t.left.hide()),t.right&&t.isRightCollapse&&(t.rightCollapse.show(),t.rightDropHandle&&t.rightDropHandle.hide(),t.right.hide())},_addDropHandle:function(){var t=this,i=this.options;t.left&&i.allowLeftResize&&(t.leftDropHandle=e("<div class='l-layout-drophandle-left'></div>"),t.layout.append(t.leftDropHandle),t.leftDropHandle&&t.leftDropHandle.show(),t.leftDropHandle.mousedown(function(e){t._start("leftresize",e)})),t.right&&i.allowRightResize&&(t.rightDropHandle=e("<div class='l-layout-drophandle-right'></div>"),t.layout.append(t.rightDropHandle),t.rightDropHandle&&t.rightDropHandle.show(),t.rightDropHandle.mousedown(function(e){t._start("rightresize",e)})),t.top&&i.allowTopResize&&(t.topDropHandle=e("<div class='l-layout-drophandle-top'></div>"),t.layout.append(t.topDropHandle),t.topDropHandle.show(),t.topDropHandle.mousedown(function(e){t._start("topresize",e)})),t.bottom&&i.allowBottomResize&&(t.bottomDropHandle=e("<div class='l-layout-drophandle-bottom'></div>"),t.layout.append(t.bottomDropHandle),t.bottomDropHandle.show(),t.bottomDropHandle.mousedown(function(e){t._start("bottomresize",e)})),t.draggingxline=e("<div class='l-layout-dragging-xline'></div>"),t.draggingyline=e("<div class='l-layout-dragging-yline'></div>"),t.mask=e("<div class='l-dragging-mask'></div>"),t.layout.append(t.draggingxline).append(t.draggingyline).append(t.mask)},_setDropHandlePosition:function(){var e=this,t=this.options;e.leftDropHandle&&e.leftDropHandle.css({left:e.left.width()+parseInt(e.left.css("left")),height:e.middleHeight,top:e.middleTop}),e.rightDropHandle&&e.rightDropHandle.css({left:parseInt(e.right.css("left"))-t.space,height:e.middleHeight,top:e.middleTop}),e.topDropHandle&&e.topDropHandle.css({top:e.top.height()+parseInt(e.top.css("top")),width:e.top.width()}),e.bottomDropHandle&&e.bottomDropHandle.css({top:parseInt(e.bottom.css("top"))-t.space,width:e.bottom.width()})},_onResize:function(){var t=this,i=this.options,l=t.layout.height(),r=0,n=e(window).height(),a=null;if("string"==typeof i.height&&i.height.indexOf("%")>0){var o=t.layout.parent();i.InWindow||"body"==o[0].tagName.toLowerCase()?(a=n,a-=parseInt(e("body").css("paddingTop")),a-=parseInt(e("body").css("paddingBottom"))):a=o.height(),r=a*parseFloat(i.height)*.01,(i.InWindow||"body"==o[0].tagName.toLowerCase())&&(r-=t.layout.offset().top-parseInt(e("body").css("paddingTop")))}else r=parseInt(i.height);if(r+=i.heightDiff,t.layout.height(r),t.layoutHeight=t.layout.height(),t.middleWidth=t.layout.width(),t.middleHeight=t.layout.height(),t.top&&(t.middleHeight-=t.top.height(),t.middleHeight-=parseInt(t.top.css("borderTopWidth")),t.middleHeight-=parseInt(t.top.css("borderBottomWidth")),t.middleHeight-=i.space),t.bottom&&(t.middleHeight-=t.bottom.height(),t.middleHeight-=parseInt(t.bottom.css("borderTopWidth")),t.middleHeight-=parseInt(t.bottom.css("borderBottomWidth")),t.middleHeight-=i.space),t.middleHeight-=2,t.hasBind("heightChanged")&&t.layoutHeight!=l&&t.trigger("heightChanged",[{layoutHeight:t.layoutHeight,diff:t.layoutHeight-l,middleHeight:t.middleHeight}]),t.center){t.centerWidth=t.middleWidth,t.left&&(t.isLeftCollapse?(t.centerWidth-=t.leftCollapse.width(),t.centerWidth-=parseInt(t.leftCollapse.css("borderLeftWidth")),t.centerWidth-=parseInt(t.leftCollapse.css("borderRightWidth")),t.centerWidth-=parseInt(t.leftCollapse.css("left")),t.centerWidth-=i.space):(t.centerWidth-=t.leftWidth,t.centerWidth-=parseInt(t.left.css("borderLeftWidth")),t.centerWidth-=parseInt(t.left.css("borderRightWidth")),t.centerWidth-=parseInt(t.left.css("left")),t.centerWidth-=i.space)),t.right&&(t.isRightCollapse?(t.centerWidth-=t.rightCollapse.width(),t.centerWidth-=parseInt(t.rightCollapse.css("borderLeftWidth")),t.centerWidth-=parseInt(t.rightCollapse.css("borderRightWidth")),t.centerWidth-=parseInt(t.rightCollapse.css("right")),t.centerWidth-=i.space):(t.centerWidth-=t.rightWidth,t.centerWidth-=parseInt(t.right.css("borderLeftWidth")),t.centerWidth-=parseInt(t.right.css("borderRightWidth")),t.centerWidth-=i.space)),t.centerLeft=0,t.left&&(t.isLeftCollapse?(t.centerLeft+=t.leftCollapse.width(),t.centerLeft+=parseInt(t.leftCollapse.css("borderLeftWidth")),t.centerLeft+=parseInt(t.leftCollapse.css("borderRightWidth")),t.centerLeft+=parseInt(t.leftCollapse.css("left")),t.centerLeft+=i.space):(t.centerLeft+=t.left.width(),t.centerLeft+=parseInt(t.left.css("borderLeftWidth")),t.centerLeft+=parseInt(t.left.css("borderRightWidth")),t.centerLeft+=i.space)),t.center.css({left:t.centerLeft}),t.center.width(t.centerWidth),t.center.height(t.middleHeight);var s=t.middleHeight;t.center.header&&(s-=t.center.header.height()),t.center.content.height(s)}t.left&&(t.leftCollapse.height(t.middleHeight),t.left.height(t.middleHeight),t.left.content.height(t.left.height()-t.left.header.height()-3),t.left.content.css("overflow","auto"),t.left.content.css("overflow-y","auto")),t.right&&(t.rightCollapse.height(t.middleHeight),t.right.height(t.middleHeight),t.rightLeft=0,t.left&&(t.isLeftCollapse?(t.rightLeft+=t.leftCollapse.width(),t.rightLeft+=parseInt(t.leftCollapse.css("borderLeftWidth")),t.rightLeft+=parseInt(t.leftCollapse.css("borderRightWidth")),t.rightLeft+=i.space):(t.rightLeft+=t.left.width(),t.rightLeft+=parseInt(t.left.css("borderLeftWidth")),t.rightLeft+=parseInt(t.left.css("borderRightWidth")),t.rightLeft+=parseInt(t.left.css("left")),t.rightLeft+=i.space)),t.center&&(t.rightLeft+=t.center.width(),t.rightLeft+=parseInt(t.center.css("borderLeftWidth")),t.rightLeft+=parseInt(t.center.css("borderRightWidth")),t.rightLeft+=i.space),t.right.css({left:t.rightLeft})),t.bottom&&(t.bottomTop=t.layoutHeight-t.bottom.height()-2,t.bottom.css({top:t.bottomTop})),t._setDropHandlePosition()},_start:function(t,i){var l=this;this.options;if(l.dragtype=t,"leftresize"==t||"rightresize"==t)l.xresize={startX:i.pageX},l.draggingyline.css({left:i.pageX-l.layout.offset().left,height:l.middleHeight,top:l.middleTop}).show(),e("body").css("cursor","col-resize"),l.mask.height(l.layout.height()).removeClass("l-layout-ymask").addClass("l-layout-xmask").show();else{if("topresize"!=t&&"bottomresize"!=t)return;l.yresize={startY:i.pageY},l.draggingxline.css({top:i.pageY-l.layout.offset().top,width:l.layout.width()}).show(),e("body").css("cursor","row-resize"),l.mask.height(l.layout.height()).removeClass("l-layout-xmask").addClass("l-layout-ymask").show()}l.layout.lock.width(l.layout.width()),l.layout.lock.height(l.layout.height()),l.layout.lock.show(),(e.browser.msie||e.browser.safari)&&e("body").bind("selectstart",function(){return!1}),e(document).bind("mouseup",function(){l._stop.apply(l,arguments)}),e(document).bind("mousemove",function(){l._drag.apply(l,arguments)})},_drag:function(t){var i=this;this.options;i.xresize?(i.xresize.diff=t.pageX-i.xresize.startX,i.draggingyline.css({left:t.pageX-i.layout.offset().left}),e("body").css("cursor","col-resize")):i.yresize&&(i.yresize.diff=t.pageY-i.yresize.startY,i.draggingxline.css({top:t.pageY-i.layout.offset().top}),e("body").css("cursor","row-resize"))},_stop:function(t){var i,l=this,r=this.options;if(l.xresize&&void 0!=l.xresize.diff){if(i=l.xresize.diff,"leftresize"==l.dragtype){if(r.minLeftWidth&&l.leftWidth+l.xresize.diff<r.minLeftWidth)return;l.leftWidth+=l.xresize.diff,l.left.width(l.leftWidth),l.center?l.center.width(l.center.width()-l.xresize.diff).css({left:parseInt(l.center.css("left"))+l.xresize.diff}):l.right&&l.right.width(l.left.width()-l.xresize.diff).css({left:parseInt(l.right.css("left"))+l.xresize.diff})}else if("rightresize"==l.dragtype){if(r.minRightWidth&&l.rightWidth-l.xresize.diff<r.minRightWidth)return;l.rightWidth-=l.xresize.diff,l.right.width(l.rightWidth).css({left:parseInt(l.right.css("left"))+l.xresize.diff}),l.center?l.center.width(l.center.width()+l.xresize.diff):l.left&&l.left.width(l.left.width()+l.xresize.diff)}}else l.yresize&&void 0!=l.yresize.diff&&(i=l.yresize.diff,"topresize"==l.dragtype?(l.top.height(l.top.height()+l.yresize.diff),l.middleTop+=l.yresize.diff,l.middleHeight-=l.yresize.diff,l.left&&(l.left.css({top:l.middleTop}).height(l.middleHeight),l.leftCollapse.css({top:l.middleTop}).height(l.middleHeight)),l.center&&l.center.css({top:l.middleTop}).height(l.middleHeight),l.right&&(l.right.css({top:l.middleTop}).height(l.middleHeight),l.rightCollapse.css({top:l.middleTop}).height(l.middleHeight))):"bottomresize"==l.dragtype&&(l.bottom.height(l.bottom.height()-l.yresize.diff),l.middleHeight+=l.yresize.diff,l.bottomTop+=l.yresize.diff,l.bottom.css({top:l.bottomTop}),l.left&&(l.left.height(l.middleHeight),l.leftCollapse.height(l.middleHeight)),l.center&&l.center.height(l.middleHeight),l.right&&(l.right.height(l.middleHeight),l.rightCollapse.height(l.middleHeight))));l.trigger("endResize",[{direction:l.dragtype?l.dragtype.replace(/resize/,""):"",diff:i},t]),l._setDropHandlePosition(),l.draggingxline.hide(),l.draggingyline.hide(),l.mask.hide(),l.xresize=l.yresize=l.dragtype=!1,l.layout.lock.hide(),(e.browser.msie||e.browser.safari)&&e("body").unbind("selectstart"),e(document).unbind("mousemove",l._drag),e(document).unbind("mouseup",l._stop),e("body").css("cursor","")}})}(jQuery),function(e){e.fn.ligerListBox=function(t){return e.ligerui.run.call(this,"ligerListBox",arguments)},e.ligerDefaults.ListBox={isMultiSelect:!1,isShowCheckBox:!1,columns:null,width:150,height:100,onSelect:!1,onSelected:null,valueField:"id",textField:"text",valueFieldID:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,render:null,css:null,value:null,valueFieldCssClass:null},e.ligerMethos.ListBox=e.ligerMethos.ListBox||{},e.ligerui.controls.ListBox=function(t,i){e.ligerui.controls.ListBox.base.constructor.call(this,t,i)},e.ligerui.controls.ListBox.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"ListBox"},_extendMethods:function(){return e.ligerMethos.ListBox},_init:function(){e.ligerui.controls.ListBox.base._init.call(this)},_render:function(){var t=this,i=this.options;t.data=i.data,t.valueField=null,i.valueFieldID?(t.valueField=e("#"+i.valueFieldID+":input,[name="+i.valueFieldID+"]:input"),0==t.valueField.length&&(t.valueField=e('<input type="hidden"/>')),t.valueField[0].id=t.valueField[0].name=i.valueFieldID):(t.valueField=e('<input type="hidden"/>'),t.valueField[0].id=t.valueField[0].name=t.id+"_val"),null==t.valueField[0].name&&(t.valueField[0].name=t.valueField[0].id),i.valueFieldCssClass&&t.valueField.addClass(i.valueFieldCssClass),t.valueField.attr("data-ligerid",t.id),t.selectBox=e(this.element),t.selectBox.html('<div class="l-listbox-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-listbox-table"></table></div>').addClass("l-listbox").append(t.valueField),t.selectBox.table=e("table:first",t.selectBox),t.set(i),t._addClickEven()},destroy:function(){this.selectBox&&this.selectBox.remove(),this.options=null,e.ligerui.remove(this)},clear:function(){this._changeValue(""),this.trigger("clear")},_setIsShowCheckBox:function(t){t?e("table",this.selectBox).addClass("l-table-checkbox"):e("table",this.selectBox).addClass("l-table-nocheckbox")},_setCss:function(e){e&&this.selectBox.addClass(e)},_setDisabled:function(e){e?this.selectBox.addClass("l-text-disabled"):this.selectBox.removeClass("l-text-disabled")},_setWidth:function(e){this.selectBox.width(e)},_setHeight:function(e){this.selectBox.height(e)},findTextByValue:function(t){var i=this,l=this.options;if(null==t)return"";var r="",n=function(e){for(var i=t.toString().split(l.split),r=0;r<i.length;r++)if(i[r]==e)return!0;return!1};return e(i.data).each(function(e,t){var i=t[l.valueField],a=t[l.textField];n(i)&&(r+=a+l.split)}),r.length>0&&(r=r.substr(0,r.length-1)),r},getDataByValue:function(e){for(var t=this,i=this.options,l=0,r=t.data.length;l<r;l++)if(t.data[l][i.valueField]==e)return t.data[l];return null},indexOf:function(e){var t=this,i=this.options;if(!t.data)return-1;for(var l="object"==typeof e,r=0,n=t.data.length;r<n;r++)if(l){if(t.data[r]==e)return r}else if(t.data[r][i.valueField]&&t.data[r][i.valueField].toString()==e.toString())return r;return-1},removeItems:function(t){var i=this;i.data&&(e(t).each(function(e,t){var l=i.indexOf(t);l!=-1&&i.data.splice(l,1)}),i.refresh())},removeItem:function(e){if(this.data){var t=this.indexOf(e);t!=-1&&(this.data.splice(t,1),this.refresh())}},insertItem:function(e,t){var i=this;i.data||(i.data=[]),i.data.splice(t,0,e),i.refresh()},addItems:function(t){var i=this;i.data||(i.data=[]),e(t).each(function(e,t){i.data.push(t)}),i.refresh()},addItem:function(e){var t=this;t.data||(t.data=[]),t.data.push(e),t.refresh()},getSelectedItems:function(){var t=this,i=this.options;if(!t.data)return null;var l=t.getValue();if(!l)return null;var r=[];return e(l.split(i.split)).each(function(){var e=t.indexOf(this.toString());e!=-1&&r.push(t.data[e])}),r},_setValue:function(e){var t=this.options;t.value=e,this._dataInit()},setValue:function(e){this._setValue(e)},_setUrl:function(t){if(t){var i=this,l=this.options;e.ajax({type:"post",url:t,data:l.parms,cache:!1,dataType:"json",success:function(e){i.setData(e),i.trigger("success",[e])},error:function(e,t){i.trigger("error",[e,t])}})}},setUrl:function(e){return this._setUrl(e)},setParm:function(e,t){if(e){var i=this,l=i.get("parms");l||(l={}),l[e]=t,i.set("parms",l)}},clearContent:function(){var t=this;this.options;e("table",t.selectBox).html("")},_setColumns:function(e){var t=this,i=this.options;i.columns=e,t.refresh()},_setData:function(e){this.setData(e)},setData:function(e){var t=this;this.options;e&&e.length&&(t.data=e,t.refresh(),t.updateStyle())},refresh:function(){var t=this,i=this.options,l=this.data;if(this.clearContent(),l){if(i.columns){t.selectBox.table.headrow=e("<tr class='l-table-headerow'><td width='18px' class='l-checkboxrow'></td></tr>"),t.selectBox.table.append(t.selectBox.table.headrow),t.selectBox.table.addClass("l-listbox-grid");for(var r=0;r<i.columns.length;r++){var n=e("<td columnindex='"+r+"' columnname='"+i.columns[r].name+"'>"+i.columns[r].header+"</td>");i.columns[r].width&&n.width(i.columns[r].width),t.selectBox.table.headrow.append(n)}}for(var a=[],o=0;o<l.length;o++){var s=l[o][i.valueField],d=l[o][i.textField],c=" value='"+s+"' index='"+o+"'";if(i.columns){a.push("<tr "+c+"><td style='width:18px;' class='l-checkboxrow'><input type='checkbox' "+c+"/></td>");for(var r=0;r<i.columns.length;r++){var u=i.columns[r].name;a.push("<td>"+l[o][u]+"</td>")}a.push("</tr>")}else{a.push("<tr "+c+">"),a.push("<td style='width:18px;' class='l-checkboxrow'><input type='checkbox'"+c+"/></td>");var h=d;i.render&&(h=i.render({data:l[o],value:s,text:d})),a.push("<td align='left'>"+h+"</td></tr>")}}t.selectBox.table.append(a.join(""))}},_getValue:function(){return e(this.valueField).val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},selectAll:function(){var t=this,i=this.options,l=[];e("tr",t.selectBox).each(function(){var t=e(this);l.push(t.attr("value"))}),e("tr",t.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=!0}),t.valueField.val(l.join(i.split))},_dataInit:function(){var t=this,i=this.options,l=i.value;null!=l?t._changeValue(l):""!=t.valueField.val()&&(i.value=t.valueField.val());var r=(l||"").toString().split(i.split);e("tr.l-selected",t.selectBox).removeClass("l-selected").find(":checkbox").each(function(){this.checked=!1}),e(r).each(function(i,l){e("tr[value='"+l+"']",t.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=!0})})},_changeValue:function(e){var t=this;this.options;t.valueField.val(e),t.selectedValue=e},_updateValue:function(){var t=this,i=this.options,l=[];e("tr",t.selectBox).each(function(){var t=e(this);t.hasClass("l-selected")&&l.push(t.attr("value"))}),t._changeValue(l.join(i.split))},_addClickEven:function(){var t=this,i=this.options;t.selectBox.click(function(l){var r=l.target||l.srcElement,n=e(r).parents("tr:first");if(n.length){var a=n.attr("value"),o=t.findTextByValue(a),s=t.getDataByValue(a);if(t.hasBind("select")&&0==t.trigger("select",[a,o,s]))return!1;i.isMultiSelect||e("tr.l-selected",t.selectBox).not(n).removeClass("l-selected").find(":checkbox").each(function(){this.checked=!1}),n.hasClass("l-selected")?n.removeClass("l-selected"):n.addClass("l-selected"),n.find(":checkbox").each(function(){this.checked=n.hasClass("l-selected")}),t._updateValue(),t.trigger("selected",[a,o,s])}})}})}(jQuery),function(e){e.ligerMenu=function(t){return e.ligerui.run.call(null,"ligerMenu",arguments)},e.ligerDefaults.Menu={width:120,top:0,left:0,items:null,shadow:!0},e.ligerMethos.Menu={},e.ligerui.controls.Menu=function(t){e.ligerui.controls.Menu.base.constructor.call(this,null,t)},e.ligerui.controls.Menu.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Menu"},__idPrev:function(){return"Menu"},_extendMethods:function(){return e.ligerMethos.Menu},_render:function(){var t=this,i=this.options;t.menuItemCount=0,t.menus={},t.menu=t.createMenu(),t.element=t.menu[0],t.menu.css({top:i.top,left:i.left,width:e.ligerDefaults.Menu.width}),i.items&&e(i.items).each(function(e,i){t.addItem(i)}),e(document).bind("click.menu",function(){for(var e in t.menus){var i=t.menus[e];if(!i)return;i.hide(),i.shadow&&i.shadow.hide()}}),t.set(i)},show:function(e,t){var i=this;this.options;void 0==t&&(t=i.menu),e&&void 0!=e.left&&t.css({left:e.left}),e&&void 0!=e.top&&t.css({top:e.top
}),t.show(),i.updateShadow(t)},updateShadow:function(e){var t=this.options;t.shadow&&(e.shadow.css({left:e.css("left"),top:e.css("top"),width:e.outerWidth(),height:e.outerHeight()}),e.is(":visible")?e.shadow.show():e.shadow.hide())},hide:function(e){var t=this;this.options;void 0==e&&(e=t.menu),t.hideAllSubMenu(e),e.hide(),t.updateShadow(e)},toggle:function(){var e=this;this.options;e.menu.toggle(),e.updateShadow(e.menu)},removeItem:function(t){var i=this;this.options;e("> .l-menu-item[menuitemid="+t+"]",i.menu.items).remove()},setEnabled:function(t){var i=this;this.options;e("> .l-menu-item[menuitemid="+t+"]",i.menu.items).removeClass("l-menu-item-disable")},setDisabled:function(t){var i=this;this.options;e("> .l-menu-item[menuitemid="+t+"]",i.menu.items).addClass("l-menu-item-disable")},isEnable:function(t){var i=this;this.options;return!e("> .l-menu-item[menuitemid="+t+"]",i.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){var t=this;this.options;return e("> .l-menu-item",t.menu.items).length},addItem:function(t,i){var l=this,r=this.options;if(t){if(void 0==i&&(i=l.menu),t.line)return void i.items.append('<div class="l-menu-item-line"></div>');var n=e('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>'),a=e("> .l-menu-item",i.items).length;if(i.items.append(n),n.attr("ligeruimenutemid",++l.menuItemCount),t.id&&n.attr("menuitemid",t.id),t.text&&e(">.l-menu-item-text:first",n).html(t.text),t.icon&&n.prepend('<div class="l-menu-item-icon l-icon-'+t.icon+'"></div>'),t.img&&n.prepend('<div class="l-menu-item-icon"><img style="width:16px;height:16px;margin:2px;" src="'+t.img+'" /></div>'),(t.disable||t.disabled)&&n.addClass("l-menu-item-disable"),t.children){n.append('<div class="l-menu-item-arrow"></div>');var o=l.createMenu(n.attr("ligeruimenutemid"));l.menus[n.attr("ligeruimenutemid")]=o,o.width(r.width),o.hover(null,function(){o.showedSubMenu||l.hide(o)}),e(t.children).each(function(){l.addItem(this,o)})}t.click&&n.click(function(){e(this).hasClass("l-menu-item-disable")||t.click(t,a)}),t.dblclick&&n.dblclick(function(){e(this).hasClass("l-menu-item-disable")||t.dblclick(t,a)});var s=e("> .l-menu-over:first",i);n.hover(function(){if(!e(this).hasClass("l-menu-item-disable")){var r=e(this).offset().top,n=r-i.offset().top;if(s.css({top:n}),l.hideAllSubMenu(i),t.children){var a=e(this).attr("ligeruimenutemid");if(!a)return;l.menus[a]&&(l.show({top:r,left:e(this).offset().left+e(this).width()-5},l.menus[a]),i.showedSubMenu=!0)}}},function(){if(!e(this).hasClass("l-menu-item-disable")){var i=e(this).attr("ligeruimenutemid");if(t.children){var i=e(this).attr("ligeruimenutemid");if(!i)return}}})}},hideAllSubMenu:function(t){var i=this;this.options;void 0==t&&(t=i.menu),e("> .l-menu-item",t.items).each(function(){if(e("> .l-menu-item-arrow",this).length>0){var t=e(this).attr("ligeruimenutemid");if(!t)return;i.menus[t]&&i.hide(i.menus[t])}}),t.showedSubMenu=!1},createMenu:function(t){var i=this,l=this.options,r=e('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');return t&&r.attr("ligeruiparentmenuitemid",t),r.items=e("> .l-menu-inner:first",r),r.appendTo("body"),l.shadow&&(r.shadow=e('<div class="l-menu-shadow"></div>').insertAfter(r),i.updateShadow(r)),r.hover(null,function(){r.showedSubMenu||e("> .l-menu-over:first",r).css({top:-24})}),t?i.menus[t]=r:i.menus[0]=r,r}}),e.ligerui.controls.Menu.prototype.setEnable=e.ligerui.controls.Menu.prototype.setEnabled,e.ligerui.controls.Menu.prototype.setDisable=e.ligerui.controls.Menu.prototype.setDisabled}(jQuery),function(e){e.fn.ligerMenuBar=function(t){return e.ligerui.run.call(this,"ligerMenuBar",arguments)},e.fn.ligerGetMenuBarManager=function(){return e.ligerui.run.call(this,"ligerGetMenuBarManager",arguments)},e.ligerDefaults.MenuBar={},e.ligerMethos.MenuBar={},e.ligerui.controls.MenuBar=function(t,i){e.ligerui.controls.MenuBar.base.constructor.call(this,t,i)},e.ligerui.controls.MenuBar.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return e.ligerMethos.MenuBar},_render:function(){var t=this,i=this.options;t.menubar=e(this.element),t.menubar.hasClass("l-menubar")||t.menubar.addClass("l-menubar"),i&&i.items&&e(i.items).each(function(e,i){t.addItem(i)}),e(document).click(function(){e(".l-panel-btn-selected",t.menubar).removeClass("l-panel-btn-selected")}),t.set(i)},addItem:function(t){var i=this,l=(this.options,e('<div class="l-menubar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div><div class="l-menubar-item-down"></div></div>'));if(i.menubar.append(l),t.id&&l.attr("menubarid",t.id),t.text&&e("span:first",l).html(t.text),t.disable&&l.addClass("l-menubar-item-disable"),t.click&&l.click(function(){t.click(t)}),t.menu){var r=e.ligerMenu(t.menu);l.hover(function(){i.actionMenu&&i.actionMenu.hide();var t=e(this).offset().left,l=e(this).offset().top+e(this).height();r.show({top:l,left:t}),i.actionMenu=r,e(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){e(this).removeClass("l-panel-btn-over")})}else l.hover(function(){e(this).addClass("l-panel-btn-over")},function(){e(this).removeClass("l-panel-btn-over")}),e(".l-menubar-item-down",l).remove()}})}(jQuery),function(e){e.ligerMessageBox=function(t){return e.ligerui.run.call(null,"ligerMessageBox",arguments,{isStatic:!0})},e.ligerDefaults.MessageBox={isDrag:!0},e.ligerMethos.MessageBox={},e.ligerui.controls.MessageBox=function(t){e.ligerui.controls.MessageBox.base.constructor.call(this,null,t)},e.ligerui.controls.MessageBox.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return e.ligerMethos.MessageBox},_render:function(){var t=this,i=this.options,l="";l+='<div class="l-messagebox">',l+='        <div class="l-messagebox-lt"></div><div class="l-messagebox-rt"></div>',l+='        <div class="l-messagebox-l"></div><div class="l-messagebox-r"></div> ',l+='        <div class="l-messagebox-image"></div>',l+='        <div class="l-messagebox-title">',l+='            <div class="l-messagebox-title-inner"></div>',l+='            <div class="l-messagebox-close"></div>',l+="        </div>",l+='        <div class="l-messagebox-content">',l+="        </div>",l+='        <div class="l-messagebox-buttons"><div class="l-messagebox-buttons-inner">',l+="        </div></div>",l+="    </div>",t.messageBox=e(l),e("body").append(t.messageBox),t.messageBox.close=function(){t._removeWindowMask(),t.messageBox.remove()},i.width&&t.messageBox.width(i.width),i.title&&e(".l-messagebox-title-inner",t.messageBox).html(i.title),i.content&&e(".l-messagebox-content",t.messageBox).html(i.content),i.buttons&&(e(i.buttons).each(function(i,l){var r=e('<div class="l-messagebox-btn"><div class="l-messagebox-btn-l"></div><div class="l-messagebox-btn-r"></div><div class="l-messagebox-btn-inner"></div></div>');e(".l-messagebox-btn-inner",r).html(l.text),e(".l-messagebox-buttons-inner",t.messageBox).append(r),l.width&&r.width(l.width),l.onclick&&r.click(function(){l.onclick(l,i,t.messageBox)})}),e(".l-messagebox-buttons-inner",t.messageBox).append("<div class='l-clear'></div>"));var r=t.messageBox.width(),n=0;e(".l-messagebox-buttons-inner .l-messagebox-btn",t.messageBox).each(function(){n+=e(this).width()}),e(".l-messagebox-buttons-inner",t.messageBox).css({marginLeft:parseInt(.5*(r-n))}),t._applyWindowMask(),t._applyDrag(),t._setImage();var a=0,o=0,s=i.width||t.messageBox.width();null!=i.left?a=i.left:i.left=a=.5*(e(window).width()-s),null!=i.top?o=i.top:i.top=o=.5*(e(window).height()-t.messageBox.height())+e(window).scrollTop()-10,a<0&&(i.left=a=0),o<0&&(i.top=o=0),t.messageBox.css({left:a,top:o}),e(".l-messagebox-btn",t.messageBox).hover(function(){e(this).addClass("l-messagebox-btn-over")},function(){e(this).removeClass("l-messagebox-btn-over")}),e(".l-messagebox-close",t.messageBox).hover(function(){e(this).addClass("l-messagebox-close-over")},function(){e(this).removeClass("l-messagebox-close-over")}).click(function(){t.messageBox.close()}),t.set(i)},close:function(){this.options;this.g._removeWindowMask(),this.messageBox.remove()},_applyWindowMask:function(){this.options;e(".l-window-mask").remove(),e("<div class='l-window-mask' style='display: block;'></div>").appendTo(e("body"))},_removeWindowMask:function(){this.options;e(".l-window-mask").remove()},_applyDrag:function(){var t=this,i=this.options;i.isDrag&&e.fn.ligerDrag&&t.messageBox.ligerDrag({handler:".l-messagebox-title-inner",animate:!1})},_setImage:function(){var t=this,i=this.options;i.type&&("success"==i.type||"donne"==i.type?(e(".l-messagebox-image",t.messageBox).addClass("l-messagebox-image-donne").show(),e(".l-messagebox-content",t.messageBox).css({paddingLeft:64,paddingBottom:30})):"error"==i.type?(e(".l-messagebox-image",t.messageBox).addClass("l-messagebox-image-error").show(),e(".l-messagebox-content",t.messageBox).css({paddingLeft:64,paddingBottom:30})):"warn"==i.type?(e(".l-messagebox-image",t.messageBox).addClass("l-messagebox-image-warn").show(),e(".l-messagebox-content",t.messageBox).css({paddingLeft:64,paddingBottom:30})):"question"==i.type&&(e(".l-messagebox-image",t.messageBox).addClass("l-messagebox-image-question").show(),e(".l-messagebox-content",t.messageBox).css({paddingLeft:64,paddingBottom:40})))}}),e.ligerMessageBox.show=function(t){return e.ligerMessageBox(t)},e.ligerMessageBox.alert=function(t,i,l,r){t=t||"",i=i||t;var n=function(e,t,i){i.close(),r&&r(e,t,i)};return p={title:t,content:i,buttons:[{text:"确定",onclick:n}]},l&&(p.type=l),e.ligerMessageBox(p)},e.ligerMessageBox.confirm=function(t,i,l){var r=function(e,t,i){i.close(),l&&l(0==t)};return p={type:"question",title:t,content:i,buttons:[{text:"是",onclick:r},{text:"否",onclick:r}]},e.ligerMessageBox(p)},e.ligerMessageBox.success=function(t,i,l){return e.ligerMessageBox.alert(t,i,"success",l)},e.ligerMessageBox.error=function(t,i,l){return e.ligerMessageBox.alert(t,i,"error",l)},e.ligerMessageBox.warn=function(t,i,l){return e.ligerMessageBox.alert(t,i,"warn",l)},e.ligerMessageBox.question=function(t,i){return e.ligerMessageBox.alert(t,i,"question")}}(jQuery),function(e){e.fn.ligerPopupEdit=function(t){return e.ligerui.run.call(this,"ligerPopupEdit",arguments)},e.fn.ligerGetPopupEditManager=function(){return e.ligerui.run.call(this,"ligerGetPopupEditManager",arguments)},e.ligerDefaults.PopupEdit={valueFieldID:null,css:null,onButtonClick:null,nullText:null,disabled:!1,cancelable:!0,width:200,heigth:null,render:null,split:";",grid:null,condition:null,valueField:"id",textField:"text",parms:null,onSelect:null,onSelected:null,valueFieldCssClass:null},e.ligerMethos.PopupEdit=e.ligerMethos.PopupEdit||{},e.ligerui.controls.PopupEdit=function(t,i){e.ligerui.controls.PopupEdit.base.constructor.call(this,t,i)},e.ligerui.controls.PopupEdit.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"PopupEdit"},_extendMethods:function(){return e.ligerMethos.PopupEdit},_init:function(){e.ligerui.controls.PopupEdit.base._init.call(this)},_render:function(){var t=this,i=this.options;t.inputText=null,"input"==this.element.tagName.toLowerCase()&&(this.element.readOnly=!0,t.inputText=e(this.element),t.textFieldID=this.element.id),void 0==t.inputText[0].name&&(t.inputText[0].name=t.textFieldID),t.valueField=null,i.valueFieldID?(t.valueField=e("#"+i.valueFieldID+":input"),0==t.valueField.length&&(t.valueField=e('<input type="hidden"/>')),t.valueField[0].id=t.valueField[0].name=i.valueFieldID):(t.valueField=e('<input type="hidden"/>'),t.valueField[0].id=t.valueField[0].name=t.textFieldID+"_val"),void 0==t.valueField[0].name&&(t.valueField[0].name=t.valueField[0].id),i.valueFieldCssClass&&t.valueField.addClass(i.valueFieldCssClass),t.link=e('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),t.wrapper=t.inputText.wrap('<div class="l-text l-text-popup"></div>').parent(),t.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),t.wrapper.append(t.link),t.wrapper.append(t.valueField),t.inputText.addClass("l-text-field"),t.link.hover(function(){i.disabled||(this.className="l-trigger-hover")},function(){i.disabled||(this.className="l-trigger")}).mousedown(function(){i.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){i.disabled||(this.className="l-trigger-hover")}).click(function(){if(!i.disabled)return 0!=t.trigger("buttonClick")&&void 0}),t.inputText.click(function(){i.disabled}).blur(function(){i.disabled||t.wrapper.removeClass("l-text-focus")}).focus(function(){i.disabled||t.wrapper.addClass("l-text-focus")}),t.wrapper.hover(function(){i.disabled||t.wrapper.addClass("l-text-over")},function(){i.disabled||t.wrapper.removeClass("l-text-over")}),t.set(i)},destroy:function(){this.wrapper&&this.wrapper.remove(),this.options=null,e.ligerui.remove(this)},clear:function(){var e=this;this.options;e.inputText.val(""),e.valueField.val("")},_setCss:function(e){e&&this.wrapper.addClass(e)},_setCancelable:function(t){var i=this,l=this.options;!t&&i.unselect&&(i.unselect.remove(),i.unselect=null),(t||i.unselect)&&(i.unselect=e('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide(),i.wrapper.hover(function(){i.unselect.show()},function(){i.unselect.hide()}),!l.disabled&&l.cancelable&&i.wrapper.append(i.unselect),i.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){i.clear()}))},_setDisabled:function(e){e?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_setWidth:function(e){var t=this;e>20&&(t.wrapper.css({width:e}),t.inputText.css({width:e-20}))},_setHeight:function(e){var t=this;e>10&&(t.wrapper.height(e),t.inputText.height(e-2))},_getText:function(){return e(this.inputText).val()},_getValue:function(){return e(this.valueField).val()},getValue:function(){return this._getValue()},getText:function(){return this._getText()},setValue:function(e,t){var i=this;this.options;return arguments.length>=2?(i.setValue(e),void i.setText(t)):void i.valueField.val(e)},setText:function(e){var t=this,i=this.options;i.render?t.inputText.val(i.render(e)):t.inputText.val(e)},addValue:function(t,i){var l=this,r=this.options;if(t){var n=l.getValue(),a=l.getText();if(n){for(var o=[],s=[],d=n.split(r.split),t=t.split(r.split),i=i.split(r.split),c=0,u=t.length;c<u;c++)e.inArray(t[c],d)==-1&&(o.push(t[c]),s.push(i[c]));o.length&&(l.setValue(n+r.split+o.join(r.split)),l.setText(a+r.split+s.join(r.split)))}else l.setValue(t),l.setText(i)}},removeValue:function(t,i){var l=this,r=this.options;if(t){var n=l.getValue(),a=l.getText();if(n){for(var o=n.split(r.split),s=a.split(r.split),t=t.split(r.split),d=0,c=-1,u=t.length;d<u;d++)(c=e.inArray(t[d],o))!=-1&&(o.splice(c,1),s.splice(c,1));l.setValue(o.join(r.split)),l.setText(s.join(r.split))}}},_setGrid:function(t){if(t){var i=this,l=this.options,r=e.extend({parms:l.parms},l.grid);this.bind("buttonClick",function(){if(!i.popupFn){var t={grid:r,condition:l.condition,valueField:l.valueField,textField:l.textField,split:l.split,onSelect:function(e){0!=i.trigger("select",e)&&(l.grid.checkbox?(i.addValue(e.value,e.text),i.removeValue(e.remvoeValue,e.remvoeText)):(i.setValue(e.value),i.setText(e.text)),i.trigger("selected",e))},selectInit:function(t){var r=i.getValue();return!!r&&(!(!l.valueField||!t[l.valueField])&&e.inArray(t[l.valueField].toString(),r.split(l.split))!=-1)}};i.popupFn=e.ligerui.getPopupFn(t)}i.popupFn()})}}}),e.ligerui.getPopupFn=function(t){function i(){function i(e){return e=e||t.height,e-=d.height()}if(r)return n._showData(),r.show(),n.refreshSize(),void(o=n.selected.concat());var s=e("<div></div>"),d=e("<div></div>"),c=e("<div></div>");if(s.append(d).append(c),t.condition){var u=e.extend({labelWidth:60,space:20},t.condition);a=d.ligerForm(u)}else d.remove();var h=e.extend({columnWidth:120,alternatingRow:!1,frozen:!0,rownumbers:!0},t.grid,{width:"100%",height:i(),isChecked:t.selectInit,isSelected:t.selectInit,inWindow:!1});if(n=c.ligerGrid(h),t.condition){var g=e('<li style="margin-right:9px"><div></div></li>');e("ul:first",d).append(g).after('<div class="l-clear"></div>'),e("div",g).ligerButton({text:"搜索",click:function(){var t=e.ligerui.getConditions(d);n.setParm("condition",e.ligerui.toJSON(t)),n.reload()}})}r=e.ligerDialog.open({title:t.title,width:t.width,height:"auto",top:t.top,left:t.left,target:s,isResize:!0,cls:"l-selectorwin",onContentHeightChange:function(e){return n.set("height",i(e)),!1},onStopResize:function(){n.refreshSize()},buttons:[{text:"选择",onclick:function(e,t){l(),t.hide()}},{text:"取消",onclick:function(e,t){t.hide()}}]}),n.refreshSize()}function l(){var i=n.selected||[],l=[],r=[],a=[];e(i).each(function(i,o){t.valueField&&l.push(o[t.valueField]),t.textField&&r.push(o[t.textField]);var s=e.extend(!0,{},this);n.formatRecord(s,!0),a.push(s)});var s=[];e(o).each(function(){e.inArray(this,i)==-1&&e.inArray(this,n.rows)!=-1&&s.push(this)});var d=[],c=[],u=[];e(s).each(function(i,l){t.valueField&&d.push(l[t.valueField]),t.textField&&c.push(l[t.textField]);var r=e.extend(!0,{},this);n.formatRecord(r,!0),u.push(r)}),t.onSelect({value:l.join(t.split),text:r.join(t.split),data:a,remvoeValue:d.join(t.split),remvoeText:c.join(t.split),removeData:u})}if(t=e.extend({title:"选择数据",width:700,height:320,top:null,left:null,split:";",valueField:null,textField:null,grid:null,condition:null,onSelect:function(e){},selectInit:function(e){return!1}},t),t.grid){var r,n,a,o=[];return function(){return i(),!1}}}}(jQuery),function(e){e.fn.ligerRadio=function(){return e.ligerui.run.call(this,"ligerRadio",arguments)},e.fn.ligerGetRadioManager=function(){return e.ligerui.run.call(this,"ligerGetRadioManager",arguments)},e.ligerDefaults.Radio={disabled:!1},e.ligerMethos.Radio={},e.ligerui.controls.Radio=function(t,i){e.ligerui.controls.Radio.base.constructor.call(this,t,i)},e.ligerui.controls.Radio.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return e.ligerMethos.Radio},_render:function(){var t=this,i=this.options;t.input=e(this.element),t.link=e('<a href="javascript:void(0)" class="l-radio"></a>'),t.wrapper=t.input.addClass("l-hidden").wrap('<div class="l-radio-wrapper"></div>').parent(),t.wrapper.prepend(t.link),t.input.change(function(){return this.checked?t.link.addClass("l-radio-checked"):t.link.removeClass("l-radio-checked"),!0}),t.link.click(function(){t._doclick()}),t.wrapper.hover(function(){i.disabled||e(this).addClass("l-over")},function(){e(this).removeClass("l-over")}),this.element.checked&&t.link.addClass("l-radio-checked"),this.element.id&&e("label[for="+this.element.id+"]").click(function(){t._doclick()}),t.set(i)},setValue:function(e){var t=this;this.options;e?(t.input[0].checked=!0,t.link.addClass("l-radio-checked")):(t.input[0].checked=!1,t.link.removeClass("l-radio-checked"))},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",!1),this.wrapper.removeClass("l-disabled"),this.options.disabled=!1},setDisabled:function(){this.input.attr("disabled",!0),this.wrapper.addClass("l-disabled"),this.options.disabled=!0},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0),this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")},_doclick:function(){var t=this;this.options;if(t.input.attr("disabled"))return!1;t.input.trigger("click").trigger("change");var i;return i=t.input[0].form?t.input[0].form:document,e("input:radio[name="+t.input[0].name+"]",i).not(t.input).trigger("change"),!1}})}(jQuery),function(e){e.fn.ligerRadioList=function(t){return e.ligerui.run.call(this,"ligerRadioList",arguments)},e.ligerDefaults.RadioList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null},e.ligerMethos.RadioList=e.ligerMethos.RadioList||{},e.ligerui.controls.RadioList=function(t,i){e.ligerui.controls.RadioList.base.constructor.call(this,t,i)},e.ligerui.controls.RadioList.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"RadioList"},_extendMethods:function(){return e.ligerMethos.RadioList},_init:function(){e.ligerui.controls.RadioList.base._init.call(this)},_render:function(){var t=this,i=this.options;t.data=i.data,t.valueField=null,i.valueFieldID?(t.valueField=e("#"+i.valueFieldID+":input,[name="+i.valueFieldID+"]:input"),0==t.valueField.length&&(t.valueField=e('<input type="hidden"/>')),t.valueField[0].id=t.valueField[0].name=i.valueFieldID):(t.valueField=e('<input type="hidden"/>'),t.valueField[0].id=t.valueField[0].name=t.id+"_val"),null==t.valueField[0].name&&(t.valueField[0].name=t.valueField[0].id),i.valueFieldCssClass&&t.valueField.addClass(i.valueFieldCssClass),t.valueField.attr("data-ligerid",t.id),t.radioList=e(this.element),t.radioList.html('<div class="l-radiolist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-radiolist-table"></table></div>').addClass("l-radiolist").append(t.valueField),t.radioList.table=e("table:first",t.radioList),i.value=t.valueField.val()||i.value,t.set(i),t._addClickEven()},destroy:function(){this.radioList&&this.radioList.remove(),this.options=null,e.ligerui.remove(this)},clear:function(){this._changeValue(""),this.trigger("clear")},_setCss:function(e){e&&this.radioList.addClass(e)},_setDisabled:function(t){t?(this.radioList.addClass("l-radiolist-disabled"),e("input:radio",this.radioList).attr("disabled",!0)):(this.radioList.removeClass("l-radiolist-disabled"),e("input:radio",this.radioList).removeAttr("disabled"))},_setWidth:function(e){this.radioList.width(e)},_setHeight:function(e){this.radioList.height(e)},indexOf:function(e){var t=this,i=this.options;if(!t.data)return-1;for(var l=0,r=t.data.length;l<r;l++)if("object"==typeof e){if(t.data[l]==e)return l}else if(t.data[l][i.valueField].toString()==e.toString())return l;return-1},removeItems:function(t){var i=this;i.data&&(e(t).each(function(e,t){var l=i.indexOf(t);l!=-1&&i.data.splice(l,1)}),i.refresh())},removeItem:function(e){if(this.data){var t=this.indexOf(e);t!=-1&&(this.data.splice(t,1),this.refresh())}},insertItem:function(e,t){var i=this;i.data||(i.data=[]),i.data.splice(t,0,e),i.refresh()},addItems:function(t){var i=this;i.data||(i.data=[]),e(t).each(function(e,t){i.data.push(t)}),i.refresh()},addItem:function(e){var t=this;t.data||(t.data=[]),t.data.push(e),t.refresh()},_setValue:function(e){var t=this.options;t.value=e,this._dataInit()},setValue:function(e){this._setValue(e)},_setUrl:function(t){if(t){var i=this,l=this.options;e.ajax({type:"post",url:t,data:l.parms,cache:!1,dataType:"json",success:function(e){i.setData(e),i.trigger("success",[e])},error:function(e,t){i.trigger("error",[e,t])}})}},setUrl:function(e){return this._setUrl(e)},setParm:function(e,t){if(e){var i=this,l=i.get("parms");l||(l={}),l[e]=t,i.set("parms",l)}},clearContent:function(){var t=this;this.options;e("table",t.radioList).html("")},_setData:function(e){this.setData(e)},setData:function(e){var t=this;this.options;e&&e.length&&(t.data=e,t.refresh(),t.updateStyle())},refresh:function(){var e=this,t=this.options,i=this.data;if(this.clearContent(),i){for(var l=[],r=t.rowSize,n=!1,a=t.name||e.id,o=0;o<i.length;o++){var s=i[o][t.valueField],d=i[o][t.textField],c=e.id+"-"+o,u=o%r==0;u&&(n&&l.push("</tr>"),l.push("<tr>"),n=!0),l.push("<td><input type='radio' name='"+a+"' value='"+s+"' id='"+c+"'/><label for='"+c+"'>"+d+"</label></td>")}n&&l.push("</tr>"),e.radioList.table.append(l.join(""))}},_getValue:function(){var t=this,i=this.options,l=i.name||t.id;return e('input:radio[name="'+l+'"]:checked').val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var e=this,t=this.options,i=e.valueField.val()||e._getValue()||t.value;e._changeValue(i)},_changeValue:function(t){var i=this,l=this.options,r=l.name||i.id;e("input:radio[name='"+r+"']",i.radioList).each(function(){this.checked=this.value==t}),i.valueField.val(t),i.selectedValue=t},_addClickEven:function(){var e=this;this.options;e.radioList.click(function(t){var i=e.getValue();i&&e.valueField.val(i)})}})}(jQuery),function(e){e.fn.ligerResizable=function(t){return e.ligerui.run.call(this,"ligerResizable",arguments,{idAttrName:"ligeruiresizableid",hasElement:!1,propertyToElemnt:"target"})},e.fn.ligerGetResizableManager=function(){return e.ligerui.run.call(this,"ligerGetResizableManager",arguments,{idAttrName:"ligeruiresizableid",hasElement:!1,propertyToElemnt:"target"})},e.ligerDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2e3,maxHeight:2e3,minWidth:20,minHeight:20,scope:3,animate:!1,onStartResize:function(e){},onResize:function(e){},onStopResize:function(e){},onEndResize:null},e.ligerui.controls.Resizable=function(t){e.ligerui.controls.Resizable.base.constructor.call(this,null,t)},e.ligerui.controls.Resizable.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var t=this,i=this.options;t.target=e(i.target),t.set(i),t.target.mousemove(function(l){if(!i.disabled&&(t.dir=t._getDir(l),t.dir?t.target.css("cursor",t.dir+"-resize"):t.target.css("cursor").indexOf("-resize")>0&&t.target.css("cursor","default"),i.target.ligeruidragid)){var r=e.ligerui.get(i.target.ligeruidragid);r&&t.dir?r.set("disabled",!0):r&&r.set("disabled",!1)}}).mousedown(function(e){i.disabled||t.dir&&t._start(e)})},_rendered:function(){this.options.target.ligeruiresizableid=this.id},_getDir:function(t){var i=this,l=this.options,r="",n=i.target.offset(),a=i.target.width(),o=i.target.height(),s=l.scope,d=t.pageX||t.screenX,c=t.pageY||t.screenY;return c>=n.top&&c<n.top+s?r+="n":c<=n.top+o&&c>n.top+o-s&&(r+="s"),d>=n.left&&d<n.left+s?r+="w":d<=n.left+a&&d>n.left+a-s&&(r+="e"),"all"==l.handles||""==r?r:e.inArray(r,i.handles)!=-1?r:""},_setHandles:function(e){e&&(this.handles=e.replace(/(\s*)/g,"").split(","))},_createProxy:function(){var t=this;t.proxy=e('<div class="l-resizable"></div>'),t.proxy.width(t.target.width()).height(t.target.height()),t.proxy.attr("resizableid",t.id).appendTo("body")},_removeProxy:function(){var e=this;e.proxy&&(e.proxy.remove(),e.proxy=null)},_start:function(t){var i=this;this.options;i._createProxy(),i.proxy.css({left:i.target.offset().left,top:i.target.offset().top,position:"absolute"}),i.current={dir:i.dir,left:i.target.offset().left,top:i.target.offset().top,startX:t.pageX||t.screenX,startY:t.pageY||t.clientY,width:i.target.width(),height:i.target.height()},e(document).bind("selectstart.resizable",function(){return!1}),e(document).bind("mouseup.resizable",function(){i._stop.apply(i,arguments)}),e(document).bind("mousemove.resizable",function(){i._drag.apply(i,arguments)}),i.proxy.show(),i.trigger("startResize",[i.current,t])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:["w","sw","nw","e","ne","se"],h:["n","ne","nw","s","se","sw"]},_drag:function(e){var t=this;this.options;if(t.current&&t.proxy){t.proxy.css("cursor",""==t.current.dir?"default":t.current.dir+"-resize");var i=e.pageX||e.screenX,l=e.pageY||e.screenY;t.current.diffX=i-t.current.startX,t.current.diffY=l-t.current.startY,t._applyResize(t.proxy),t.trigger("resize",[t.current,e])}},_stop:function(t){var i=this;this.options;i.hasBind("stopResize")?0!=i.trigger("stopResize",[i.current,t])&&i._applyResize():i._applyResize(),i._removeProxy(),i.trigger("endResize",[i.current,t]),e(document).unbind("selectstart.resizable"),e(document).unbind("mousemove.resizable"),e(document).unbind("mouseup.resizable")},_applyResize:function(t){var i=this,l=this.options,r={left:i.current.left,top:i.current.top,width:i.current.width,height:i.current.height},n=!1;t||(t=i.target,n=!0,isNaN(parseInt(i.target.css("top")))?r.top=0:r.top=parseInt(i.target.css("top")),isNaN(parseInt(i.target.css("left")))?r.left=0:r.left=parseInt(i.target.css("left"))),e.inArray(i.current.dir,i.changeBy.l)>-1?(r.left+=i.current.diffX,i.current.diffLeft=i.current.diffX):n&&delete r.left,e.inArray(i.current.dir,i.changeBy.t)>-1?(r.top+=i.current.diffY,i.current.diffTop=i.current.diffY):n&&delete r.top,e.inArray(i.current.dir,i.changeBy.w)>-1?(r.width+=(i.current.dir.indexOf("w")==-1?1:-1)*i.current.diffX,i.current.newWidth=r.width):n&&delete r.width,e.inArray(i.current.dir,i.changeBy.h)>-1?(r.height+=(i.current.dir.indexOf("n")==-1?1:-1)*i.current.diffY,i.current.newHeight=r.height):n&&delete r.height,n&&l.animate?t.animate(r):t.css(r)}})}(jQuery),function(e){e.fn.ligerSpinner=function(){return e.ligerui.run.call(this,"ligerSpinner",arguments)},e.fn.ligerGetSpinnerManager=function(){return e.ligerui.run.call(this,"ligerGetSpinnerManager",arguments)},e.ligerDefaults.Spinner={type:"float",isNegative:!0,decimalplace:2,step:.1,interval:50,onChangeValue:!1,minValue:null,maxValue:null,disabled:!1,readonly:!1},e.ligerMethos.Spinner={},e.ligerui.controls.Spinner=function(t,i){e.ligerui.controls.Spinner.base.constructor.call(this,t,i)},e.ligerui.controls.Spinner.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return e.ligerMethos.Spinner},_init:function(){e.ligerui.controls.Spinner.base._init.call(this);var t=this.options;"float"==t.type?(t.step=.1,t.interval=50):"int"==t.type?(t.step=1,t.interval=100):"time"==t.type?(t.step=1,t.interval=100):(t.type="int",t.step=1,t.interval=100)},_render:function(){var t=this,i=this.options;t.interval=null,t.inputText=null,t.value=null,t.textFieldID="","input"==this.element.tagName.toLowerCase()&&this.element.type&&"text"==this.element.type?(t.inputText=e(this.element),this.element.id&&(t.textFieldID=this.element.id)):(t.inputText=e('<input type="text"/>'),t.inputText.appendTo(e(this.element))),""==t.textFieldID&&i.textFieldID&&(t.textFieldID=i.textFieldID),t.link=e('<div class="l-trigger"><div class="l-spinner-up"><div class="l-spinner-icon"></div></div><div class="l-spinner-split"></div><div class="l-spinner-down"><div class="l-spinner-icon"></div></div></div>'),t.wrapper=t.inputText.wrap('<div class="l-text"></div>').parent(),t.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),t.wrapper.append(t.link).after(t.selectBox).after(t.valueField),t.link.up=e(".l-spinner-up",t.link),t.link.down=e(".l-spinner-down",t.link),t.inputText.addClass("l-text-field"),i.disabled&&t.wrapper.addClass("l-text-disabled"),t._isVerify(t.inputText.val())||(t.value=t._getDefaultValue(),t._showValue(t.value)),t.link.up.hover(function(){i.disabled||e(this).addClass("l-spinner-up-over")},function(){clearInterval(t.interval),e(document).unbind("selectstart.spinner"),e(this).removeClass("l-spinner-up-over")}).mousedown(function(){i.disabled||(t._uping.call(t),t.interval=setInterval(function(){t._uping.call(t)},i.interval),e(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(t.interval),t.inputText.trigger("change").focus(),e(document).unbind("selectstart.spinner")}),t.link.down.hover(function(){i.disabled||e(this).addClass("l-spinner-down-over")},function(){clearInterval(t.interval),e(document).unbind("selectstart.spinner"),e(this).removeClass("l-spinner-down-over")}).mousedown(function(){i.disabled||(t.interval=setInterval(function(){t._downing.call(t)},i.interval),e(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(t.interval),t.inputText.trigger("change").focus(),e(document).unbind("selectstart.spinner");
}),t.inputText.change(function(){var e=t.inputText.val();t.value=t._getVerifyValue(e),t.trigger("changeValue",[t.value]),t._showValue(t.value)}).blur(function(){t.wrapper.removeClass("l-text-focus")}).focus(function(){t.wrapper.addClass("l-text-focus")}),t.wrapper.hover(function(){i.disabled||t.wrapper.addClass("l-text-over")},function(){t.wrapper.removeClass("l-text-over")}),t.set(i)},_setWidth:function(e){var t=this;e>20&&(t.wrapper.css({width:e}),t.inputText.css({width:e-20}))},_setHeight:function(e){var t=this;e>10&&(t.wrapper.height(e),t.inputText.height(e-2),t.link.height(e-4))},_setDisabled:function(e){e?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_showValue:function(e){var t=this.options;e&&"NaN"!=e||(e=0),"float"==t.type&&(e=parseFloat(e).toFixed(t.decimalplace)),this.inputText.val(e)},_setValue:function(e){this._showValue(e)},setValue:function(e){this._showValue(e)},getValue:function(){return this.inputText.val()},_round:function(e,t){for(var i=(this.options,1);t>0;i*=10,t--);for(;t<0;i/=10,t++);return Math.round(e*i)/i},_isInt:function(e){var t=this.options,i=t.isNegative?/^-?\d+$/:/^\d+$/;return!!i.test(e)&&parseFloat(e)==e},_isFloat:function(e){var t=this.options,i=t.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/;return!!i.test(e)&&parseFloat(e)==e},_isTime:function(e){var t=(this.options,e.match(/^(\d{1,2}):(\d{1,2})$/));return null!=t&&!(t[1]>24||t[2]>60)},_isVerify:function(e){var t=this,i=this.options;if("float"==i.type){if(!t._isFloat(e))return!1;var l=parseFloat(e);return!(void 0!=i.minValue&&i.minValue>l)&&!(void 0!=i.maxValue&&i.maxValue<l)}if("int"==i.type){if(!t._isInt(e))return!1;var l=parseInt(e);return!(void 0!=i.minValue&&i.minValue>l)&&!(void 0!=i.maxValue&&i.maxValue<l)}return"time"==i.type&&t._isTime(e)},_getVerifyValue:function(e){var t=this,i=this.options,l=null;return"float"==i.type?l=t._round(e,i.decimalplace):"int"==i.type?l=parseInt(e):"time"==i.type&&(l=e),t._isVerify(l)?l:t.value},_isOverValue:function(e){var t=this.options;return null!=t.minValue&&t.minValue>e||null!=t.maxValue&&t.maxValue<e},_getDefaultValue:function(){var e=this.options;return"float"==e.type||"int"==e.type?0:"time"==e.type?"00:00":void 0},_addValue:function(e){var t=this,i=(this.options,t.inputText.val());i=parseFloat(i)+e,t._isOverValue(i)||(t._showValue(i),t.inputText.trigger("change"))},_addTime:function(e){var t=this,i=(this.options,t.inputText.val()),l=i.match(/^(\d{1,2}):(\d{1,2})$/);newminute=parseInt(l[2])+e,newminute<10&&(newminute="0"+newminute),i=l[1]+":"+newminute,t._isOverValue(i)||(t._showValue(i),t.inputText.trigger("change"))},_uping:function(){var e=this,t=this.options;"float"==t.type||"int"==t.type?e._addValue(t.step):"time"==t.type&&e._addTime(t.step)},_downing:function(){var e=this,t=this.options;"float"==t.type||"int"==t.type?e._addValue(-1*t.step):"time"==t.type&&e._addTime(-1*t.step)},_isDateTime:function(e){var t=(this.options,e.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/));if(null==t)return!1;var i=new Date(t[1],t[3]-1,t[4]);return"NaN"!=i&&(i.getFullYear()==t[1]&&i.getMonth()+1==t[3]&&i.getDate()==t[4])},_isLongDateTime:function(e){var t=(this.options,/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/),i=e.match(t);if(null==i)return!1;var l=new Date(i[1],i[3]-1,i[4],i[5],i[6]);return"NaN"!=l&&(l.getFullYear()==i[1]&&l.getMonth()+1==i[3]&&l.getDate()==i[4]&&l.getHours()==i[5]&&l.getMinutes()==i[6])}})}(jQuery),function(e){e.fn.ligerTab=function(t){return e.ligerui.run.call(this,"ligerTab",arguments)},e.fn.ligerGetTabManager=function(){return e.ligerui.run.call(this,"ligerGetTabManager",arguments)},e.ligerDefaults.Tab={height:null,heightDiff:0,changeHeightOnResize:!1,contextmenu:!0,dblClickToClose:!1,dragToMove:!1,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null,onCloseOther:null,onCloseAll:null,onClose:null,onReload:null},e.ligerDefaults.TabString={closeMessage:e.Languages.msgGlobalString.CloseCurrentPage,closeOtherMessage:e.Languages.msgGlobalString.CloseOtherPage,closeAllMessage:e.Languages.msgGlobalString.CloseAllPage,reloadMessage:e.Languages.msgGlobalString.RefreshPage},e.ligerMethos.Tab={},e.ligerui.controls.Tab=function(t,i){e.ligerui.controls.Tab.base.constructor.call(this,t,i)},e.ligerui.controls.Tab.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return e.ligerMethos.Tab},_render:function(){var t=this,i=this.options;i.height&&(t.makeFullHeight=!0),t.tab=e(this.element),t.tab.addClass("l-tab"),i.contextmenu&&e.ligerMenu&&(t.tab.menu=e.ligerMenu({width:100,items:[{text:i.closeMessage,id:"close",icon:"candle",click:function(){t._menuItemClick.apply(t,arguments)}},{text:i.closeOtherMessage,id:"closeother",icon:"customers",click:function(){t._menuItemClick.apply(t,arguments)}},{text:i.closeAllMessage,id:"closeall",icon:"export",click:function(){t._menuItemClick.apply(t,arguments)}},{text:i.reloadMessage,id:"reload",icon:"refresh",click:function(){t._menuItemClick.apply(t,arguments)}}]})),t.tab.content=e('<div class="l-tab-content"></div>'),e("> div",t.tab).appendTo(t.tab.content),t.tab.content.appendTo(t.tab),t.tab.links=e('<div class="l-tab-links"><ul style="left: 0px; "></ul></div>'),t.tab.links.prependTo(t.tab),t.tab.links.ul=e("ul",t.tab.links);var l=e("> div[lselected=true]",t.tab.content),r=l.length>0;t.selectedTabId=l.attr("tabid"),e("> div",t.tab.content).each(function(i,l){var n=e('<li class=""><a></a><div class="l-tab-links-item-left"></div><div class="l-tab-links-item-right"></div></li>'),a=e(this);a.attr("title")&&(e("> a",n).html(a.attr("title")),a.attr("title",""));var o=a.attr("tabid");void 0==o&&(o=t.getNewTabid(),a.attr("tabid",o),a.attr("lselected")&&(t.selectedTabId=o)),n.attr("tabid",o),r||0!=i||(t.selectedTabId=o);var s=a.attr("showClose");if(s&&n.append("<div class='l-tab-links-item-close'></div>"),e("> ul",t.tab.links).append(n),a.hasClass("l-tab-content-item")||a.addClass("l-tab-content-item"),a.find("iframe").length>0){var d=e("iframe:first",a);if("complete"!=d[0].readyState){0==a.find(".l-tab-loading:first").length&&a.prepend("<div class='l-tab-loading' style='display:block;'></div>");var c=e(".l-tab-loading:first",a);d.bind("load.tab",function(){c.hide()})}}}),t.selectTabItem(t.selectedTabId),i.height&&("string"==typeof i.height&&i.height.indexOf("%")>0?(t.onResize(),i.changeHeightOnResize&&e(window).resize(function(){t.onResize.call(t)})):t.setHeight(i.height)),t.makeFullHeight&&t.setContentHeight(),e("li",t.tab.links).each(function(){t._addTabItemEvent(e(this))}),t.tab.bind("dblclick.tab",function(l){if(i.dblClickToClose){t.dblclicking=!0;var r=l.target||l.srcElement,n=r.tagName.toLowerCase();if("a"==n){var a=e(r).parent().attr("tabid"),o=!!e(r).parent().find("div.l-tab-links-item-close").length;o&&t.removeTabItem(a)}t.dblclicking=!1}}),t.set(i)},_applyDrag:function(t){var i=this;this.options;i.droptip=i.droptip||e("<div class='l-tab-drag-droptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");var l=e(t).ligerDrag({revert:!0,animate:!1,proxy:function(){var t=e(this).find("a").html();return i.dragproxy=e("<div class='l-tab-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body"),i.dragproxy.append(t),i.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(i,l){if(!e(t).hasClass("l-selected"))return!1;if(2==l.button)return!1;var r=l.srcElement||l.target;return!e(r).hasClass("l-tab-links-item-close")&&void 0},onDrag:function(t,l){null==i.dropIn&&(i.dropIn=-1);var r=i.tab.links.ul.find(">li"),n=r.index(t.target);r.each(function(t,r){if(n!=t){var a=t>n;if(i.dropIn==-1||i.dropIn==t){var o=e(this).offset(),s={top:o.top,bottom:o.top+e(this).height(),left:o.left-10,right:o.left+10};a&&(s.left+=e(this).width(),s.right+=e(this).width());var d=l.pageX||l.screenX,c=l.pageY||l.screenY;d>s.left&&d<s.right&&c>s.top&&c<s.bottom?(i.droptip.css({left:s.left+5,top:s.top-9}).show(),i.dropIn=t,i.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")):(i.dropIn=-1,i.droptip.hide(),i.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no"))}}})},onStopDrag:function(t,l){if(i.dropIn>-1){var r=i.tab.links.ul.find(">li:eq("+i.dropIn+")").attr("tabid"),n=e(t.target).attr("tabid");setTimeout(function(){i.moveTabItem(n,r)},0),i.dropIn=-1,i.dragproxy.remove()}i.droptip.hide(),this.set("cursor","default")}});return l},_setDragToMove:function(t){if(e.fn.ligerDrag){var i=this;this.options;if(t){if(i.drags)return;i.drags=i.drags||[],i.tab.links.ul.find(">li").each(function(){i.drags.push(i._applyDrag(this))})}}},moveTabItem:function(e,t){var i=this,l=i.tab.links.ul.find(">li[tabid="+e+"]"),r=i.tab.links.ul.find(">li[tabid="+t+"]"),n=i.tab.links.ul.find(">li").index(l),a=i.tab.links.ul.find(">li").index(r);n<a?r.after(l):r.before(l)},setTabButton:function(){var t=this,i=(this.options,0);e("li",t.tab.links.ul).each(function(){i+=e(this).width()+2});var l=t.tab.width();return i>l?(t.tab.links.append('<div class="l-tab-links-left"></div><div class="l-tab-links-right"></div>'),t.setTabButtonEven(),!0):(t.tab.links.ul.animate({left:0}),e(".l-tab-links-left,.l-tab-links-right",t.tab.links).remove(),!1)},setTabButtonEven:function(){var t=this;this.options;e(".l-tab-links-left",t.tab.links).hover(function(){e(this).addClass("l-tab-links-left-over")},function(){e(this).removeClass("l-tab-links-left-over")}).click(function(){t.moveToPrevTabItem()}),e(".l-tab-links-right",t.tab.links).hover(function(){e(this).addClass("l-tab-links-right-over")},function(){e(this).removeClass("l-tab-links-right-over")}).click(function(){t.moveToNextTabItem()})},moveToPrevTabItem:function(){var t=this,i=(this.options,e(".l-tab-links-left",t.tab.links).width()),l=new Array;e("li",t.tab.links).each(function(t,r){var n=-1*i;t>0&&(n=parseInt(l[t-1])+e(this).prev().width()+2),l.push(n)});for(var r=-1*parseInt(t.tab.links.ul.css("left")),n=0;n<l.length-1;n++)if(l[n]<r&&l[n+1]>=r)return void t.tab.links.ul.animate({left:-1*parseInt(l[n])})},moveToNextTabItem:function(){var t=this,i=(this.options,e(".l-tab-links-right",t.tab).width()),l=0,r=e("li",t.tab.links.ul);r.each(function(){l+=e(this).width()+2});for(var n=t.tab.width(),a=new Array,o=r.length-1;o>=0;o--){var s=l-n+i+2;o!=r.length-1&&(s=parseInt(a[r.length-2-o])-e(r[o+1]).width()-2),a.push(s)}for(var d=-1*parseInt(t.tab.links.ul.css("left")),c=1;c<a.length;c++)if(a[c]<=d&&a[c-1]>d)return void t.tab.links.ul.animate({left:-1*parseInt(a[c-1])})},getHeader:function(t){return e("li[tabid="+t+"] a",this.tab.links.ul).text()},getTabItemCount:function(){var t=this;this.options;return e("li",t.tab.links.ul).length},getSelectedTabItemID:function(){var t=this;this.options;return e("li.l-selected",t.tab.links.ul).attr("tabid")},removeSelectedTabItem:function(){var e=this;this.options;e.removeTabItem(e.getSelectedTabItemID())},overrideSelectedTabItem:function(e){var t=this;this.options;t.overrideTabItem(t.getSelectedTabItemID(),e)},overrideTabItem:function(t,i){var l=this;this.options;if(0==l.trigger("beforeOverrideTabItem",[t]))return!1;var r=i.tabid;void 0==r&&(r=l.getNewTabid());var n=i.url,a=i.content,o=(i.target,i.text),s=i.showClose,d=i.height;if(l.isTabItemExist(r)){var c=e("li[tabid="+t+"]",l.tab.links.ul),u=e(".l-tab-content-item[tabid="+t+"]",l.tab.content);c&&u&&(c.attr("tabid",r),u.attr("tabid",r),0==e("iframe",u).length&&n?u.html("<iframe frameborder='0'></iframe>"):a&&u.html(a),e("iframe",u).attr("name",r),void 0==s&&(s=!0),0==s?e(".l-tab-links-item-close",c).remove():0==e(".l-tab-links-item-close",c).length&&c.append("<div class='l-tab-links-item-close'></div>"),void 0==o&&(o=r),d&&u.height(d),e("a",c).text(o),e("iframe",u).attr("src",n),l.trigger("afterOverrideTabItem",[t]))}},setHeader:function(t,i){var l=i.lastIndexOf("["),r=i,n="",a="",o=e("li[tabid="+t+"] a",this.tab.links.ul);l!==-1&&(r=i.substring(0,l),n=i.substring(l)),a=(r.length>12?r.substring(0,12)+"...":r)+n,o.text(a).attr("title",i)},selectTabItem:function(t){var i=this;this.options;return 0!=i.trigger("beforeSelectTabItem",[t])&&(i.selectedTabId=t,e("> .l-tab-content-item[tabid="+t+"]",i.tab.content).show().siblings().hide(),e("li[tabid="+t+"]",i.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected"),void i.trigger("afterSelectTabItem",[t]))},moveToLastTabItem:function(){var t=this,i=(this.options,0);e("li",t.tab.links.ul).each(function(){i+=e(this).width()+2});var l=t.tab.width();if(i>l){var r=e(".l-tab-links-right",t.tab.links).width();t.tab.links.ul.animate({left:-1*(i-l+r+2)})}},isTabItemExist:function(t){var i=this;this.options;return e("li[tabid="+t+"]",i.tab.links.ul).length>0},addTabItem:function(t){var i=this,l=this.options;if(0==i.trigger("beforeAddTabItem",[r]))return!1;var r=t.tabid;void 0==r&&(r=i.getNewTabid());var n=t.url,a=t.content,o=t.text,s=t.showClose,d=t.height;if(i.isTabItemExist(r))return void i.selectTabItem(r);var c=e("<li><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div><div class='l-tab-links-item-close'></div></li>"),u=e("<div class='l-tab-content-item'><div class='l-tab-loading' style='display:block;'></div><iframe frameborder='0'></iframe></div>"),h=e("div:first",u),g=e("iframe:first",u);if(i.makeFullHeight){var p=i.tab.height()-i.tab.links.height();u.height(p)}c.attr("tabid",r),u.attr("tabid",r),n?g.attr("name",r).attr("id",r).attr("src",n).bind("load.tab",function(){h.hide(),t.callback&&t.callback()}):(g.remove(),h.remove()),a?u.html(a):t.target&&u.append(t.target),void 0==s&&(s=!0),0==s&&e(".l-tab-links-item-close",c).remove(),void 0==o&&(o=r),d&&u.height(d),o.length>12?(e("a",c).text(o.substring(0,12)+"..."),e("a",c).attr("title",o)):e("a",c).text(o),i.tab.links.ul.append(c),i.tab.content.append(u),i.selectTabItem(r),i.setTabButton()&&i.moveToLastTabItem(),i._addTabItemEvent(c),l.dragToMove&&e.fn.ligerDrag&&(i.drags=i.drags||[],c.each(function(){i.drags.push(i._applyDrag(this))})),i.trigger("afterAddTabItem",[r])},_addTabItemEvent:function(t){var i=this;this.options;t.click(function(){var t=e(this).attr("tabid");i.selectTabItem(t)}),i.tab.menu&&i._addTabItemContextMenuEven(t),e(".l-tab-links-item-close",t).hover(function(){e(this).addClass("l-tab-links-item-close-over")},function(){e(this).removeClass("l-tab-links-item-close-over")}).click(function(){var t=e(this).parent().attr("tabid");i.removeTabItem(t)})},removeTabItem:function(t){var i=this;this.options;if(0==i.trigger("beforeRemoveTabItem",[t]))return!1;var l=e("li[tabid="+t+"]",i.tab.links.ul).hasClass("l-selected");l&&(e(".l-tab-content-item[tabid="+t+"]",i.tab.content).prev().show(),e("li[tabid="+t+"]",i.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected"));var r=e(".l-tab-content-item[tabid="+t+"]",i.tab.content),n=e("iframe",r);if(n.length){var a=n[0];a.src="about:blank",a.contentWindow.document.write(""),a.contentWindow.close(),e.browser.msie&&CollectGarbage(),n.remove()}r.remove(),e("li[tabid="+t+"]",i.tab.links.ul).remove(),i.setTabButton(),i.trigger("afterRemoveTabItem",[t])},addHeight:function(e){var t=this,i=(this.options,t.tab.height()+e);t.setHeight(i)},setHeight:function(e){var t=this;this.options;t.tab.height(e),t.setContentHeight()},setContentHeight:function(){var t=this,i=(this.options,t.tab.height()-t.tab.links.height());t.tab.content.height(i),e("> .l-tab-content-item",t.tab.content).height(i)},getNewTabid:function(){var e=this;this.options;return e.getnewidcount=e.getnewidcount||0,"tabitem"+ ++e.getnewidcount},getTabidList:function(t,i){var l=this,r=(this.options,[]);return e("> li",l.tab.links.ul).each(function(){e(this).attr("tabid")&&e(this).attr("tabid")!=t&&(!i||e(".l-tab-links-item-close",this).length>0)&&r.push(e(this).attr("tabid"))}),r},removeOther:function(t,i){var l=this,r=(this.options,l.getTabidList(t,!0));e(r).each(function(){l.removeTabItem(this)})},reload:function(t){var i=(this.options,e(".l-tab-content-item[tabid="+t+"]")),l=e(".l-tab-loading:first",i),r=e("iframe:first",i),n=e(r).attr("src");l.show(),r.attr("src",n).unbind("load.tab").bind("load.tab",function(){l.hide()})},removeAll:function(t){var i=this,l=(this.options,i.getTabidList(null,!0));e(l).each(function(){i.removeTabItem(this)})},onResize:function(){var t=this,i=this.options;if(!i.height||"string"!=typeof i.height||i.height.indexOf("%")==-1)return!1;if("body"==t.tab.parent()[0].tagName.toLowerCase()){var l=e(window).height();l-=parseInt(t.tab.parent().css("paddingTop")),l-=parseInt(t.tab.parent().css("paddingBottom")),t.height=i.heightDiff+l*parseFloat(t.height)*.01}else t.height=i.heightDiff+t.tab.parent().height()*parseFloat(i.height)*.01;t.tab.height(t.height),t.setContentHeight()},_menuItemClick:function(e){var t=this;this.options;if(e.id&&t.actionTabid)switch(e.id){case"close":if(0==t.trigger("close"))return;t.removeTabItem(t.actionTabid),t.actionTabid=null;break;case"closeother":if(0==t.trigger("closeother"))return;t.removeOther(t.actionTabid);break;case"closeall":if(0==t.trigger("closeall"))return;t.removeAll(),t.actionTabid=null;break;case"reload":if(0==t.trigger("reload"))return;t.selectTabItem(t.actionTabid),t.reload(t.actionTabid)}},_addTabItemContextMenuEven:function(t){var i=this;this.options;t.bind("contextmenu",function(l){if(i.tab.menu)return i.actionTabid=t.attr("tabid"),i.tab.menu.show({top:l.pageY,left:l.pageX}),0==e(".l-tab-links-item-close",this).length?i.tab.menu.setDisabled("close"):i.tab.menu.setEnabled("close"),!1})}})}(jQuery),function(e){function t(e){if(!e)return"0.00";e=e.toString().replace(/\$|\,/g,""),isNaN(e)&&(e="0.00"),sign=e==(e=Math.abs(e)),e=Math.floor(100*e+.50000000001),cents=e%100,e=Math.floor(e/100).toString(),cents<10&&(cents="0"+cents);for(var t=0;t<Math.floor((e.length-(1+t))/3);t++)e=e.substring(0,e.length-(4*t+3))+","+e.substring(e.length-(4*t+3));return""+((sign?"":"-")+""+e+"."+cents)}e.fn.ligerTextBox=function(){return e.ligerui.run.call(this,"ligerTextBox",arguments)},e.fn.ligerGetTextBoxManager=function(){return e.ligerui.run.call(this,"ligerGetTextBoxManager",arguments)},e.ligerDefaults.TextBox={onChangeValue:null,onMouseOver:null,onMouseOut:null,onBlur:null,onFocus:null,width:null,disabled:!1,value:null,nullText:null,digits:!1,number:!1,currency:!1,readonly:!1},e.ligerui.controls.TextBox=function(t,i){e.ligerui.controls.TextBox.base.constructor.call(this,t,i)},e.ligerui.controls.TextBox.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){e.ligerui.controls.TextBox.base._init.call(this);var t=this,i=this.options;i.width||(i.width=e(t.element).width()),e(this.element).attr("readonly")?i.readonly=!0:i.readonly&&e(this.element).attr("readonly",!0)},_render:function(){var t=this,i=this.options;t.inputText=e(this.element),t.wrapper=t.inputText.wrap('<div class="l-text"></div>').parent(),t.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),t.inputText.hasClass("l-text-field")||t.inputText.addClass("l-text-field"),this._setEvent(),(i.digits||i.number||i.currency)&&t.inputText.addClass("l-text-field-number"),t.set(i),t.checkValue()},destroy:function(){var e=this;e.wrapper&&e.wrapper.remove(),e.options=null,liger.remove(this)},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},checkValue:function(){var i=this,l=this.options;if(e.isFunction(l.checkValue))return void l.checkValue.call(this);var r=i.inputText.val()||"";l.currency&&(r=r.replace(/\$|\,/g,""));var n=l.number||l.currency,a=l.digits;return n&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(r)||a&&!/^\d+$/.test(r)?(i.inputText.val(i.value||0),void(l.currency&&i.inputText.val(t(i.value)))):(i.value=r,void(l.currency&&i.inputText.val(t(i.value))))},checkNotNull:function(){var e=this,t=this.options;t.nullText&&!t.disabled&&(e.inputText.val()||e.inputText.addClass("l-text-field-null").val(t.nullText))},_setEvent:function(){var t=this,i=this.options;t.inputText.bind("blur.textBox",function(){t.trigger("blur"),t.checkNotNull(),t.checkValue(),t.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){t.trigger("focus"),i.nullText&&e(this).hasClass("l-text-field-null")&&e(this).removeClass("l-text-field-null").val(""),t.wrapper.addClass("l-text-focus")}).change(function(){t.trigger("changeValue",[this.value])}),t.wrapper.hover(function(){t.trigger("mouseOver"),t.wrapper.addClass("l-text-over")},function(){t.trigger("mouseOut"),t.wrapper.removeClass("l-text-over")})},_setDisabled:function(e){var t=this.options;e?(this.inputText.attr("readonly","readonly"),this.wrapper.addClass("l-text-disabled")):t.readonly||(this.inputText.removeAttr("readonly"),this.wrapper.removeClass("l-text-disabled"))},_setWidth:function(e){e>20&&(this.wrapper.css({width:e}),this.inputText.css({width:e-4}))},_setHeight:function(e){e>10&&(this.wrapper.height(e),this.inputText.height(e-2))},_setValue:function(e){null!=e&&this.inputText.val(e)},_setLabel:function(t){var i=this,l=this.options;if(i.labelwrapper)i.labelwrapper.find(".l-text-label").html(t+":&nbsp");else{i.labelwrapper=i.wrapper.wrap('<div class="l-labeltext"></div>').parent();var r=e('<div class="l-text-label" style="float:left;">'+t+":&nbsp</div>");i.labelwrapper.prepend(r),i.wrapper.css("float","left"),l.labelWidth?i._setLabelWidth(l.labelWidth):l.labelWidth=r.width(),r.height(i.wrapper.height()),l.labelAlign&&i._setLabelAlign(l.labelAlign),i.labelwrapper.append('<br style="clear:both;" />'),i.labelwrapper.width(l.labelWidth+l.width+2)}},_setLabelWidth:function(e){var t=this;this.options;t.labelwrapper&&t.labelwrapper.find(".l-text-label").width(e)},_setLabelAlign:function(e){var t=this;this.options;t.labelwrapper&&t.labelwrapper.find(".l-text-label").css("text-align",e)},updateStyle:function(){var e=this,t=this.options;e.inputText.attr("readonly")?(e.wrapper.addClass("l-text-readonly"),t.disabled=!0):(e.wrapper.removeClass("l-text-readonly"),t.disabled=!1),e.inputText.attr("disabled")?(e.wrapper.addClass("l-text-disabled"),t.disabled=!0):(e.wrapper.removeClass("l-text-disabled"),t.disabled=!1),e.inputText.hasClass("l-text-field-null")&&e.inputText.val()!=t.nullText&&e.inputText.removeClass("l-text-field-null"),e.checkValue()}})}(jQuery),function(e){e.ligerTip=function(t){return e.ligerui.run.call(null,"ligerTip",arguments)},e.fn.ligerTip=function(t){return this.each(function(){var i=e.extend({},e.ligerDefaults.ElementTip,t||{});if(i.target=i.target||this,i.auto||void 0==t)i.content||(i.content=this.title,i.removeTitle&&e(this).removeAttr("title")),i.content=i.content||this.title,e(this).bind("mouseover.tip",function(){i.x=e(this).offset().left+e(this).width()+(i.distanceX||0),i.y=e(this).offset().top+(i.distanceY||0),e.ligerTip(i)}).bind("mouseout.tip",function(){var t=e.ligerui.managers[this.ligeruitipid];t&&t.remove()});else{if(i.target.ligeruitipid)return;i.x=e(this).offset().left+e(this).width()+(i.distanceX||0),i.y=e(this).offset().top+(i.distanceY||0),i.x=i.x||0,i.y=i.y||0,e.ligerTip(i)}}),e.ligerui.get(this,"ligeruitipid")},e.fn.ligerHideTip=function(t){return this.each(function(){var i=t||{};void 0==i.isLabel&&(i.isLabel="label"==this.tagName.toLowerCase()&&null!=e(this).attr("for"));var l=this;if(i.isLabel){var r=e("#"+e(this).attr("for"));if(0==r.length)return;l=r[0]}var n=e.ligerui.managers[l.ligeruitipid];n&&n.remove()}).unbind("mouseover.tip").unbind("mouseout.tip")},e.fn.ligerGetTipManager=function(){return e.ligerui.get(this)},e.ligerDefaults=e.ligerDefaults||{},e.ligerDefaults.HideTip={},e.ligerDefaults.Tip={content:null,callback:null,width:150,height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:!0},e.ligerDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:!0},e.ligerMethos.Tip={},e.ligerui.controls.Tip=function(t){e.ligerui.controls.Tip.base.constructor.call(this,null,t)},e.ligerui.controls.Tip.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return e.ligerMethos.Tip},_render:function(){var t=this,i=this.options,l=e('<div class="l-verify-tip"><div class="l-verify-tip-corner"></div><div class="l-verify-tip-content"></div></div>');t.tip=l,t.tip.attr("id",t.id),i.content&&(e("> .l-verify-tip-content:first",l).html(i.content),l.appendTo("body"),l.css({left:i.x,top:i.y}).show(),i.width&&e("> .l-verify-tip-content:first",l).width(i.width-8),i.height&&e("> .l-verify-tip-content:first",l).width(i.height),eee=i.appendIdTo,i.appendIdTo&&i.appendIdTo.attr("ligerTipId",t.id),i.target&&(e(i.target).attr("ligerTipId",t.id),i.target.ligeruitipid=t.id),i.callback&&i.callback(l),t.set(i))},_setContent:function(t){e("> .l-verify-tip-content:first",this.tip).html(t)},remove:function(){this.options.appendIdTo&&this.options.appendIdTo.removeAttr("ligerTipId"),this.options.target&&(e(this.options.target).removeAttr("ligerTipId"),this.options.target.ligeruitipid=null),this.tip.remove()}})}(jQuery),function(e){e.fn.ligerToolBar=function(t){return e.ligerui.run.call(this,"ligerToolBar",arguments)},e.fn.ligerGetToolBarManager=function(){return e.ligerui.run.call(this,"ligerGetToolBarManager",arguments)},e.ligerDefaults.ToolBar={},e.ligerMethos.ToolBar={},e.ligerui.controls.ToolBar=function(t,i){e.ligerui.controls.ToolBar.base.constructor.call(this,t,i)},e.ligerui.controls.ToolBar.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return e.ligerMethos.ToolBar},_render:function(){var t=this,i=this.options;t.toolbarItemCount=0,t.toolBar=e(this.element),t.toolBar.addClass("l-toolbar"),t.set(i)},_setItems:function(t){var i=this;i.toolBar.html(""),e(t).each(function(e,t){i.addItem(t)})},removeItem:function(t){var i=this;this.options;e("> .l-toolbar-item[toolbarid="+t+"]",i.toolBar).remove()},setEnabled:function(t){var i=this;this.options;e("> .l-toolbar-item[toolbarid="+t+"]",i.toolBar).removeClass("l-toolbar-item-disable")},setDisabled:function(t){var i=this;this.options;e("> .l-toolbar-item[toolbarid="+t+"]",i.toolBar).addClass("l-toolbar-item-disable")},isEnable:function(t){var i=this;this.options;return!e("> .l-toolbar-item[toolbarid="+t+"]",i.toolBar).hasClass("l-toolbar-item-disable")},addItem:function(t){var i=this;this.options;if(t.line)return void i.toolBar.append('<div class="l-bar-separator"></div>');var l=e('<div class="l-toolbar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div></div>');i.toolBar.append(l),t.id||(t.id="item-"+ ++i.toolbarItemCount),l.attr("toolbarid",t.id),t.img?(l.append("<img src='"+t.img+"' />"),l.addClass("l-toolbar-item-hasicon")):t.icon?(l.append("<div class='l-icon l-icon-"+t.icon+"'></div>"),l.addClass("l-toolbar-item-hasicon")):t.color&&(l.append("<div class='l-toolbar-item-color' style='background:"+t.color+"'></div>"),l.addClass("l-toolbar-item-hasicon")),t.text&&e("span:first",l).html(t.text),t.disable&&l.addClass("l-toolbar-item-disable"),t.click&&l.click(function(){e(this).hasClass("l-toolbar-item-disable")||t.click(t)}),t.menu?(t.menu=e.ligerMenu(t.menu),l.hover(function(){if(!e(this).hasClass("l-toolbar-item-disable")){i.actionMenu&&i.actionMenu.hide();var l=e(this).offset().left,r=e(this).offset().top+e(this).height();t.menu.show({top:r,left:l}),i.actionMenu=t.menu,e(this).addClass("l-panel-btn-over")}},function(){e(this).hasClass("l-toolbar-item-disable")||e(this).removeClass("l-panel-btn-over")})):l.hover(function(){e(this).hasClass("l-toolbar-item-disable")||e(this).addClass("l-panel-btn-over")},function(){e(this).hasClass("l-toolbar-item-disable")||e(this).removeClass("l-panel-btn-over")})}}),e.ligerui.controls.ToolBar.prototype.setEnable=e.ligerui.controls.ToolBar.prototype.setEnabled,e.ligerui.controls.ToolBar.prototype.setDisable=e.ligerui.controls.ToolBar.prototype.setDisabled}(jQuery),function(e){e.fn.ligerTree=function(t){return e.ligerui.run.call(this,"ligerTree",arguments)},e.fn.ligerGetTreeManager=function(){return e.ligerui.run.call(this,"ligerGetTreeManager",arguments)},e.ligerDefaults.Tree={url:null,data:null,checkbox:!0,autoCheckboxEven:!0,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:!0,nodeWidth:90,statusName:"__status",isLeaf:null,single:!1,needCancel:!0,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},onMouseOver:function(){},onMouseOut:function(){},onStartDrag:null,onDragging:null,onStopDrag:null,idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:!0,iconFieldName:"icon",nodeDraggable:!1,nodeDraggingRender:null,btnClickToToggleOnly:!0,ajaxType:"post",render:null,selectable:null,isExpand:null,delay:null},e.ligerui.controls.Tree=function(t,i){e.ligerui.controls.Tree.base.constructor.call(this,t,i)},e.ligerui.controls.Tree.ligerExtend(e.ligerui.core.UIComponent,{_init:function(){e.ligerui.controls.Tree.base._init.call(this);var t=this.options;t.single&&(t.autoCheckboxEven=!1)},_render:function(){var t=this,i=this.options;t.set(i,!0),t.tree=e(t.element),t.tree.addClass("l-tree"),t.toggleNodeCallbacks=[],t.sysAttribute=["isexpand","ischecked","href","style","delay"],t.loading=e("<div class='l-tree-loading'></div>"),t.tree.after(t.loading),t.data=[],t.maxOutlineLevel=1,t.treedataindex=0,t._applyTree(),t._setTreeEven(),t.set(i,!1)},_setTreeLine:function(e){e?this.tree.removeClass("l-tree-noline"):this.tree.addClass("l-tree-noline")},_setParms:function(){var t=this.options;e.isFunction(t.parms)&&(t.parms=t.parms())},_setUrl:function(e){var t=this;this.options;e&&(t.clear(),t.loadData(null,e))},_setData:function(e){e&&(this.clear(),this.append(null,e))},setData:function(e){this.set("data",e)},getData:function(){return this.data},hasChildren:function(e){return this.options.isLeaf?!this.options.isLeaf(e):!!e.children},getParent:function(t,i){var l=this;t=l.getNodeDom(t);var r=l.getParentTreeItem(t,i);if(!r)return null;var n=e(r).attr("treedataindex");return l._getDataNodeByTreeDataIndex(l.data,n)},getParentTreeItem:function(t,i){var l=this;t=l.getNodeDom(t);var r=e(t);if(r.parent().hasClass("l-tree"))return null;if(void 0==i)return 0==r.parent().parent("li").length?null:r.parent().parent("li")[0];for(var n=parseInt(r.attr("outlinelevel")),a=r,o=n-1;o>=i;o--)a=a.parent().parent("li");return a[0]},getChecked:function(){var t=this;this.options;if(!this.options.checkbox)return null;var i=[];return e(".l-checkbox-checked",t.tree).parent().parent("li").each(function(){var l=parseInt(e(this).attr("treedataindex"));i.push({target:this,data:t._getDataNodeByTreeDataIndex(t.data,l)})}),i},getSelected:function(){var t=this,i=(this.options,{});if(i.target=e(".l-selected",t.tree).parent("li")[0],i.target){var l=parseInt(e(i.target).attr("treedataindex"));return i.data=t._getDataNodeByTreeDataIndex(t.data,l),i}return null},upgrade:function(t){var i=this;this.options;e(".l-note",t).each(function(){e(this).removeClass("l-note").addClass("l-expandable-open")}),e(".l-note-last",t).each(function(){e(this).removeClass("l-note-last").addClass("l-expandable-open")}),e("."+i._getChildNodeClassName(),t).each(function(){e(this).removeClass(i._getChildNodeClassName()).addClass(i._getParentNodeClassName(!0))})},demotion:function(t){var i=this;this.options;if(t||"li"==t[0].tagName.toLowerCase()){var l=e(t).hasClass("l-last");e(".l-expandable-open",t).each(function(){
e(this).removeClass("l-expandable-open").addClass(l?"l-note-last":"l-note")}),e(".l-expandable-close",t).each(function(){e(this).removeClass("l-expandable-close").addClass(l?"l-note-last":"l-note")}),e("."+i._getParentNodeClassName(!0),t).each(function(){e(this).removeClass(i._getParentNodeClassName(!0)).addClass(i._getChildNodeClassName())})}},collapseAll:function(){var t=this;this.options;e(".l-expandable-open",t.tree).click()},expandAll:function(){var t=this;this.options;e(".l-expandable-close",t.tree).click()},loadData:function(t,i,l,r){var n=this,a=this.options;r=e.extend({showLoading:function(){n.loading.show()},hideLoading:function(){n.loading.hide()}},r||{});var o=a.ajaxType;l=l||[],e.ajax({type:o,url:i,data:l,dataType:"json",beforeSend:function(){r.showLoading()},success:function(e){r.hideLoading(),e&&(n.append(t,e),n.trigger("success",[e]))},error:function(e,t,i){try{r.hideLoading(),n.trigger("error",[e,t,i])}catch(e){}}})},clear:function(){var e=this;this.options;e.toggleNodeCallbacks=[],e.data=null,e.data=[],e.nodes=null,e.tree.html("")},getNodeDom:function(t){var i=this;this.options;return null==t?t:"string"==typeof t||"number"==typeof t?e("li[treedataindex="+t+"]",i.tree).get(0):"object"==typeof t&&"treedataindex"in t?i.getNodeDom(t.treedataindex):t},hide:function(t){var i=this;this.options;t=i.getNodeDom(t),t&&e(t).hide()},show:function(t){var i=this;this.options;t=i.getNodeDom(t),t&&e(t).show()},remove:function(t){var i=this,l=this.options;t=i.getNodeDom(t);var r=parseInt(e(t).attr("treedataindex")),n=i._getDataNodeByTreeDataIndex(i.data,r);n&&i._setTreeDataStatus([n],"delete");var a=i.getParentTreeItem(t);l.checkbox&&i._setParentCheckboxStatus(e(t)),e(t).remove(),i._updateStyle(a?e("ul:first",a):i.tree)},_updateStyle:function(t){var i=this,l=(this.options,e(" > li",t)),r=l.length;r&&l.each(function(t,l){0!=t||e(this).hasClass("l-first")||e(this).addClass("l-first"),t!=r-1||e(this).hasClass("l-last")||e(this).addClass("l-last"),0==t&&t==r-1&&e(this).addClass("l-onlychild"),e("> div .l-note,> div .l-note-last",this).removeClass("l-note l-note-last").addClass(t==r-1?"l-note-last":"l-note"),i._setTreeItem(this,{isLast:t==r-1})})},update:function(t,i){var l=this,r=this.options;t=l.getNodeDom(t);var n=parseInt(e(t).attr("treedataindex"));nodedata=l._getDataNodeByTreeDataIndex(l.data,n);for(var a in i)nodedata[a]=i[a],a==r.textFieldName&&e("> .l-body > span",t).text(i[a])},append:function(t,i,l,r){var n=this,a=this.options;if(t=n.getNodeDom(t),0==n.trigger("beforeAppend",[t,i]))return!1;if(!i||!i.length)return!1;if(a.idFieldName&&a.parentIDFieldName&&(i=n.arrayToTree(i,a.idFieldName,a.parentIDFieldName)),n._addTreeDataIndexToData(i),n._setTreeDataStatus(i,"add"),null!=l&&(l=n.getNodeDom(l)),n.trigger("append",[t,i]),n._appendData(t,i),null==t){var o=n._getTreeHTMLByData(i,1,[],!0);return o[o.length-1]=o[0]="",null!=l?(e(l)[r?"after":"before"](o.join("")),n._updateStyle(t?e("ul:first",t):n.tree)):(e("> li:last",n.tree).length>0&&n._setTreeItem(e("> li:last",n.tree)[0],{isLast:!1}),n.tree.append(o.join(""))),e(".l-body",n.tree).hover(function(){e(this).addClass("l-over")},function(){e(this).removeClass("l-over")}),n._upadteTreeWidth(),void n.trigger("afterAppend",[t,i])}var s=e(t),d=parseInt(s.attr("outlinelevel")),c=e("> ul",s).length>0;c||(s.append("<ul class='l-children'></ul>"),n.upgrade(t));for(var u=[],h=1;h<=d-1;h++){var g=e(n.getParentTreeItem(t,h));u.push(g.hasClass("l-last"))}u.push(s.hasClass("l-last"));var o=n._getTreeHTMLByData(i,d+1,u,!0);o[o.length-1]=o[0]="",null!=l?(e(l)[r?"after":"before"](o.join("")),n._updateStyle(t?e("ul:first",t):n.tree)):(e("> .l-children > li:last",s).length>0&&n._setTreeItem(e("> .l-children > li:last",s)[0],{isLast:!1}),e(">.l-children",t).append(o.join(""))),n._upadteTreeWidth(),e(">.l-children .l-body",t).hover(function(){e(this).addClass("l-over")},function(){e(this).removeClass("l-over")}),n.trigger("afterAppend",[t,i])},cancelSelect:function(t){var i=this,l=this.options,r=i.getNodeDom(t),n=e(r),a=parseInt(n.attr("treedataindex")),o=i._getDataNodeByTreeDataIndex(i.data,a),s=e(">div:first",n);l.checkbox?e(".l-checkbox",s).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"):s.removeClass("l-selected"),i.trigger("cancelSelect",[{data:o,target:n[0]}])},selectNode:function(t){var i=this,l=this.options,r=null;if("function"==typeof t)r=t;else{if("object"==typeof t){var n=e(t),a=parseInt(n.attr("treedataindex")),o=i._getDataNodeByTreeDataIndex(i.data,a),s=e(">div:first",n);return l.checkbox?e(".l-checkbox",s).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"):s.addClass("l-selected"),void i.trigger("select",[{data:o,target:n[0]}])}r=function(e){return!!e[l.idFieldName]&&e[l.idFieldName].toString()==t.toString()}}e("li",i.tree).each(function(){var t=e(this),l=parseInt(t.attr("treedataindex")),n=i._getDataNodeByTreeDataIndex(i.data,l);r(n,l)?i.selectNode(this):i.cancelSelect(this)})},getTextByID:function(e){var t=this,i=this.options,l=t.getDataByID(e);return l?l[i.textFieldName]:null},getDataByID:function(t){var i=this,l=this.options,r=null;return e("li",i.tree).each(function(){if(!r){var n=e(this),a=parseInt(n.attr("treedataindex")),o=i._getDataNodeByTreeDataIndex(i.data,a);o[l.idFieldName].toString()==t.toString()&&(r=o)}}),r},arrayToTree:function(e,t,i){if(!e||!e.length)return[];for(var l=[],r={},n=e.length,a=0;a<n;a++){var o=e[a];r[o[t]]=o}for(var a=0;a<n;a++){var s=e[a],d=r[s[i]];d?(d.children=d.children||[],d.children.push(s)):l.push(s)}return l},_getDataNodeByTreeDataIndex:function(e,t){for(var i=this,l=(this.options,0);l<e.length;l++){if(e[l].treedataindex==t)return e[l];if(e[l].children){var r=i._getDataNodeByTreeDataIndex(e[l].children,t);if(r)return r}}return null},_setTreeDataStatus:function(t,i){var l=this,r=this.options;e(t).each(function(){this[r.statusName]=i,this.children&&l._setTreeDataStatus(this.children,i)})},_addTreeDataIndexToData:function(t){var i=this;this.options;e(t).each(function(){void 0==this.treedataindex&&(this.treedataindex=i.treedataindex++,this.children&&i._addTreeDataIndexToData(this.children))})},_addToNodes:function(t){var i=this;this.options;i.nodes=i.nodes||[],i.nodes.push(t),t.children&&e(t.children).each(function(e,t){i._addToNodes(t)})},_appendData:function(t,i){var l=this,r=(this.options,parseInt(e(t).attr("treedataindex"))),n=l._getDataNodeByTreeDataIndex(l.data,r);void 0==l.treedataindex&&(l.treedataindex=0),n&&void 0==n.children&&(n.children=[]),e(i).each(function(e,t){n?n.children[n.children.length]=t:l.data[l.data.length]=t,l._addToNodes(t)})},_setTreeItem:function(t,i){var l=this;this.options;if(i){t=l.getNodeDom(t);var r=e(t),n=parseInt(r.attr("outlinelevel"));void 0!=i.isLast&&(1==i.isLast?(r.removeClass("l-last").addClass("l-last"),e("> div .l-note",r).removeClass("l-note").addClass("l-note-last"),e(".l-children li",r).find(".l-box:eq("+(n-1)+")").removeClass("l-line")):0==i.isLast&&(r.removeClass("l-last"),e("> div .l-note-last",r).removeClass("l-note-last").addClass("l-note"),e(".l-children li",r).find(".l-box:eq("+(n-1)+")").removeClass("l-line").addClass("l-line")))}},_upadteTreeWidth:function(){var e=this;this.options;e.tree.width("100%")},_getChildNodeClassName:function(){var e=this.options;return"l-tree-icon-"+e.childIcon},_getParentNodeClassName:function(e){var t=this.options,i="l-tree-icon-"+t.parentIcon;return e&&(i+="-open"),i},_isExpand:function(e,t){var i=this.options,l=null!=e.isExpand?e.isExpand:null!=e.isexpand?e.isexpand:i.isExpand;return null==l||("function"==typeof l&&(l=i.isExpand({data:e,level:t})),"boolean"==typeof l?l:"string"==typeof l?"true"==l:"number"!=typeof l||l>t)},_getDelay:function(t,i){var l=this.options,r=null!=t.delay?t.delay:l.delay;return null!=r&&("function"==typeof r&&(r=r({data:t,level:i})),"boolean"==typeof r?r:"string"==typeof r?{url:r}:("number"==typeof r&&(r=[r]),e.isArray(r)?e.inArray(i,r)!=-1:!("object"!=typeof r||!r.url)&&r))},_getTreeHTMLByData:function(t,i,l,r){if(t){var n=this,a=this.options;n.maxOutlineLevel<i&&(n.maxOutlineLevel=i),l=l||[],i=i||1;var o=[];r?o.push("<ul class='l-children'>"):o.push('<ul class="l-children" style="display:none">');for(var s=0;s<t.length;s++){var d=t[s],c=0==s,u=s==t.length-1,h=n._getDelay(d,i),g=!h&&n._isExpand(d,i);o.push("<li "),void 0!=d.treedataindex&&o.push('treedataindex="'+d.treedataindex+'" '),g&&o.push("isexpand="+d.isexpand+" "),o.push("outlinelevel="+i+" ");for(var p=0;p<n.sysAttribute.length;p++)"a"!=this.element.tagName.toLowerCase()&&"href"==n.sysAttribute[p]||e(this).attr(n.sysAttribute[p])&&(t[dataindex][n.sysAttribute[p]]=e(this).attr(n.sysAttribute[p]));for(var p=0;p<a.attribute.length;p++)d[a.attribute[p]]&&o.push(a.attribute[p]+'="'+d[a.attribute[p]]+'" ');o.push('class="'),c&&o.push("l-first "),u&&o.push("l-last "),c&&u&&o.push("l-onlychild "),o.push('"'),o.push(">"),o.push('<div class="l-body'),a.selectable&&0==a.selectable(d)&&o.push(" l-unselectable"),o.push('">');for(var f=0;f<=i-2;f++)l[f]?o.push('<div class="l-box"></div>'):o.push('<div class="l-box l-line"></div>');if(n.hasChildren(d)?(g?o.push('<div class="l-box l-expandable-open"></div>'):o.push('<div class="l-box l-expandable-close"></div>'),a.checkbox&&(d.ischecked?o.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):o.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),a.parentIcon&&(o.push('<div class="l-box l-tree-icon '),o.push(n._getParentNodeClassName(!!g)+" "),a.iconFieldName&&d[a.iconFieldName]&&o.push("l-tree-icon-none"),o.push('">'),a.iconFieldName&&d[a.iconFieldName]&&(d[a.iconFieldName].indexOf("png")<0&&d[a.iconFieldName].indexOf("gif")<0&&d[a.iconFieldName].indexOf("jpg")<0?o.push('<i class="'+d[a.iconFieldName]+'" />'):o.push('<img src="'+d[a.iconFieldName]+'" />')),o.push("</div>"))):(u?o.push('<div class="l-box l-note-last"></div>'):o.push('<div class="l-box l-note"></div>'),a.checkbox&&(d.ischecked?o.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):o.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),a.childIcon&&(o.push('<div class="l-box l-tree-icon '),o.push(n._getChildNodeClassName()+" "),a.iconFieldName&&d[a.iconFieldName]&&o.push("l-tree-icon-none"),o.push('">'),a.iconFieldName&&d[a.iconFieldName]&&(d[a.iconFieldName].indexOf("png")<0&&d[a.iconFieldName].indexOf("gif")<0&&d[a.iconFieldName].indexOf("jpg")<0?o.push('<i class="'+d[a.iconFieldName]+'" />'):o.push('<img src="'+d[a.iconFieldName]+'" />')),o.push("</div>"))),a.render?o.push("<span>"+a.render(d,d[a.textFieldName])+"</span>"):o.push("<span>"+d[a.textFieldName]+"</span>"),o.push("</div>"),n.hasChildren(d)){for(var v=[],f=0;f<l.length;f++)v.push(l[f]);v.push(u),h?1==h?n.toggleNodeCallbacks.push({data:d,callback:function(t,l){var r=n._getTreeHTMLByData(l.children,i+1,v,g).join("");e(t).append(r),e(">.l-children .l-body",t).hover(function(){e(this).addClass("l-over")},function(){e(this).removeClass("l-over")}),n._removeToggleNodeCallback(l)}}):h.url&&function(t,i,l){n.toggleNodeCallbacks.push({data:t,callback:function(t,r){n.loadData(t,i,l,{showLoading:function(){e("div.l-expandable-close:first",t).addClass("l-box-loading")},hideLoading:function(){e("div.l-box-loading:first",t).removeClass("l-box-loading")}}),n._removeToggleNodeCallback(r)}})}(d,h.url,h.parms):d.children&&o.push(n._getTreeHTMLByData(d.children,i+1,v,g).join(""))}o.push("</li>")}return o.push("</ul>"),o}},_removeToggleNodeCallback:function(e){for(var t=this,i=(this.options,0);i<=t.toggleNodeCallbacks.length;i++)if(t.toggleNodeCallbacks[i]&&t.toggleNodeCallbacks[i].data==e){t.toggleNodeCallbacks.splice(i,1);break}},_getDataByTreeHTML:function(t){var i=this,l=this.options,r=[];return e("> li",t).each(function(t,n){var a=r.length;r[a]={treedataindex:i.treedataindex++},r[a][l.textFieldName]=e("> span,> a",this).html();for(var o=0;o<i.sysAttribute.length;o++)e(this).attr(i.sysAttribute[o])&&(r[a][i.sysAttribute[o]]=e(this).attr(i.sysAttribute[o]));for(var o=0;o<l.attribute.length;o++)e(this).attr(l.attribute[o])&&(r[a][l.attribute[o]]=e(this).attr(l.attribute[o]));e("> ul",this).length>0&&(r[a].children=i._getDataByTreeHTML(e("> ul",this)))}),r},_applyTree:function(){var t=this;this.options;t.data=t._getDataByTreeHTML(t.tree);var i=t._getTreeHTMLByData(t.data,1,[],!0);i[i.length-1]=i[0]="",t.tree.html(i.join("")),t._upadteTreeWidth(),e(".l-body",t.tree).hover(function(){e(this).addClass("l-over")},function(){e(this).removeClass("l-over")})},_getSrcElementByEvent:function(t){var i=this,l=t.target||t.srcElement,r=l.tagName.toLowerCase(),n=e(l).parents().add(l),a=function(t){for(var i=n.length-1;i>=0;i--)if(e(n[i]).hasClass(t))return n[i];return null};if(n.index(this.element)==-1)return{out:!0};var o={tree:a("l-tree"),node:a("l-body"),checkbox:a("l-checkbox"),icon:a("l-tree-icon"),text:"span"==r};if(o.node){var s=parseInt(e(o.node).parent().attr("treedataindex"));o.data=i._getDataNodeByTreeDataIndex(i.data,s)}return o},_setTreeEven:function(){var t=this,i=this.options;t.hasBind("contextmenu")&&t.tree.bind("contextmenu",function(i){var l=i.target||i.srcElement,r=null;if("a"==l.tagName.toLowerCase()||"span"==l.tagName.toLowerCase()||e(l).hasClass("l-box")?r=e(l).parent().parent():e(l).hasClass("l-body")?r=e(l).parent():"li"==l.tagName.toLowerCase()&&(r=e(l)),r){var n=parseInt(r.attr("treedataindex")),a=t._getDataNodeByTreeDataIndex(t.data,n);return t.trigger("contextmenu",[{data:a,target:r[0]},i])}}),t.hasBind("mouseover")&&t.tree.bind("mouseover",function(i){var l=i.target||i.srcElement,r=null,n=null;if("img"==l.tagName.toLowerCase()&&(l=l.parentElement),"a"==l.tagName.toLowerCase()||"span"==l.tagName.toLowerCase()||e(l).hasClass("l-box")?(r=e(l).parent().parent(),n=e(l).parent()):e(l).hasClass("l-body")?(r=e(l).parent(),n=e(l)):"li"==l.tagName.toLowerCase()&&(r=e(l),n=e(l).children("div.l-body")),r){var a=parseInt(r.attr("treedataindex")),o=t._getDataNodeByTreeDataIndex(t.data,a);return t.trigger("mouseover",[{data:o,target:r[0],targetItem:n[0]},i])}}),t.hasBind("mouseout")&&t.tree.bind("mouseout",function(i){var l=i.target||i.srcElement,r=null,n=null;if("img"==l.tagName.toLowerCase()&&(l=l.parentElement),"a"==l.tagName.toLowerCase()||"span"==l.tagName.toLowerCase()||e(l).hasClass("l-box")?(r=e(l).parent().parent(),n=e(l).parent()):e(l).hasClass("l-body")?(r=e(l).parent(),n=e(l)):"li"==l.tagName.toLowerCase()&&(r=e(l),n=e(l).children("div.l-body")),r){var a=parseInt(r.attr("treedataindex")),o=t._getDataNodeByTreeDataIndex(t.data,a);return t.trigger("mouseout",[{data:o,target:r[0],targetItem:n[0]},i])}}),t.tree.click(function(l){var r=l.target||l.srcElement,n=null;if(n="a"==r.tagName.toLowerCase()||"span"==r.tagName.toLowerCase()||e(r).hasClass("l-box")?e(r).parent().parent():e(r).hasClass("l-body")?e(r).parent():e(r)){var a=parseInt(n.attr("treedataindex")),o=t._getDataNodeByTreeDataIndex(t.data,a),s=e("div.l-body:first",n).find("div.l-expandable-open:first,div.l-expandable-close:first"),d=e(r).hasClass("l-expandable-open")||e(r).hasClass("l-expandable-close");if(!e(r).hasClass("l-checkbox")&&!d&&!n.hasClass("l-unselectable"))if(e(">div:first",n).hasClass("l-selected")&&i.needCancel){if(0==t.trigger("beforeCancelSelect",[{data:o,target:n[0]}]))return!1;e(">div:first",n).removeClass("l-selected"),t.trigger("cancelSelect",[{data:o,target:n[0]}])}else{if(0==t.trigger("beforeSelect",[{data:o,target:n[0]}]))return!1;e(".l-body",t.tree).removeClass("l-selected"),e(">div:first",n).addClass("l-selected"),t.trigger("select",[{data:o,target:n[0]}])}if(e(r).hasClass("l-checkbox"))i.autoCheckboxEven?(e(r).hasClass("l-checkbox-unchecked")?(e(r).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),e(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),t.trigger("check",[{data:o,target:n[0]},!0])):e(r).hasClass("l-checkbox-checked")?(e(r).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),e(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked"),t.trigger("check",[{data:o,target:n[0]},!1])):e(r).hasClass("l-checkbox-incomplete")&&(e(r).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked"),e(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),t.trigger("check",[{data:o,target:n[0]},!0])),t._setParentCheckboxStatus(n)):e(r).hasClass("l-checkbox-unchecked")?(e(r).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),i.single&&e(".l-checkbox",t.tree).not(r).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),t.trigger("check",[{data:o,target:n[0]},!0])):e(r).hasClass("l-checkbox-checked")&&(e(r).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),t.trigger("check",[{data:o,target:n[0]},!1]));else if(!s.hasClass("l-expandable-open")||i.btnClickToToggleOnly&&!d){if(s.hasClass("l-expandable-close")&&(!i.btnClickToToggleOnly||d)){if(0==t.trigger("beforeExpand",[{data:o,target:n[0]}]))return!1;e(t.toggleNodeCallbacks).each(function(){this.data==o&&this.callback(n[0],o)}),s.removeClass("l-expandable-close").addClass("l-expandable-open");var c=s.parent("div").find("i").attr("class");void 0!=c&&c.indexOf("fa-folder")>-1&&s.parent("div").find("i").attr("class","fa fa-folder-open-o");var u=function(){t.trigger("expand",[{data:o,target:n[0]}])};i.slide?e("> .l-children",n).slideToggle("fast",u):(e("> .l-children",n).show(),u()),e("> div ."+t._getParentNodeClassName(),n).removeClass(t._getParentNodeClassName()).addClass(t._getParentNodeClassName(!0))}}else{if(0==t.trigger("beforeCollapse",[{data:o,target:n[0]}]))return!1;s.removeClass("l-expandable-open").addClass("l-expandable-close");var c=s.parent("div").find("i").attr("class");void 0!=c&&c.indexOf("fa-folder")>-1&&s.parent("div").find("i").attr("class","fa fa-folder-o"),i.slide?e("> .l-children",n).slideToggle("fast"):e("> .l-children",n).hide(),e("> div ."+t._getParentNodeClassName(!0),n).removeClass(t._getParentNodeClassName(!0)).addClass(t._getParentNodeClassName()),t.trigger("collapse",[{data:o,target:n[0]}])}t.trigger("click",[{data:o,target:n[0]}])}}),e.fn.ligerDrag&&i.nodeDraggable&&(t.nodeDroptip=e("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body"),t.tree.ligerDrag({revert:!0,animate:!1,proxyX:2,proxyY:2,proxy:function(l,r){var n=t._getSrcElementByEvent(r);if(n.node){var a="dragging";if(i.nodeDraggingRender)a=i.nodeDraggingRender(l.draggingNodes,l,t);else{a="";var o=!1;for(var s in l.draggingNodes){var d=l.draggingNodes[s];o&&(a+=","),a+=d[i.textFieldName],o=!0}}var c=e("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+a+"</div>").appendTo("body");return c}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),t.children[this.id]=this},onStartDrag:function(l,r){if(2==r.button)return!1;this.set("cursor","default");var n=t._getSrcElementByEvent(r);if(n.checkbox)return!1;if(i.checkbox){var a=t.getChecked();this.draggingNodes=[];for(var o in a)this.draggingNodes.push(a[o].data);if(!this.draggingNodes||!this.draggingNodes.length)return!1}else this.draggingNodes=[n.data];return this.draggingNode=n.data,!(e.isFunction(i.onStartDrag)&&!i.onStartDrag.call(this,t,i,l,r))&&(this.set("cursor","move"),t.nodedragging=!0,void(this.validRange={top:t.tree.offset().top,bottom:t.tree.offset().top+t.tree.height(),left:t.tree.offset().left,right:t.tree.offset().left+t.tree.width()}))},onDrag:function(l,r){if(!e.isFunction(i.onDragging)||i.onDragging.call(this,t,i,l,r)){var n=this.draggingNode;if(!n)return!1;var a=this.draggingNodes?this.draggingNodes:[n];null==t.nodeDropIn&&(t.nodeDropIn=-1);var o=r.pageX,s=r.pageY,d=!1,c=this.validRange;if(o<c.left||o>c.right||s>c.bottom||s<c.top)return t.nodeDropIn=-1,t.nodeDroptip.hide(),void this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");for(var u=0,h=t.nodes.length;u<h;u++){var g=t.nodes[u];if("delete"!=g.__status){var p=g.treedataindex;if(n.treedataindex==p&&(d=!0),e.inArray(g,a)==-1){var f=!!d;if(t.nodeDropIn==-1||t.nodeDropIn==p){var v=e("li[treedataindex="+p+"] div:first",t.tree),m=v.offset();if(null!=m){var b={top:m.top,bottom:m.top+v.height(),left:t.tree.offset().left,right:t.tree.offset().left+t.tree.width()};if(o>b.left&&o<b.right&&s>b.top&&s<b.bottom){var x=m.top;f&&(x+=v.height()),t.nodeDroptip.css({left:b.left,top:x,width:b.right-b.left}).show(),t.nodeDropIn=p,t.nodeDropDir=f?"bottom":"top",s>b.top+7&&s<b.bottom-7?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),t.nodeDroptip.hide(),t.nodeDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),t.nodeDroptip.show(),t.nodeDropInParent=!1);break}t.nodeDropIn!=-1&&(t.nodeDropIn=-1,t.nodeDropInParent=!1,t.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}}}}}}},onStopDrag:function(l,r){if(!e.isFunction(i.onStopDrag)||i.onStopDrag.call(this,t,i,l,r)){var n=this.draggingNodes;if(t.nodedragging=!1,t.nodeDropIn!=-1){for(var a=0;a<n.length;a++){var o=n[a].children;o&&(n=e.grep(n,function(t,i){var l=e.inArray(t,o)==-1;return l}))}for(var a in n){var s=n[a];t.nodeDropInParent?(t.remove(s),t.append(t.nodeDropIn,[s])):(t.remove(s),t.append(t.getParent(t.nodeDropIn),[s],t.nodeDropIn,"bottom"==t.nodeDropDir))}t.nodeDropIn=-1}t.nodeDroptip.hide(),this.set("cursor","default")}}}))},_setParentCheckboxStatus:function(t){var i=this,l=(this.options,0==e(".l-checkbox-unchecked",t.parent()).length),r=0==e(".l-checkbox-checked",t.parent()).length;l?t.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked"):r?t.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked"):t.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete"),t.parent().parent("li").length>0&&i._setParentCheckboxStatus(t.parent().parent("li"))}})}(jQuery),function(e){var t=e.ligerui;t.windowCount=0,e.ligerWindow=function(e){return t.run.call(null,"ligerWindow",arguments,{isStatic:!0})},e.ligerWindow.show=function(t){return e.ligerWindow(t)},e.ligerDefaults.Window={showClose:!0,showMax:!0,showToggle:!0,showMin:!0,title:"window",load:!1,onLoaded:null,onClose:null,onRegain:null,onMax:null,modal:!1},e.ligerMethos.Window={},t.controls.Window=function(e){t.controls.Window.base.constructor.call(this,null,e)},t.controls.Window.ligerExtend(t.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return e.ligerMethos.Window},_render:function(){var i=this,l=this.options;if(i.window=e('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>'),i.element=i.window[0],i.window.content=e(".l-window-content",i.window),i.window.header=e(".l-window-header",i.window),i.window.buttons=e(".l-window-header-buttons:first",i.window),l.url)if(l.load)i.window.content.load(l.url,function(){i.trigger("loaded")}),i.window.content.addClass("l-window-content-scroll");else{var r=e("<iframe frameborder='0' src='"+l.url+"'></iframe>"),n="ligeruiwindow"+t.windowCount++;l.name&&(n=l.name),r.attr("name",n).attr("id",n),l.framename=n,r.appendTo(i.window.content),i.iframe=r}else if(l.content){var a=e("<div>"+l.content+"</div>");a.appendTo(i.window.content)}else l.target&&(i.window.content.append(l.target),l.target.show());this.mask(),i.active(),e("body").append(i.window),i.set({width:l.width,height:l.height});var o=0,s=0;null!=l.left?o=l.left:l.left=o=.5*(e(window).width()-i.window.width()),null!=l.top?s=l.top:l.top=s=.5*(e(window).height()-i.window.height())+e(window).scrollTop()-10,o<0&&(l.left=o=0),s<0&&(l.top=s=0),i.set(l),l.framename&&e(">iframe",i.window.content).attr("name",l.framename),l.showToggle||e(".l-window-toggle",i.window).remove(),l.showMax||e(".l-window-max",i.window).remove(),l.showClose||e(".l-window-close",i.window).remove(),i._saveStatus(),e.fn.ligerDrag&&(i.draggable=i.window.drag=i.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){i.active()},onStopDrag:function(){i._saveStatus()},animate:!1})),e.fn.ligerResizable&&(i.resizeable=i.window.resizable=i.window.ligerResizable({onStartResize:function(){i.active(),e(".l-window-max",i.window).removeClass("l-window-regain")},onStopResize:function(e,t){var l=0,r=0;return isNaN(parseInt(i.window.css("top")))||(l=parseInt(i.window.css("top"))),isNaN(parseInt(i.window.css("left")))||(r=parseInt(i.window.css("left"))),e.diffTop&&i.window.css({top:l+e.diffTop}),e.diffLeft&&i.window.css({left:r+e.diffLeft}),e.newWidth&&i.window.width(e.newWidth),e.newHeight&&i.window.content.height(e.newHeight-28),i._saveStatus(),!1}}),i.window.append("<div class='l-btn-nw-drop'></div>")),e(".l-window-toggle",i.window).click(function(){e(this).hasClass("l-window-toggle-close")?(i.collapsed=!1,e(this).removeClass("l-window-toggle-close")):(i.collapsed=!0,e(this).addClass("l-window-toggle-close")),i.window.content.slideToggle()}).hover(function(){i.window.drag&&i.window.drag.set("disabled",!0)},function(){i.window.drag&&i.window.drag.set("disabled",!1)}),e(".l-window-close",i.window).click(function(){return 0!=i.trigger("close")&&(i.window.hide(),void t.win.removeTask(i))}).hover(function(){i.window.drag&&i.window.drag.set("disabled",!0)},function(){i.window.drag&&i.window.drag.set("disabled",!1)}),e(".l-window-max",i.window).click(function(){if(e(this).hasClass("l-window-regain")){if(0==i.trigger("regain"))return!1;i.window.width(i._width).css({left:i._left,top:i._top}),i.window.content.height(i._height-28),e(this).removeClass("l-window-regain")}else{if(0==i.trigger("max"))return!1;i.window.width(e(window).width()-2).css({left:0,top:0}),i.window.content.height(e(window).height()-28).show(),e(this).addClass("l-window-regain")}})},_saveStatus:function(){var e=this;e._width=e.window.width(),e._height=e.window.height();var t=0,i=0;isNaN(parseInt(e.window.css("top")))||(t=parseInt(e.window.css("top"))),isNaN(parseInt(e.window.css("left")))||(i=parseInt(e.window.css("left"))),e._top=t,e._left=i},min:function(){this.window.hide(),this.minimize=!0,this.actived=!1},_setShowMin:function(i){var l=this;this.options;i?l.winmin||(l.winmin=e('<div class="l-window-min"></div>').prependTo(l.window.buttons).click(function(){l.min()}),t.win.addTask(l)):l.winmin&&(l.winmin.remove(),l.winmin=null)},_setLeft:function(e){null!=e&&this.window.css({left:e})},_setTop:function(e){null!=e&&this.window.css({top:e})},_setWidth:function(e){e>0&&this.window.width(e)},_setHeight:function(e){e>28&&this.window.content.height(e-28)},_setTitle:function(t){t&&e(".l-window-header-inner",this.window.header).html(t)},_setUrl:function(e){var t=this,i=this.options;i.url=e,i.load?t.window.content.html("").load(i.url,function(){if(0==t.trigger("loaded"))return!1}):t.jiframe&&t.jiframe.attr("src",i.url)},hide:function(){this.options;this.unmask(),this.window.hide()},show:function(){this.options;this.mask(),this.window.show()},remove:function(){this.options;this.unmask(),this.window.remove()},active:function(){var i=this;this.options;if(i.minimize){var l=i._width,r=i._height,n=i._left,a=i._top;i.maximum&&(l=e(window).width(),r=e(window).height(),n=a=0,t.win.taskbar&&(r-=t.win.taskbar.outerHeight(),t.win.top&&(a+=t.win.taskbar.outerHeight()))),i.set({width:l,height:r,left:n,top:a})}i.actived=!0,i.minimize=!1,t.win.setFront(i),i.show(),t.win.setFront(this)},setUrl:function(e){return _setUrl(e)}})}(jQuery);